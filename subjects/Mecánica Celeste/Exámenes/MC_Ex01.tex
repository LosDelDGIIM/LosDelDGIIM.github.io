\documentclass[12pt]{article}

\input{../../_assets/preambulo.tex}

\usetikzlibrary{arrows.meta,decorations.markings}

\newcommand{\R}{\mathbb{R}}
\newcommand{\prodescalar}[2]{\langle #1, #2 \rangle}
\newcommand{\ortogonal}[1]{#1^{\perp}}

\usepackage{tikz-3dplot}

\begin{document}

    % 1. Foto de fondo
    % 2. Título
    % 3. Encabezado Izquierdo
    % 4. Color de fondo
    % 5. Coord x del titulo
    % 6. Coord y del titulo
    % 7. Fecha

    
    \input{../../_assets/portada}
    \portadaExamen{ffccA4.jpg}{Mecánica Celeste\\Examen I}{Mecánica Celeste. Examen I}{MidnightBlue}{-8}{28}{2025}{José Manuel Sánchez Varbas}

    \begin{description}
        \item[Asignatura] Mecánica Celeste.
        \item[Curso Académico] 2023-24.
        \item[Grado] Grado en Matemáticas.
        \item[Grupo] A.
        \item[Descripción] Primer Parcial.
        \item[Fecha] 7 de Noviembre de 2023.  
    \end{description}
    \newpage


    % ------------------------------------

    \begin{ejercicio}
        Desde un observatorio astronómico fijo se está estudiando un sistema de dos asteroides
        que se mueven bajo la acción de la ley de gravitación de Newton. Cuando se comienzan las 
        observaciones sus posiciones respecto al observatorio son 
        $$x(0) = (0,1,-1), \quad y(0) = (0,-2,2),$$
        y las velocidades con las que se mueven 
        $$\dot{x}(0) = (1,-1,1) \quad \dot{y}(0) = (1,-2,1).$$
        Se estima que la masa del asteroide que ocupa la posición $x$ es el doble de la que ocupa la 
        $y$. Se pide:
        \begin{itemize}
            \item[a)] Deduce el comportamiento del centro de masas del sistema que se observa desde la 
            posición del observatorio.
            \item[b)] Determina el movimiento que se observa desde el centro de masas en función de la masa 
            $m$ del asteroide más pequeño.
            \item[c)] Explica cuál será el movimiento que verán los astrónomos desde el observatorio si 
            la masa $m \gg 1$. 
        \end{itemize}
    \end{ejercicio}

    \begin{ejercicio}
        Responde, de forma razonada, a las siguientes cuestiones:
        \begin{itemize}
            \item[a)] Determina qué condiciones debe cumplir la función $\alpha(t)$ para que la función
            $$x(t) = (\cos(\alpha(t)), \sen(\alpha(t)))$$
            sea solución de la ecuación 
            $$\ddot{x} = f(|x|)\dfrac{x}{|x|}$$
            con $f : ]0, +\infty[ \to \R$ una función continua dada.
            \item[b)] Clasifica la cónica 
            $$\sqrt{x^2 + y^2} + y/2 = 2$$
            y determina sus focos, su eje de excentricidad, su pericentro y su apocentro.
            \item[c)] De un planeta que se mueve bajo la acción de un Sol de masa $M$ situado en el origen
            de coordenadas se sabe que su posición en un determinado instante es $x_0 = (1/2, \sqrt{3}/2, 0)$
            y su velocidad en dicho instante $\dot{x}_0 = (- \sqrt{3}/2, 1/2, 0)$. Determina el eje de excentricidad
            del movimiento que describe, supuesto que $GM = 1$ y especifica, si es posible, dicho movimiento.  
        \end{itemize}
    \end{ejercicio}

    \newpage

    \setcounter{ejercicio}{0}

    \begin{ejercicio}
        Desde un observatorio astronómico fijo se está estudiando un sistema de dos asteroides
        que se mueven bajo la acción de la ley de gravitación de Newton. Cuando se comienzan las 
        observaciones sus posiciones respecto al observatorio son 
        $$x(0) = (0,1,-1), \quad y(0) = (0,-2,2),$$
        y las velocidades con las que se mueven 
        $$\dot{x}(0) = (1,-1,1) \quad \dot{y}(0) = (1,-2,1).$$
        Se estima que la masa del asteroide que ocupa la posición $x$ es el doble de la que ocupa la 
        $y$. Se pide:
        \begin{itemize}
            \item[a)] Deduce el comportamiento del centro de masas del sistema que se observa desde la 
            posición del observatorio. \\

            Sabemos por teoría que $\ddot{C}(t) = 0$, o equivalentemente, $C(t) = \alpha + \beta t$, con
            $\alpha = C(t_0)$, $\beta = \dot{C}(t_0)$, siempre que $t_0 \in I$ pertenezca al intervalo
            maximal de definición\footnote{También por el Teorema de Existencia y Unicidad de
            las Ecuaciones Lineales visto en Ecuaciones Diferenciales I}. El enunciado dice cuando ``se comienzan las observaciones'', por lo que 
            ubicamos ahí el origen, y tomamos $t_0 = 0$. Entonces, denotando por $m_1$ a la masa
            del asteroide que ocupa la posición $x$, e igualmente $m_2$ a la masa del asteroide de posición $y$,
            se tiene que $m_1 = 2m_2$. Si $m_2 = m > 0$, se verifica $m_1 + m_2 = 3m$. \\

            Ahora, por definición, el centro de masas es 
            $$C(t) = \dfrac{m_1 x(t) + m_2 y(t)}{m_1 + m_2}$$
            y su derivada es 
            $$\dot{C}(t) = \dfrac{m_1 \dot{x}(t) + m_2 \dot{y}(t)}{m_1 + m_2}$$

            Obtenemos $\alpha = C(0)$ y $\beta = \dot{C}(0)$.
            $$\alpha = C(0) = \dfrac{2 x(0) + y(0)}{3}$$
            Como $2x(0) + y(0) = 2(0,1,-1) + (0,-2,2) = (0,0,0)$, entonces 
            $$\alpha = \dfrac{1}{3}(0,0,0) = (0,0,0)$$
            Análogamente, $2\dot{x}(0) + \dot{y}(0) = 2(1,-1,1) + (1,-2,1) = (3,-4,3)$, luego
            $$\beta = \dfrac{1}{3}(3,-4,3) = \left(1, -\frac{4}{3}, 1 \right)$$

            Por lo tanto,

            $$\boxed{C(t) = \left(1, -\frac{4}{3}, 1 \right)t}$$

            \newpage

            \item[b)] Determina el movimiento que se observará desde el centro de masas en función de la masa 
            $m$ del asteroide menor. \\

            Consideramos el sistema con centro de masas fijo en el origen, utilizando el Principio de Relatividad
            de Galileo, $\tilde{x}(t) = x(t) - \alpha - \beta t$, $\tilde{y}(t) = y(t) - \alpha - \beta t$
            donde $C(t) = \alpha + \beta t$ ya calculado en el apartado anterior. \\

            Sabemos que entonces $(\tilde{x}, \tilde{y})$ es solución al mismo problema de los dos cuerpos y el centro de masas en este sistema
            verifica $\tilde{C}(t) \equiv 0$. Consecuentemente 
            $$m_1 \tilde{x} + m_2 \tilde{y} = 0 \Longrightarrow \tilde{y} = - \dfrac{m_1}{m_2} \tilde{x} = - 2 \tilde{x}$$

            Si el asteroide identificado por $\tilde{x}$ sigue la cónica $|\tilde{x}| + \prodescalar{e}{\tilde{x}} = k$ con $e \in \R^3$ y $k>0$
            entonces se ha visto en teoría que el asteroide identificado por $y$ sigue la cónica 
            $|\tilde{y}| + \prodescalar{-e}{\tilde{y}} = 2k$,
            es decir, las dos cónicas son del mismo tipo, y los ejes de excentricidad opuestos. \\

            El asteroide identificado por $\tilde{x}$ (visto en teoría) sigue un problema de Kepler

            $$\ddot{\tilde{x}} = - G\dfrac{m_2^3}{(m_1+m_2)^2} \dfrac{\tilde{x}}{|\tilde{x}|^3} = 
            - G \dfrac{m}{9} \dfrac{\tilde{x}}{|\tilde{x}|^3} = - \mu \dfrac{\tilde{x}}{|\tilde{x}|^3}$$

            Estudiamos uno de los dos asteroides, y el otro ya lo tendremos. Obtenemos el momento angular $c_{\tilde{x}}$, 
            primero viendo que 
            $$\tilde{x}(0) = x(0) - \alpha = (0,1,-1),
            \quad \dot{\tilde{x}}(0) = \dot{x}(0) - \beta = \left(0, \frac{1}{3}, 0 \right)$$ 

            $$c_{\tilde{x}} = \tilde{x}(0) \land \dot{\tilde{x}}(0) = \begin{vmatrix}
                0 & 1 & -1 \\
                0 & 1/3 & 0 \\
                i & j & k
            \end{vmatrix} = \left(-1/3, 0, 0 \right) \Longrightarrow |c_{\tilde{x}}| \neq 0$$

            Tenemos entonces que ambos cuerpos se moverán sobre una elipse, hipérbola o parábola, con un
            foco en el origen, por la Primera Ley de Kepler. Para determinar la cónica, obtenemos la energía total.

            $$h = \dfrac{1}{2} |\dot{\tilde{x}}(0)|^2 - \dfrac{\mu}{|\tilde{x}(0)|}$$

            Viendo que
            $$|\tilde{x}(0)|^2 = 0^2 + 1^2 + \left( - 1 \right)^2 =
            2 \Longrightarrow 
            |\tilde{x}(0)| = \sqrt{2}$$
            y
            $$|\dot{\tilde{x}}(0)|^2 = \frac{1}{9}$$

            Como $$h = \dfrac{1}{2} |\dot{\tilde{x}}(0)|^2 - \dfrac{\mu}{|\tilde{x}(0)|} = 
            \dfrac{1}{2} \cdot \dfrac{1}{9} - \dfrac{Gm}{9} \dfrac{1}{\sqrt{2}} = $$
            $$\dfrac{1}{18} - \dfrac{\sqrt{2}Gm}{18} = \dfrac{1 - \sqrt{2}Gm}{18}$$

            el tipo de movimiento visto desde el sistema con centro de masas fijo en el origen dependerá entonces de la 
            masa $m$.
            \begin{itemize}
                \item Será elíptica si y solo si $$h<0 \iff \dfrac{1 - \sqrt{2}Gm}{18}
                < 0 \iff 1 < \sqrt{2}Gm \iff m > \dfrac{1}{\sqrt{2} G} = \dfrac{\sqrt{2}}{2G}$$
                \item Será parabólica si y solo si
                $$h = 0 \iff m = \dfrac{\sqrt{2}}{2G}$$
                \item Será hiperbólica si y solo si
                $$h>0 \iff m < \dfrac{\sqrt{2}}{2G}$$
            \end{itemize}

            Y el otro cuerpo seguirá la misma cónica. \\

            \item[c)] Explica cuál será el movimiento que vean los astrónomos desde el observatorio si 
            la masa $m \gg 1$. \\

            Si $m \gg 1$ (suponiendo unidades normalizadas), en particular $$ m \gg \dfrac{\sqrt{2}}{2G}$$ de donde $h \ll 0$, luego la trayectoria de ambos cuerpos será elíptica,
            con ejes de excentricidad opuestos. Teniendo en cuenta que los astrónomos observan desde el observatorio,
            y que el centro de masas está en movimiento, pues, por el apartado a), sabemos que 
            $C(t) = \left(1, -\frac{4}{3}, 1 \right)t$,
            entonces las trayectorias elípticas se producirán simultáneamente con la traslación
            del centro de masas a lo largo de la recta $r \equiv \left(1, -\frac{4}{3}, 1 \right)t$, resultando en movimientos helicoidales
            descritos por ambos cuerpos a lo largo de la recta $r$. Esto se ha representado en la Figura \ref{fig:ej2c} siguiente:
     
            \begin{figure}[H]
                % Ángulo de cámara
                \tdplotsetmaincoords{70}{220}    
                \noindent\hspace*{-2.7cm}%
                \begin{tikzpicture}[tdplot_main_coords, scale=2]
                    \shorthandoff{>}

                    % separación entre “cortes”
                    \def\DX{6cm}

                    % =====================================================
                    % ===============  PRIMERA SITUACIÓN  ====================
                    % =====================================================
                    \begin{scope}[xshift=0cm]

                        % =========================
                        % Triedro de referencia (ejes 3D)
                        % =========================
                        \def\L{3}
                        \draw[thick, ->] (0,0,0) -- (\L,0,0) node[above left] {$x$};
                        \draw[thick, ->] (0,0,0) -- (0,\L,0) node[above right] {$y$};
                        \draw[thick, ->] (0,0,0) -- (0,0,\L) node[above right] {$z$};

                        % =========================
                        % Recta C(t) = (1,-4/3,1)t
                        % =========================
                        \def\L{1.5}
                        \draw[very thick, green, ->] (-\L, {-4*\L/3}, \L) -- (\L, {4*\L/3}, -\L);

                        % =========================
                        % Datos 3D
                        % =========================
                        \pgfmathsetmacro{\uNx}{1}
                        \pgfmathsetmacro{\uNy}{4/3}
                        \pgfmathsetmacro{\uNz}{-1}


                        \pgfmathsetmacro{\vNx}{0}
                        \pgfmathsetmacro{\vNy}{0}
                        \pgfmathsetmacro{\vNz}{1}

                        \coordinate (O) at (0,0,0);

                        % (opcionales)
                        \draw[->, white, thick] (0,0,0) -- (1.3,0,0) node[below] {$x$};
                        \draw[->, white, thick] (0,0,0) -- (0,3,0) node[left]  {$y$};
                        \draw[->, white, thick] (0,0,0) -- (0,0,1.02) node[left]  {$z$};

                        % =========================
                        % Plano span{u,v}
                        % =========================
                        \def\aU{1.3}
                        \def\bV{1}

                        \coordinate (P1) at ({ \aU*\uNx + \bV*\vNx},{ \aU*\uNy + \bV*\vNy},{ \aU*\uNz + \bV*\vNz});
                        \coordinate (P2) at ({-\aU*\uNx + \bV*\vNx},{-\aU*\uNy + \bV*\vNy},{-\aU*\uNz + \bV*\vNz});
                        \coordinate (P3) at ({-\aU*\uNx - \bV*\vNx},{-\aU*\uNy - \bV*\vNy},{-\aU*\uNz - \bV*\vNz});
                        \coordinate (P4) at ({ \aU*\uNx - \bV*\vNx},{ \aU*\uNy - \bV*\vNy},{ \aU*\uNz - \bV*\vNz});
                        \draw[thick, brown] (P1)--(P2)--(P3)--(P4)--cycle;

                        \fill[yellow] (O) circle (0.6pt);

                        % =========================
                        % Base ortonormal del plano
                        % =========================
                        \pgfmathsetmacro{\invSqrtThirtyFour}{1/sqrt(34)}

                        % e1 = u/||u|| = (3,4,-3)/sqrt(34)
                        \pgfmathsetmacro{\eoneX}{ 3*\invSqrtThirtyFour}
                        \pgfmathsetmacro{\eoneY}{ 4*\invSqrtThirtyFour}
                        \pgfmathsetmacro{\eoneZ}{-3*\invSqrtThirtyFour}

                        % e2 = (9,12,25)/(5*sqrt(34))
                        \pgfmathsetmacro{\etwoX}{ 9*\invSqrtThirtyFour/5}
                        \pgfmathsetmacro{\etwoY}{12*\invSqrtThirtyFour/5}
                        \pgfmathsetmacro{\etwoZ}{25*\invSqrtThirtyFour/5}


                        % Semiejes
                        \def\EA{1.10}
                        \def\EB{0.55}
                        \def\ea{0.65}
                        \def\eb{0.33}

                        % Desplazamientos en C(t)
                        \def\sBig{0.4}
                        \def\sSmall{-0.3}

                        % =========================
                        % Elipses
                        % =========================
                        \draw[thick, red]
                        plot[domain=0:360, samples=220, variable=\t]
                        (
                        { \sBig*\uNx + (\EA*cos(\t))*\eoneX + (\EB*sin(\t))*\etwoX },
                        { \sBig*\uNy + (\EA*cos(\t))*\eoneY + (\EB*sin(\t))*\etwoY },
                        { \sBig*\uNz + (\EA*cos(\t))*\eoneZ + (\EB*sin(\t))*\etwoZ }
                        );

                        \draw[thick, blue]
                        plot[domain=0:360, samples=220, variable=\t]
                        (
                        { \sSmall*\uNx + (\ea*cos(\t))*\eoneX + (\eb*sin(\t))*\etwoX },
                        { \sSmall*\uNy + (\ea*cos(\t))*\eoneY + (\eb*sin(\t))*\etwoY },
                        { \sSmall*\uNz + (\ea*cos(\t))*\eoneZ + (\eb*sin(\t))*\etwoZ }
                        );

                        % =========================
                        % Masas (puntos sobre elipses)
                        % =========================
                        \def\thBig{280}
                        \def\thSmall{200}

                        \pgfmathsetmacro{\PBx}{ (\sBig*\uNx) + (\EA*cos(\thBig))*\eoneX + (\EB*sin(\thBig))*\etwoX }
                        \pgfmathsetmacro{\PBy}{ (\sBig*\uNy) + (\EA*cos(\thBig))*\eoneY + (\EB*sin(\thBig))*\etwoY }
                        \pgfmathsetmacro{\PBz}{ (\sBig*\uNz) + (\EA*cos(\thBig))*\eoneZ + (\EB*sin(\thBig))*\etwoZ }

                        \pgfmathsetmacro{\PSx}{ (\sSmall*\uNx) + (\ea*cos(\thSmall))*\eoneX + (\eb*sin(\thSmall))*\etwoX }
                        \pgfmathsetmacro{\PSy}{ (\sSmall*\uNy) + (\ea*cos(\thSmall))*\eoneY + (\eb*sin(\thSmall))*\etwoY }
                        \pgfmathsetmacro{\PSz}{ (\sSmall*\uNz) + (\ea*cos(\thSmall))*\eoneZ + (\eb*sin(\thSmall))*\etwoZ }

                        % proyecta y define coords EN pantalla (sin doble transformación)
                        \tdplottransformmainscreen{\PBx}{\PBy}{\PBz}
                        \begin{scope}[tdplot_screen_coords]
                        \coordinate (PBscreen) at (\tdplotresx,\tdplotresy);
                        \end{scope}

                        \tdplottransformmainscreen{\PSx}{\PSy}{\PSz}
                        \begin{scope}[tdplot_screen_coords]
                        \coordinate (PSscreen) at (\tdplotresx,\tdplotresy);
                        \end{scope}

                        % esferas en pantalla
                        \begin{scope}[tdplot_screen_coords]
                        \shade[ball color=green!70!white, draw=green!40!black]
                            (PSscreen) circle[radius=2.0pt];
                        \shade[ball color=cyan!70!white, draw=cyan!40!black]
                            (PBscreen) circle[radius=1.0pt];
                        \end{scope}

                        % =========================
                        % Flechas de sentido
                        % =========================
                        \def\dth{20}

                        \def\thArrowRed{282}
                        \draw[red, very thick, ->]
                        plot[domain=\thArrowRed:\thArrowRed+\dth, samples=40, variable=\t]
                        (
                        { \sBig*\uNx + (\EA*cos(\t))*\eoneX + (\EB*sin(\t))*\etwoX },
                        { \sBig*\uNy + (\EA*cos(\t))*\eoneY + (\EB*sin(\t))*\etwoY },
                        { \sBig*\uNz + (\EA*cos(\t))*\eoneZ + (\EB*sin(\t))*\etwoZ }
                        );

                        \def\thArrowBlue{190}
                        \draw[blue, very thick, ->]
                        plot[domain=\thArrowBlue:0.8*\thArrowBlue-\dth, samples=40, variable=\t]
                        (
                        { \sSmall*\uNx + (\ea*cos(\t))*\eoneX + (\eb*sin(\t))*\etwoX },
                        { \sSmall*\uNy + (\ea*cos(\t))*\eoneY + (\eb*sin(\t))*\etwoY },
                        { \sSmall*\uNz + (\ea*cos(\t))*\eoneZ + (\eb*sin(\t))*\etwoZ }
                        );

                    \end{scope}

                    % =====================================================
                    % Flecha central hacia la derecha (entre cortes)
                    % Ajusta coordenadas si la quieres más arriba/abajo
                    % =====================================================
                    \draw[very thick, ->] (1.5cm,-0.4cm) -- (3cm,-0.4cm);

                    % =====================================================
                    % ===============  SEGUNDA SITUACIÓN  ======================
                    % (avanza en C(t) + avanza fase => lectura helicoidal)
                    % =====================================================

                    \begin{scope}[xshift=\DX]
                        \def\tF{0.4}          % <-- ajusta el instante final

                        % =========================
                        % Triedro de referencia (ejes 3D)
                        % =========================
                        \def\L{3}
                        \draw[thick, ->] (0,0,0) -- (\L,0,0) node[above left] {$x$};
                        \draw[thick, ->] (0,0,0) -- (0,\L,0) node[above right] {$y$};
                        \draw[thick, ->] (0,0,0) -- (0,0,\L) node[above right] {$z$};

                        % =========================
                        % Recta C(t) = (1,-4/3,1)t
                        % =========================
                        \def\L{1.5}
                        \draw[very thick, green, ->] (-\L, {-4*\L/3}, \L) -- (\L, {4*\L/3}, -\L);

                        % =========================
                        % Datos 3D
                        % =========================
                        \pgfmathsetmacro{\uNx}{1}
                        \pgfmathsetmacro{\uNy}{4/3}
                        \pgfmathsetmacro{\uNz}{-1}


                        \pgfmathsetmacro{\vNx}{0}
                        \pgfmathsetmacro{\vNy}{0}
                        \pgfmathsetmacro{\vNz}{1}

                        \coordinate (O) at (0,0,0);

                        % (opcionales)
                        \draw[->, white, thick] (0,0,0) -- (1.58,0,0) node[below] {$x$};
                        \draw[->, white, thick] (0,0,0) -- (0,3,0) node[left]  {$y$};
                        \draw[->, white, thick] (0,0,0) -- (0,0,1.2) node[left]  {$z$};

                        % =========================
                        % Plano span{u,v} (centrado para abarcar toda la hélice)
                        % =========================

                        % Centro del plano = punto medio del recorrido del CM: C(tF/2)
                        \pgfmathsetmacro{\tMid}{0.5*\tF}
                        \coordinate (Pc) at ({\tMid*\uNx},{\tMid*\uNy},{\tMid*\uNz});

                        % Semiextensiones del plano:
                        % - en dirección u: debe cubrir el desplazamiento 0 -> tF (más margen)
                        % - en dirección v: ancho "visual" (ajusta a gusto)
                        \pgfmathsetmacro{\aU}{0.5*\tF + 0.9}
                        \def\bV{1.2}

                        \coordinate (P1) at ({\tMid*\uNx + \aU*\uNx + \bV*\vNx},
                                            {\tMid*\uNy + \aU*\uNy + \bV*\vNy},
                                            {\tMid*\uNz + \aU*\uNz + \bV*\vNz});
                        \coordinate (P2) at ({\tMid*\uNx - \aU*\uNx + \bV*\vNx},
                                            {\tMid*\uNy - \aU*\uNy + \bV*\vNy},
                                            {\tMid*\uNz - \aU*\uNz + \bV*\vNz});
                        \coordinate (P3) at ({\tMid*\uNx - \aU*\uNx - \bV*\vNx},
                                            {\tMid*\uNy - \aU*\uNy - \bV*\vNy},
                                            {\tMid*\uNz - \aU*\uNz - \bV*\vNz});
                        \coordinate (P4) at ({\tMid*\uNx + \aU*\uNx - \bV*\vNx},
                                            {\tMid*\uNy + \aU*\uNy - \bV*\vNy},
                                            {\tMid*\uNz + \aU*\uNz - \bV*\vNz});
                        \draw[thick, brown] (P1)--(P2)--(P3)--(P4)--cycle;

                        % =========================
                        % Base ortonormal del plano
                        % =========================
                        \pgfmathsetmacro{\invSqrtThirtyFour}{1/sqrt(34)}

                        % e1 = u/||u|| = (3,4,-3)/sqrt(34)
                        \pgfmathsetmacro{\eoneX}{ 3*\invSqrtThirtyFour}
                        \pgfmathsetmacro{\eoneY}{ 4*\invSqrtThirtyFour}
                        \pgfmathsetmacro{\eoneZ}{-3*\invSqrtThirtyFour}

                        % e2 = (9,12,25)/(5*sqrt(34))
                        \pgfmathsetmacro{\etwoX}{ 9*\invSqrtThirtyFour/5}
                        \pgfmathsetmacro{\etwoY}{12*\invSqrtThirtyFour/5}
                        \pgfmathsetmacro{\etwoZ}{25*\invSqrtThirtyFour/5}

                        % Semiejes
                        \def\EA{1.10}
                        \def\EB{0.55}
                        \def\ea{0.65}
                        \def\eb{0.33}

                        % ============================================================
                        % NUEVO: parámetro de tiempo final y velocidades angulares
                        % ============================================================
                        \def\omegaBig{75}     % (grados/unidad tiempo) roja
                        \def\omegaSmall{75}   % (grados/unidad tiempo) azul
                        \def\nTurns{2} % <-- número de vueltas extra (entero: 0,1,2,...)

                        % ============================================================
                        % Recta que une ambos centros de masas en cada instante
                        % ============================================================

                        \fill[yellow] (O) circle (0.6pt);

                        % =========================
                        % Centro de masas / punto C(t_F) sobre la recta C(t)=(1,0,-1)t
                        % =========================
                        \coordinate (CMF) at ({\tF*\uNx},{\tF*\uNy},{\tF*\uNz});

                        % marca el CM en tF (sin quitar el origen)
                        \fill[yellow] (CMF) circle (0.6pt);

                        % flecha discontinua O -> CM(tF)
                        \draw[dashed, black, ->] (O) -- (CMF);

                        % Desplazamientos en C(t) (INICIALES: NO TOCAR, para que quede igual)
                        \def\sBig{0.4}
                        \def\sSmall{-0.3}

                        % =========================
                        % Masas (puntos sobre elipses)  (IGUAL QUE ANTES)
                        % =========================
                        \def\thBig{280}
                        \def\thSmall{200}

                        \pgfmathsetmacro{\PBx}{ (\sBig*\uNx) + (\EA*cos(\thBig))*\eoneX + (\EB*sin(\thBig))*\etwoX }
                        \pgfmathsetmacro{\PBy}{ (\sBig*\uNy) + (\EA*cos(\thBig))*\eoneY + (\EB*sin(\thBig))*\etwoY }
                        \pgfmathsetmacro{\PBz}{ (\sBig*\uNz) + (\EA*cos(\thBig))*\eoneZ + (\EB*sin(\thBig))*\etwoZ }

                        \pgfmathsetmacro{\PSx}{ (\sSmall*\uNx) + (\ea*cos(\thSmall))*\eoneX + (\eb*sin(\thSmall))*\etwoX }
                        \pgfmathsetmacro{\PSy}{ (\sSmall*\uNy) + (\ea*cos(\thSmall))*\eoneY + (\eb*sin(\thSmall))*\etwoY }
                        \pgfmathsetmacro{\PSz}{ (\sSmall*\uNz) + (\ea*cos(\thSmall))*\eoneZ + (\eb*sin(\thSmall))*\etwoZ }

                        % proyecta y define coords EN pantalla (sin doble transformación)
                        \tdplottransformmainscreen{\PBx}{\PBy}{\PBz}
                        \begin{scope}[tdplot_screen_coords]
                        \coordinate (PBscreen) at (\tdplotresx,\tdplotresy);
                        \end{scope}

                        \tdplottransformmainscreen{\PSx}{\PSy}{\PSz}
                        \begin{scope}[tdplot_screen_coords]
                        \coordinate (PSscreen) at (\tdplotresx,\tdplotresy);
                        \end{scope}

                        % esferas en pantalla
                        \begin{scope}[tdplot_screen_coords]
                        \shade[ball color=green!70!white, draw=green!40!black, opacity=0.7]
                            (PSscreen) circle[radius=2.0pt];
                        \shade[ball color=cyan!70!white, draw=cyan!40!black, opacity=0.7]
                            (PBscreen) circle[radius=1.0pt];
                        \end{scope}

                        % ============================================================
                        % NUEVO: estado FINAL en tF (sin borrar el inicial)
                        %   - avance en C(t): s -> s + tF
                        %   - fases: th -> th + omega*tF  (si quieres sentidos opuestos, aquí se cambia signo)
                        % ============================================================
                        \pgfmathsetmacro{\sBigF}{\sBig + \tF}
                        \pgfmathsetmacro{\sSmallF}{\sSmall + \tF}

                        % --- incrementos angulares totales (incluyendo vueltas completas)
                        \pgfmathsetmacro{\DthBig}{(\omegaBig*\tF + 360*\nTurns)}   % roja horario
                        \pgfmathsetmacro{\DthSmall}{ (\omegaSmall*\tF - 360*\nTurns)} % azul antihorario

                        \pgfmathsetmacro{\thBigF}{\thBig + \DthBig}     % ya incluye sentido y vueltas
                        \pgfmathsetmacro{\thSmallF}{\thSmall + \DthSmall}

                        \pgfmathsetmacro{\PBxF}{ (\sBigF*\uNx) + (\EA*cos(\thBigF))*\eoneX + (\EB*sin(\thBigF))*\etwoX }
                        \pgfmathsetmacro{\PByF}{ (\sBigF*\uNy) + (\EA*cos(\thBigF))*\eoneY + (\EB*sin(\thBigF))*\etwoY }
                        \pgfmathsetmacro{\PBzF}{ (\sBigF*\uNz) + (\EA*cos(\thBigF))*\eoneZ + (\EB*sin(\thBigF))*\etwoZ }

                        \pgfmathsetmacro{\PSxF}{ (\sSmallF*\uNx) + (\ea*cos(\thSmallF))*\eoneX + (\eb*sin(\thSmallF))*\etwoX }
                        \pgfmathsetmacro{\PSyF}{ (\sSmallF*\uNy) + (\ea*cos(\thSmallF))*\eoneY + (\eb*sin(\thSmallF))*\etwoY }
                        \pgfmathsetmacro{\PSzF}{ (\sSmallF*\uNz) + (\ea*cos(\thSmallF))*\eoneZ + (\eb*sin(\thSmallF))*\etwoZ }

                        % ------------------------------------------------------------
                        % NUEVO: hélices desde t=0 (tu estado actual) hasta t=tF
                        % ------------------------------------------------------------

                        \draw[red, thick, opacity=0.75]
                        plot[domain=0:1, samples=240, variable=\tau]
                        (
                        { (\sBig + \tF*\tau)*\uNx
                        + (\EA*cos(\thBig + \DthBig*\tau))*\eoneX
                        + (\EB*sin(\thBig + \DthBig*\tau))*\etwoX },
                        { (\sBig + \tF*\tau)*\uNy
                        + (\EA*cos(\thBig + \DthBig*\tau))*\eoneY
                        + (\EB*sin(\thBig + \DthBig*\tau))*\etwoY },
                        { (\sBig + \tF*\tau)*\uNz
                        + (\EA*cos(\thBig + \DthBig*\tau))*\eoneZ
                        + (\EB*sin(\thBig + \DthBig*\tau))*\etwoZ }
                        );

                        \draw[blue, thick, opacity=0.75]
                        plot[domain=0:1, samples=240, variable=\tau]
                        (
                        { (\sSmall + \tF*\tau)*\uNx
                        + (\ea*cos(\thSmall + \DthSmall*\tau))*\eoneX
                        + (\eb*sin(\thSmall + \DthSmall*\tau))*\etwoX },
                        { (\sSmall + \tF*\tau)*\uNy
                        + (\ea*cos(\thSmall + \DthSmall*\tau))*\eoneY
                        + (\eb*sin(\thSmall + \DthSmall*\tau))*\etwoY },
                        { (\sSmall + \tF*\tau)*\uNz
                        + (\ea*cos(\thSmall + \DthSmall*\tau))*\eoneZ
                        + (\eb*sin(\thSmall + \DthSmall*\tau))*\etwoZ }
                        );

                        % ------------------------------------------------------------
                        % NUEVO: esferas FINALES (tenues), sin tocar las iniciales
                        % (las dibujo al final para que queden encima)
                        % ------------------------------------------------------------
                        \tdplottransformmainscreen{\PBxF}{\PByF}{\PBzF}
                        \begin{scope}[tdplot_screen_coords]
                        \coordinate (PBscreenF) at (\tdplotresx,\tdplotresy);
                        \end{scope}

                        \tdplottransformmainscreen{\PSxF}{\PSyF}{\PSzF}
                        \begin{scope}[tdplot_screen_coords]
                        \coordinate (PSscreenF) at (\tdplotresx,\tdplotresy);
                        \end{scope}

                        \begin{scope}[tdplot_screen_coords]
                        \shade[ball color=green!70!black, draw=green!40!black]
                            (PSscreenF) circle[radius=2.0pt];
                        \shade[ball color=cyan!70!black, draw=cyan!40!black]
                            (PBscreenF) circle[radius=1.0pt];
                        \end{scope}

                        % =========================
                        % Flechas de sentido SOBRE LAS HÉLICES
                        % =========================
                        \def\dtau{0.08}      % longitud del tramo (0.03--0.12 suele ir bien)
                        \def\tauA{0.1}      % dónde empieza la flecha (cerca del final)

                        % --- Flecha roja (sobre hélice roja) ---
                        \draw[red, very thick, ->]
                        plot[domain=\tauA:\tauA+\dtau, samples=40, variable=\tau]
                        (
                        { (\sBig + \tF*\tau)*\uNx
                        + (\EA*cos(\thBig + \DthBig*\tau))*\eoneX
                        + (\EB*sin(\thBig + \DthBig*\tau))*\etwoX },
                        { (\sBig + \tF*\tau)*\uNy
                        + (\EA*cos(\thBig + \DthBig*\tau))*\eoneY
                        + (\EB*sin(\thBig + \DthBig*\tau))*\etwoY },
                        { (\sBig + \tF*\tau)*\uNz
                        + (\EA*cos(\thBig + \DthBig*\tau))*\eoneZ
                        + (\EB*sin(\thBig + \DthBig*\tau))*\etwoZ }
                        );

                        % --- Flecha azul (sobre hélice azul) ---
                        \draw[blue, very thick, ->]
                        plot[domain=\tauA:\tauA+\dtau, samples=40, variable=\tau]
                        (
                        { (\sSmall + \tF*\tau)*\uNx
                        + (\ea*cos(\thSmall + \DthSmall*\tau))*\eoneX
                        + (\eb*sin(\thSmall + \DthSmall*\tau))*\etwoX },
                        { (\sSmall + \tF*\tau)*\uNy
                        + (\ea*cos(\thSmall + \DthSmall*\tau))*\eoneY
                        + (\eb*sin(\thSmall + \DthSmall*\tau))*\etwoY },
                        { (\sSmall + \tF*\tau)*\uNz
                        + (\ea*cos(\thSmall + \DthSmall*\tau))*\eoneZ
                        + (\eb*sin(\thSmall + \DthSmall*\tau))*\etwoZ }
                        );

                    \end{scope}

                \end{tikzpicture}
                \caption{Situación del apartado c)}
                \label{fig:ej2c}
            \end{figure}
        \end{itemize}
    \end{ejercicio}

    \newpage

    \begin{ejercicio}
        Responde, de forma razonada, a las siguientes cuestiones:
        \begin{itemize}
            \item[a)] Determina qué condiciones debe cumplir la función $\alpha(t)$ para que la función
            $$x(t) = (\cos(\alpha(t)), \sen(\alpha(t)))$$
            sea solución de la ecuación 
            $$\ddot{x} = f(|x|)\dfrac{x}{|x|}$$
            con $f : ]0, +\infty[ \to \R$ una función continua dada. \\

            Por definición de $x(t)$, vemos que $|x(t)| \equiv 1$. Así pues, la ecuación toma la forma
            $$\ddot{x} = f(1) x$$

            Derivamos dos veces $x = x(t)$, no escribiendo explícitamente la dependencia de $\alpha$ y $x$ de $t$:

            $$\dot{x} = \dot{\alpha}(- \sen \alpha, \cos \alpha)$$
            $$\ddot{x} = \ddot{\alpha}(- \sen \alpha, \cos \alpha) - (\dot{\alpha})^2 (\cos \alpha, \sen \alpha)$$

            Vemos que para que se verifique la ecuación necesariamente $$\ddot{\alpha}(- \sen \alpha, \cos \alpha) = 0
            \Longrightarrow \ddot{\alpha} = 0 \Longrightarrow \alpha(t) = \alpha_0 + \omega t$$ para ciertos
            $\alpha_0, \omega \in \R^2$, de donde $\dot{\alpha}(t) = \omega$ \\

            La ecuación entonces queda en 
            $$\ddot{x} = f(1) x = - \omega^2 x$$
            y se deduce que la condición que debe cumplir $\alpha(t)$ para lo que se pide en el enunciado
            es $$f(1) = - \omega^2 \leqslant 0$$ 

            \item[b)] Clasifica la cónica 
            $$\sqrt{x^2 + y^2} + y/2 = 2$$
            y determina sus focos, su eje de excentricidad, su pericentro y su apocentro. \\

            Sabemos por teoría que la ecuación de la cónica es $|x| + \prodescalar{e}{x} = k$, con $e \in \R^2$ 
            y $k>0$. Por comparación directa, vemos que $e = (0, 1/2)$ y $k = 2$. Como $|e| = 1/2 < 1$, 
            la cónica es una elipse. \\

            Para seguir, pasamos a coordenadas polares

            $$r = \dfrac{k}{1 + \varepsilon \cos(\theta - \omega)}, \quad e = \varepsilon(\cos \omega, \sen \omega)$$

            Nuevamente, dado que ya sabemos que $e = 1/2(0,1)$, vemos que $\omega = \pi / 2$. \\

            Usando las fórmulas de pericentro y apocentro en polares, respectivamente

            $$r_{\min} = \dfrac{k}{1+\varepsilon} = \dfrac{2}{1+\dfrac{1}{2}} = \dfrac{4}{3}, \quad 
            r_{\max} = \dfrac{k}{1-\varepsilon} = \dfrac{2}{1-\dfrac{1}{2}} = 4$$

            Por tanto, el pericentro y apocentro, en coordenadas, son

            $$P = \left(0, \dfrac{4}{3} \right) \quad A = (0,-4)$$

            Para obtener los focos, primero obtenemos la longitud del semieje mayor $a$, usando que 
            $$a = \dfrac{k}{1-\varepsilon^2} = \dfrac{2}{1-(1/2)^2} = \dfrac{8}{3}$$

            y usamos la siguiente relación

            $$\varepsilon = \dfrac{c}{a} \iff c = a \varepsilon = \dfrac{8}{3} \cdot \dfrac{1}{2} = \dfrac{4}{3}$$

            Hemos obtenido la distancia entre focos. Ahora falta el centro de la elipse, como el punto medio
            entre el pericentro y el apocentro

            $$C = \dfrac{P+A}{2} = \left(0, \dfrac{4/3 - 4}{2}\right) = \left(0,-\dfrac{4}{3} \right)$$

            Por lo tanto, los focos son

            $$F_1 = C + (0,c) = \left(0, -\dfrac{4}{3} \right) + \left(0, \dfrac{4}{3} \right) = (0,0)$$
            $$F_2 = C - (0,c) = \left(0, -\dfrac{4}{3} \right) - \left(0, \dfrac{4}{3} \right) = \left(0, -\dfrac{8}{3} \right)$$

            \item[c)] De un planeta que se mueve bajo la acción de un Sol de masa $M$ situado en el origen
            de coordenadas se sabe que su posición en un determinado instante es $x_0 = (1/2, \sqrt{3}/2, 0)$
            y su velocidad en dicho instante $\dot{x}_0 = (- \sqrt{3}/2, 1/2, 0)$. Determina el eje de excentricidad
            del movimiento que describe, supuesto que $GM = 1$ y especifica, si es posible, dicho movimiento. \\

            Sea $t_0$ el instante que se menciona en el ejercicio. Sabemos que, por estar en un c.f.c. newtoniano,
            el momento angular es constante. Basta obtenerlo en $t_0$:

            $$c(t_0) = x(t_0) \land \dot{x}(t_0) = \begin{vmatrix}
                        1/2 & \sqrt{3}/2 & 0 \\
                -\sqrt{3}/2 &        1/2 & 0 \\
                i & j & k
            \end{vmatrix} = (0, 0, 1) \Longrightarrow |c| = 1 > 0$$

            por tanto, como $|c| \neq 0$, por teoría sabemos que el movimiento se hará en el plano $\Pi = \ortogonal{\{c\}}$, es decir,
            aquel plano con vector normal $c$ que pase por el origen. El plano verifica la ecuación
            $$Ax_1 + Bx_2 + Cx_3 + D = 0 \Longrightarrow x_3 = 0$$

            Así, la órbita de $x(t)$ queda contenida en el plano $\{x_3 = 0\}$. Por 
            la Primera Ley de Kepler, sabemos que será una cónica; elipse, hipérbola o parábola. \\

            Para determinarlo, podemos usar la energía total, usando que $\mu = GM = 1$
            $$h = \dfrac{1}{2} |\dot{x}(t_0)|^2 - \dfrac{\mu}{|x(t_0)|} = \dfrac{1}{2} \cdot 1^2 - \dfrac{1}{1} = -0.5 < 0$$

            Sabemos que $h < 0 \iff |e| < 1$, luego el movimiento descrito será elíptico.

            Ahora, podemos obtener el eje de excentricidad usando que 

            $$e = \dfrac{1}{\mu} \dot{x}(t) \land c - \dfrac{x(t)}{|x(t)|}$$

            para cierto instante $t$ de tiempo en el intervalo de definición maximal de la solución al problema
            de Kepler $x = x(t)$. Tomaremos $t_0$.

            Primero, vemos que 

            $$\dot{x}(t_0) \land c = \begin{vmatrix}
                -\sqrt{3}/2 & 1/2 & 0 \\
                          0 &   0 & 1 \\
                i & j & k
            \end{vmatrix} = (1/2, \sqrt{3}/2, 0) = x(t_0)$$

            Así,
            $$e = \dfrac{1}{\mu} \dot{x}(t_0) \land c - \dfrac{x(t_0)}{|x(t_0)|} = x(t_0) - x(t_0) = 0$$

            Por lo tanto, el movimiento es circular, en el plano $\{x_3 = 0\}$, con velocidad angular 
            $|\dot{x}(t_0)| = 1$.

        \end{itemize}
    \end{ejercicio}

\end{document}