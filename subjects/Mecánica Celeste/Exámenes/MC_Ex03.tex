\documentclass[12pt]{article}

\input{../../_assets/preambulo.tex}

\usetikzlibrary{arrows.meta,decorations.markings}

\newcommand{\R}{\mathbb{R}}
\newcommand{\prodescalar}[2]{\langle #1, #2 \rangle}
\newcommand{\ortogonal}[1]{#1^{\perp}}

\usepackage{tikz-3dplot}

\begin{document}

    % 1. Foto de fondo
    % 2. Título
    % 3. Encabezado Izquierdo
    % 4. Color de fondo
    % 5. Coord x del titulo
    % 6. Coord y del titulo
    % 7. Fecha

    
    \input{../../_assets/portada}
    \portadaExamen{ffccA4.jpg}{Mecánica Celeste\\Examen III}{Mecánica Celeste. Examen III}{MidnightBlue}{-8}{28}{2025}{José Manuel Sánchez Varbas}

    \begin{description}
        \item[Asignatura] Mecánica Celeste.
        \item[Curso Académico] 2023-24.
        \item[Grado] Grado en Matemáticas.
        \item[Grupo] A.
        \item[Descripción] Extraordinaria.
        \item[Fecha] 14 de Febrero de 2024. 
    \end{description}
    \newpage


    % ------------------------------------
    
    El número entre corchetes es la puntuación máxima de cada ejercicio o apartado.

    \begin{ejercicio}[2 puntos]
        De un planeta que se mueve bajo la acción de un Sol de masa $M$ situado en el origen de coordenadas
        se conoce su posición y su velocidad en un determinado instante. Supuesto que $GM = 1$, determina el 
        movimiento que describe si 
        \begin{itemize}
            \item[a)] $x(t_0) = (1,2,-1), \quad \dot{x}(t_0) = (-1,-2,1)$
            \item[b)] $x(t_0) = (1,2,-1), \quad \dot{x}(t_0) = (-1,0,1)$ 
        \end{itemize}
    \end{ejercicio}

    \begin{ejercicio}[4 puntos]
        Desde un observatorio astronómico fijo se está observando el movimiento de dos asteroides aislados
        que se mueven bajo la acción de la ley de gravitación de Newton. Cuando se comienzan las 
        observaciones, sus posiciones respecto al observatorio son $x(0) = (0,1,-1)$, $y(0) = (0,-3,3)$,
        y las velocidades con las que se mueven son $\dot{x}(0) = (1,1,-1)$, $\dot{y}(0) = (1,-3,-1)$.
        Se estima que la masa del asteroide que ocupa la posición $x$ es el triple de la del que está en la 
        posición $y$. Se pide:
        \begin{itemize}
            \item[a)] [1] Deduce el comportamiento del centro de masas del sistema que se observa desde la 
            posición del observatorio.
            \item[b)] [1] Determina el movimiento que se observará desde el centro de masas en función de la masa 
            $m$ del asteroide menor.
            \item[c)] [2] Explica cuál será el movimiento que vean los astrónomos desde el observatorio si 
            la masa $m \gg 1$. 
        \end{itemize}
    \end{ejercicio}

    \begin{ejercicio}[4 puntos]
        Dos masas, $m_1 = 4\cdot 10^{24}\,\mathrm{Kg}$ y $m_2 = 10^{24}\,\mathrm{Kg}$, 
        se mueven en órbitas circulares coplanarias alrededor de su centro de masas. 
        Se pretende colocar satélites en órbita en los puntos de libración $L_4$ y $L_5$ 
        correspondientes a esas masas primarias, que sabemos que son estables para el problema restringido de los 
        tres cuerpos circular. Se pide:
        \begin{enumerate}
            \item[a)] [1] Determinar la masa $\mu$ de la primaria más pequeña en las unidades apropiadas 
            para que la masa total de las primarias sea $1$ y encuentra 
            las coordenadas de los puntos de libración $L_4$ y $L_5$ en el sistema de referencia 
            con origen el centro de masas de las primarias, supuesto que la primaria de mayor masa se sitúa en el 
            punto $P_1 = (-\mu,0)$ y la otra en el $P_2 = (1-\mu,0)$.
            \item[b)] [1] Haz un esbozo del movimiento de los tres cuerpos si el satélite se sitúa en $L_4$.
            \item[c)] [2] Con los valores obtenidos en los apartados anteriores, probar que la función potencial
            $$
            \Phi(z) = \frac{1}{2}|z|^2 + \frac{1-\mu}{|P_1 - z|} + \frac{\mu}{|P_2 - z|} + \frac{1}{2}\mu(1-\mu),
            \quad z \in \mathbb{R}^2 \setminus \{P_1,P_2\},
            $$
            alcanza su mínimo absoluto en los puntos $L_4$ y $L_5$ y 
            calcula el valor de la constante de Jacobi en esos puntos.
        \end{enumerate}
    \end{ejercicio}

    \newpage

    \setcounter{ejercicio}{0}

    \begin{ejercicio}[2 puntos]
        De un planeta que se mueve bajo la acción de un Sol de masa $M$ situado en el origen de coordenadas
        se conoce su posición y su velocidad en un determinado instante. Supuesto que $GM = 1$, determina el 
        movimiento que describe si 
        \begin{itemize}
            \item[a)] $x(t_0) = (1,2,-1), \quad \dot{x}(t_0) = (-1,-2,1)$ \\
            
            Primero, vemos que $\dot{x}(t_0) = -x(t_0)$, es decir, ambos vectores son paralelos, 
            luego $\widehat{x(t_0),\dot{x}(t_0)} = 0$, y $|c| = 0$. Por la teoría de clasificación de movimientos 
            según el módulo del momento angular, sabemos que el movimiento es rectilíneo, y 
            $x(t) = r(t) v$, con $v \equiv x(t) / |x(t)|$, $|v|=1$, y $x(t) \in \R_{+}v$, 
            es decir, el movimiento se da a lo largo de la semirrecta con extremo inferior en el origen, y la 
            dirección y sentido de $v$. Podemos obtener $v$
            $$v = \dfrac{x(t)}{|x(t)|} = \dfrac{x(t_0)}{|x(t_0)|} = \dfrac{(1,2,-1)}{\sqrt{6}} \parallel (1,2,-1)$$
            Determinamos ahora la monotonía de $r$. Por estar en un c.f.c. tenemos que es conservativo, 
            luego la energía total se conserva. En particular, basta con obtenerla en $t_0$, dado que
            ya conocemos los valores de posición y velocidad en dicho instante, y que $\mu = GM = 1$
            
            $$h = \dfrac{1}{2} |\dot{x}(t_0)|^2 - \dfrac{\mu}{|x(t_0)|} = \dfrac{1}{2} 6 - \dfrac{1}{\sqrt{6}} = 
            3 - \dfrac{\sqrt{6}}{6} \approx 2.59 > 0$$

            Por teoría, la energía total en este tipo de movimiento también verifica $$h = \dfrac{1}{2} |\dot{r}(t)|^2 - \dfrac{1}{|r(t)|}$$
            y usando que $h > 0$
            $$h = \dfrac{1}{2} |\dot{r}(t)|^2 - \dfrac{1}{|r(t)|} > 0 \iff \dfrac{1}{2} |\dot{r}(t)|^2 > \dfrac{1}{|r(t)|} \iff |\dot{r}(t)| > \sqrt{\dfrac{2}{|r(t)|}}$$
            como $r(t) > 0 \Longrightarrow |r(t)| > 0$ y $\sqrt{\frac{2}{|r(t)|}} > 0$, luego 
            $$|\dot{r}(t)| > \sqrt{\dfrac{2}{|r(t)|}} > 0$$
            
            En particular, $\dot{r}(t) \neq 0$ para cualquier $t>0$. Como $r$ es una función continua (por ser solución), entonces $r$ es estrictamente monótona, con lo que basta obtener $\dot{r}(t_0)$ para algún $t_0 > 0$ para determinar el crecimiento o decrecimiento estricto de $r$.
            Como $$\dot{r}(t) \stackrel{|v|=1}{=} \dot{r}(t) \prodescalar{v}{v} = 
            \prodescalar{\dot{r}(t) v}{v} \stackrel{\dot{x}(t) = \dot{r}(t) v}{=} \prodescalar{\dot{x}(t)}{v}$$ 
            en particular, para $t_0$
            $$\dot{r}(t_0) = \prodescalar{\dot{x}(t_0)}{v} = -1 \cdot \dfrac{1}{\sqrt{6}} + (-2) \cdot \dfrac{2}{\sqrt{6}} + 
            1 \cdot \dfrac{-1}{\sqrt{6}} = \dfrac{-6}{\sqrt{6}} = - \sqrt{6} < 0$$

            Concluimos finalmente que $\dot{r} < 0$. Por tanto, el movimiento que sigue el planeta es el segundo visto en teoría
            en la clasificación de movimientos rectilíneos. 

            \item[b)] $x(t_0) = (1,2,-1), \quad \dot{x}(t_0) = (-1,0,1)$ \\
            
            Hallamos el valor del momento angular en $t_0$:

            $$c(t_0) = x(t_0) \land \dot{x}(t_0) = \begin{vmatrix}
                 1 & 2 & -1 \\
                -1 & 0 & 1 \\
                i & j & k
            \end{vmatrix} = (2, 0, 2) \Longrightarrow |c| = 2 \sqrt{2} > 0$$

            por tanto, como $|c| \neq 0$, por teoría sabemos que el movimiento se hará en el plano $\Pi = \ortogonal{\{c\}}$, es decir,
            aquel plano con vector normal $c$ que pase por el origen. El plano verifica la ecuación
            $$Ax_1 + Bx_2 + Cx_3 + D = 0 \Longrightarrow 2x_1 + 2x_3 = 0 \Longrightarrow x_1 + x_3 = 0$$

            Así, la órbita de $x(t)$ queda contenida en el plano $\{x_1 + x_3 = 0\}$. Por 
            la Primera Ley de Kepler, sabemos que será una cónica; elipse, hipérbola o parábola. \\

            Para determinarlo, podemos usar la energía total igual que en el apartado anterior
            $$h = \dfrac{1}{2} |\dot{x}(t_0)|^2 - \dfrac{\mu}{|x(t_0)|} = \dfrac{1}{2} \cdot 2 - \dfrac{1}{\sqrt{6}} = 
            1 - \dfrac{\sqrt{6}}{6} \approx 0.59 > 0$$

            Sabemos que $h > 0 \iff |e| > 1$, luego el movimiento descrito será hiperbólico.
        \end{itemize}
    \end{ejercicio}
    \newpage

    \begin{ejercicio}[2 puntos]
        Desde un observatorio astronómico fijo se está observando el movimiento de dos asteroides aislados
        que se mueven bajo la acción de la ley de gravitación de Newton. Cuando se comienzan las 
        observaciones, sus posiciones respecto al observatorio son $x(0) = (0,1,-1)$, $y(0) = (0,-3,3)$,
        y las velocidades con las que se mueven son $\dot{x}(0) = (1,1,-1)$, $\dot{y}(0) = (1,-3,-1)$.
        Se estima que la masa del asteroide que ocupa la posición $x$ es el triple de la del que está en la 
        posición $y$. Se pide:
        \begin{itemize}
            \item[a)] [1] Deduce el comportamiento del centro de masas del sistema que se observa desde la 
            posición del observatorio. \\

            Sabemos por teoría que $\ddot{C}(t) = 0$, o equivalentemente, $C(t) = \alpha + \beta t$, con
            $\alpha = C(t_0)$, $\beta = \dot{C}(t_0)$, siempre que $t_0 \in I$ pertenezca al intervalo
            maximal de definición\footnote{También por el Teorema de Existencia y Unicidad de
            las Ecuaciones Lineales visto en Ecuaciones Diferenciales I}. El enunciado dice cuando ``se comienzan las observaciones'', por lo que 
            ubicamos ahí el origen, y tomamos $t_0 = 0$. Entonces, denotando por $m_1$ a la masa
            del asteroide que ocupa la posición $x$, e igualmente $m_2$ a la masa del asteroide de posición $y$,
            se tiene que $m_1 = 3m_2$. Si $m_2 = m > 0$, se verifica $m_1 + m_2 = 4m$. \\

            Ahora, por definición, el centro de masas es 
            $$C(t) = \dfrac{m_1 x(t) + m_2 y(t)}{m_1 + m_2}$$
            y su derivada es 
            $$\dot{C}(t) = \dfrac{m_1 \dot{x}(t) + m_2 \dot{y}(t)}{m_1 + m_2}$$

            Obtenemos $\alpha = C(0)$ y $\beta = \dot{C}(0)$.
            $$\alpha = C(0) = \dfrac{3 x(0) + y(0)}{4}$$
            Como $3x(0) + y(0) = 3(0,1,-1) + (0,-3,3) = (0,0,0)$, entonces 
            $$\alpha = \dfrac{1}{4}(0,0,0) = (0,0,0)$$
            Análogamente, $3\dot{x}(0) + \dot{y}(0) = 3(1,1,-1) + (1,-3,-1) = (4,0,-4)$, luego
            $$\beta = \dfrac{1}{4}(4,0,-4) = \left(1, 0, -1 \right)$$

            Por lo tanto,

            $$\boxed{C(t) = \left( 1, 0, -1 \right)t}$$

            \newpage

            \item[b)] [1] Determina el movimiento que se observará desde el centro de masas en función de la masa 
            $m$ del asteroide menor. \\

            Consideramos el sistema con centro de masas fijo en el origen, utilizando el Principio de Relatividad
            de Galileo, $\tilde{x}(t) = x(t) - \alpha - \beta t$, $\tilde{y}(t) = y(t) - \alpha - \beta t$
            donde $C(t) = \alpha + \beta t$ ya calculado en el apartado anterior. \\

            Sabemos que entonces $(\tilde{x}, \tilde{y})$ es solución al mismo problema de los dos cuerpos y el centro de masas en este sistema
            verifica $\tilde{C}(t) \equiv 0$. Consecuentemente 
            $$m_1 \tilde{x} + m_2 \tilde{y} = 0 \Longrightarrow \tilde{y} = - \dfrac{m_1}{m_2} \tilde{x} = - 3 \tilde{x}$$

            Si el asteroide identificado por $\tilde{x}$ sigue la cónica $|\tilde{x}| + \prodescalar{e}{\tilde{x}} = k$ con $e \in \R^3$ y $k>0$
            entonces se ha visto en teoría que el asteroide identificado por $y$ sigue la cónica 
            $|\tilde{y}| + \prodescalar{-e}{\tilde{y}} = 3k$,
            es decir, las dos cónicas son del mismo tipo, y los ejes de excentricidad opuestos. \\

            El asteroide identificado por $\tilde{x}$ (visto en teoría) sigue un problema de Kepler

            $$\ddot{\tilde{x}} = - G\dfrac{m_2^3}{(m_1+m_2)^2} \dfrac{\tilde{x}}{|\tilde{x}|^3} = 
            - G \dfrac{m}{16} \dfrac{\tilde{x}}{|\tilde{x}|^3} = - \mu \dfrac{\tilde{x}}{|\tilde{x}|^3}$$

            Estudiamos uno de los dos asteroides, y el otro ya lo tendremos. Obtenemos el momento angular $c_{\tilde{x}}$, 
            primero viendo que 
            $$\tilde{x}(0) = x(0) - \alpha = (0,1,-1),
            \quad \dot{\tilde{x}}(0) = \dot{x}(0) - \beta = \left(0, 1, 0 \right)$$ 

            $$c_{\tilde{x}} = \tilde{x}(0) \land \dot{\tilde{x}}(0) = \begin{vmatrix}
                0 & 1 & -1 \\
                0 & 1 & 0 \\
                i & j & k
            \end{vmatrix} = \left(1, 0, 0 \right) \Longrightarrow |c_{\tilde{x}}| \neq 0$$

            Tenemos entonces que ambos cuerpos se moverán sobre una elipse, hipérbola o parábola, con un
            foco en el origen, por la Primera Ley de Kepler. Para determinar la cónica, obtenemos la energía total.

            $$h = \dfrac{1}{2} |\dot{\tilde{x}}(0)|^2 - \dfrac{\mu}{|\tilde{x}(0)|}$$

            Viendo que
            $$|\tilde{x}(0)|^2 = 0^2 + 1^2 + \left( - 1 \right)^2 =
            2 \Longrightarrow 
            |\tilde{x}(0)| = \sqrt{2}$$
            y
            $$|\dot{\tilde{x}}(0)|^2 = 1$$

            Como $$h = \dfrac{1}{2} |\dot{\tilde{x}}(0)|^2 - \dfrac{\mu}{|\tilde{x}(0)|} = 
            \dfrac{1}{2} \cdot 1 - \dfrac{Gm}{16} \dfrac{1}{\sqrt{2}} = $$
            $$\dfrac{1}{2} - \dfrac{\sqrt{2}Gm}{32}$$

            el tipo de movimiento visto desde el sistema con centro de masas fijo en el origen dependerá entonces de la 
            masa $m$.
            \begin{itemize}
                \item Será elíptica si y solo si $$h<0 \iff \dfrac{1}{2} - \dfrac{\sqrt{2}Gm}{32}
                < 0 \iff \dfrac{1}{2} < \dfrac{\sqrt{2}Gm}{32} \iff \dfrac{8 \sqrt{2}}{G} = \dfrac{32}{2 \sqrt{2} \cdot G} < m$$
                \item Será parabólica si y solo si
                $$h = 0 \iff m = \dfrac{8 \sqrt{2}}{G}$$
                \item Será hiperbólica si y solo si
                $$h>0 \iff m < \dfrac{8 \sqrt{2}}{G}$$
            \end{itemize}

            Y el otro cuerpo seguirá la misma cónica. \\

            \item[c)] [2] Explica cuál será el movimiento que vean los astrónomos desde el observatorio si 
            la masa $m \gg 1$. \\

            Si $m \gg 1$ (suponiendo unidades normalizadas), en particular $$ m \gg \dfrac{8 \sqrt{2}}{G}$$ de donde $h \ll 0$, luego la trayectoria de ambos cuerpos será elíptica,
            con ejes de excentricidad opuestos. Teniendo en cuenta que los astrónomos observan desde el observatorio,
            y que el centro de masas está en movimiento, pues, por el apartado a), sabemos que $C(t) = \left( 1, 0, -1 \right)t$,
            entonces las trayectorias elípticas se producirán simultáneamente con la traslación
            del centro de masas a lo largo de la recta $r \equiv (1,0,-1)t$, resultando en movimientos helicoidales
            descritos por ambos cuerpos a lo largo de la recta $r$. Esto se ha representado en la Figura \ref{fig:ej2c} siguiente:
     
            \begin{figure}
                % Ángulo de cámara
                \tdplotsetmaincoords{70}{150}    
                \noindent\hspace*{-2.7cm}%
                \begin{tikzpicture}[tdplot_main_coords, scale=2]
                    \shorthandoff{>}

                    % separación entre “cortes”
                    \def\DX{5.5cm}

                    % =====================================================
                    % ===============  PRIMERA SITUACIÓN  ====================
                    % =====================================================
                    \begin{scope}[xshift=0cm]

                        % =========================
                        % Triedro de referencia (ejes 3D)
                        % =========================
                        \def\L{3}
                        \draw[thick, ->] (0,0,0) -- (\L,0,0) node[above left] {$x$};
                        \draw[thick, ->] (0,0,0) -- (0,\L,0) node[above right] {$y$};
                        \draw[thick, ->] (0,0,0) -- (0,0,\L) node[above right] {$z$};

                        % =========================
                        % Recta C(t) = (1,0,-1)t
                        % =========================
                        \def\L{2.2}
                        \draw[very thick, green, ->] (-\L, 0, \L) -- (\L, 0, -\L);

                        % =========================
                        % Datos 3D
                        % =========================
                        \pgfmathsetmacro{\uNx}{1}
                        \pgfmathsetmacro{\uNy}{0}
                        \pgfmathsetmacro{\uNz}{-1}

                        \pgfmathsetmacro{\vNx}{0}
                        \pgfmathsetmacro{\vNy}{0}
                        \pgfmathsetmacro{\vNz}{1}

                        \coordinate (O) at (0,0,0);

                        % (opcionales)
                        \draw[->, white, thick] (0,0,0) -- (1.2,0,0) node[below] {$x$};
                        \draw[->, white, thick] (0,0,0) -- (0,1.2,0) node[left]  {$y$};
                        \draw[->, white, thick] (0,0,0) -- (0,0,1.2) node[left]  {$z$};

                        \draw[very thick, green] (-1.6,0, 1.6) -- (1.6,0,-1.6);

                        % =========================
                        % Plano span{u,v}
                        % =========================
                        \def\aU{1.4}
                        \def\bV{1.2}

                        \coordinate (P1) at ({ \aU*\uNx + \bV*\vNx},{ \aU*\uNy + \bV*\vNy},{ \aU*\uNz + \bV*\vNz});
                        \coordinate (P2) at ({-\aU*\uNx + \bV*\vNx},{-\aU*\uNy + \bV*\vNy},{-\aU*\uNz + \bV*\vNz});
                        \coordinate (P3) at ({-\aU*\uNx - \bV*\vNx},{-\aU*\uNy - \bV*\vNy},{-\aU*\uNz - \bV*\vNz});
                        \coordinate (P4) at ({ \aU*\uNx - \bV*\vNx},{ \aU*\uNy - \bV*\vNy},{ \aU*\uNz - \bV*\vNz});
                        \draw[thick, brown] (P1)--(P2)--(P3)--(P4)--cycle;

                        \fill[yellow] (O) circle (0.6pt);

                        % =========================
                        % Base ortonormal del plano
                        % =========================
                        \pgfmathsetmacro{\invSqrtTwo}{0.70710678}

                        \pgfmathsetmacro{\eoneX}{ \invSqrtTwo}
                        \pgfmathsetmacro{\eoneY}{ 0}
                        \pgfmathsetmacro{\eoneZ}{-\invSqrtTwo}

                        \pgfmathsetmacro{\etwoX}{ \invSqrtTwo}
                        \pgfmathsetmacro{\etwoY}{ 0}
                        \pgfmathsetmacro{\etwoZ}{ \invSqrtTwo}

                        % Semiejes
                        \def\EA{1.10}
                        \def\EB{0.55}
                        \def\ea{0.65}
                        \def\eb{0.33}

                        % Desplazamientos en C(t)
                        \def\sBig{0.4}
                        \def\sSmall{-0.3}

                        % =========================
                        % Elipses
                        % =========================
                        \draw[thick, red]
                        plot[domain=0:360, samples=220, variable=\t]
                        (
                        { \sBig*\uNx + (\EA*cos(\t))*\eoneX + (\EB*sin(\t))*\etwoX },
                        { \sBig*\uNy + (\EA*cos(\t))*\eoneY + (\EB*sin(\t))*\etwoY },
                        { \sBig*\uNz + (\EA*cos(\t))*\eoneZ + (\EB*sin(\t))*\etwoZ }
                        );

                        \draw[thick, blue]
                        plot[domain=0:360, samples=220, variable=\t]
                        (
                        { \sSmall*\uNx + (\ea*cos(\t))*\eoneX + (\eb*sin(\t))*\etwoX },
                        { \sSmall*\uNy + (\ea*cos(\t))*\eoneY + (\eb*sin(\t))*\etwoY },
                        { \sSmall*\uNz + (\ea*cos(\t))*\eoneZ + (\eb*sin(\t))*\etwoZ }
                        );

                        % =========================
                        % Masas (puntos sobre elipses)
                        % =========================
                        \def\thBig{280}
                        \def\thSmall{200}

                        \pgfmathsetmacro{\PBx}{ (\sBig*\uNx) + (\EA*cos(\thBig))*\eoneX + (\EB*sin(\thBig))*\etwoX }
                        \pgfmathsetmacro{\PBy}{ (\sBig*\uNy) + (\EA*cos(\thBig))*\eoneY + (\EB*sin(\thBig))*\etwoY }
                        \pgfmathsetmacro{\PBz}{ (\sBig*\uNz) + (\EA*cos(\thBig))*\eoneZ + (\EB*sin(\thBig))*\etwoZ }

                        \pgfmathsetmacro{\PSx}{ (\sSmall*\uNx) + (\ea*cos(\thSmall))*\eoneX + (\eb*sin(\thSmall))*\etwoX }
                        \pgfmathsetmacro{\PSy}{ (\sSmall*\uNy) + (\ea*cos(\thSmall))*\eoneY + (\eb*sin(\thSmall))*\etwoY }
                        \pgfmathsetmacro{\PSz}{ (\sSmall*\uNz) + (\ea*cos(\thSmall))*\eoneZ + (\eb*sin(\thSmall))*\etwoZ }

                        % proyecta y define coords EN pantalla (sin doble transformación)
                        \tdplottransformmainscreen{\PBx}{\PBy}{\PBz}
                        \begin{scope}[tdplot_screen_coords]
                        \coordinate (PBscreen) at (\tdplotresx,\tdplotresy);
                        \end{scope}

                        \tdplottransformmainscreen{\PSx}{\PSy}{\PSz}
                        \begin{scope}[tdplot_screen_coords]
                        \coordinate (PSscreen) at (\tdplotresx,\tdplotresy);
                        \end{scope}

                        % esferas en pantalla
                        \begin{scope}[tdplot_screen_coords]
                        \shade[ball color=green!70!white, draw=green!40!black]
                            (PSscreen) circle[radius=3.0pt];
                        \shade[ball color=cyan!70!white, draw=cyan!40!black]
                            (PBscreen) circle[radius=1.0pt];
                        \end{scope}

                        % =========================
                        % Flechas de sentido
                        % =========================
                        \def\dth{20}

                        \def\thArrowRed{282}
                        \draw[red, very thick, ->]
                        plot[domain=\thArrowRed:\thArrowRed+\dth, samples=40, variable=\t]
                        (
                        { \sBig*\uNx + (\EA*cos(\t))*\eoneX + (\EB*sin(\t))*\etwoX },
                        { \sBig*\uNy + (\EA*cos(\t))*\eoneY + (\EB*sin(\t))*\etwoY },
                        { \sBig*\uNz + (\EA*cos(\t))*\eoneZ + (\EB*sin(\t))*\etwoZ }
                        );

                        \def\thArrowBlue{190}
                        \draw[blue, very thick, ->]
                        plot[domain=\thArrowBlue:0.8*\thArrowBlue-\dth, samples=40, variable=\t]
                        (
                        { \sSmall*\uNx + (\ea*cos(\t))*\eoneX + (\eb*sin(\t))*\etwoX },
                        { \sSmall*\uNy + (\ea*cos(\t))*\eoneY + (\eb*sin(\t))*\etwoY },
                        { \sSmall*\uNz + (\ea*cos(\t))*\eoneZ + (\eb*sin(\t))*\etwoZ }
                        );

                    \end{scope}

                    % =====================================================
                    % Flecha central hacia la derecha (entre cortes)
                    % Ajusta coordenadas si la quieres más arriba/abajo
                    % =====================================================
                    \draw[very thick, ->] (1.5cm,0.7cm) -- (3cm,0.7cm);

                    % =====================================================
                    % ===============  SEGUNDA SITUACIÓN  ======================
                    % (avanza en C(t) + avanza fase => lectura helicoidal)
                    % =====================================================

                    \begin{scope}[xshift=\DX]
                        \def\tF{0.8}          % <-- ajusta el instante final

                        % =========================
                        % Triedro de referencia (ejes 3D)
                        % =========================
                        \def\L{3}
                        \draw[thick, ->] (0,0,0) -- (\L,0,0) node[above left] {$x$};
                        \draw[thick, ->] (0,0,0) -- (0,\L,0) node[above right] {$y$};
                        \draw[thick, ->] (0,0,0) -- (0,0,\L) node[above right] {$z$};

                        % =========================
                        % Recta C(t) = (1,0,-1)t
                        % =========================
                        \def\L{2.2}
                        \draw[very thick, green, ->] (-\L, 0, \L) -- (\L, 0, -\L);

                        % =========================
                        % Datos 3D
                        % =========================
                        \pgfmathsetmacro{\uNx}{1}
                        \pgfmathsetmacro{\uNy}{0}
                        \pgfmathsetmacro{\uNz}{-1}

                        \pgfmathsetmacro{\vNx}{0}
                        \pgfmathsetmacro{\vNy}{0}
                        \pgfmathsetmacro{\vNz}{1}

                        \coordinate (O) at (0,0,0);

                        % (opcionales)
                        \draw[->, white, thick] (0,0,0) -- (1.2,0,0) node[below] {$x$};
                        \draw[->, white, thick] (0,0,0) -- (0,1.2,0) node[left]  {$y$};
                        \draw[->, white, thick] (0,0,0) -- (0,0,1.2) node[left]  {$z$};

                        \draw[very thick, green] (-1.6,0, 1.6) -- (1.6,0,-1.6);

                        % =========================
                        % Plano span{u,v} (centrado para abarcar toda la hélice)
                        % =========================

                        % Centro del plano = punto medio del recorrido del CM: C(tF/2)
                        \pgfmathsetmacro{\tMid}{0.5*\tF}
                        \coordinate (Pc) at ({\tMid*\uNx},{\tMid*\uNy},{\tMid*\uNz});

                        % Semiextensiones del plano:
                        % - en dirección u: debe cubrir el desplazamiento 0 -> tF (más margen)
                        % - en dirección v: ancho "visual" (ajusta a gusto)
                        \pgfmathsetmacro{\aU}{0.5*\tF + 1.2}  % margen 1.2 (ajusta)
                        \def\bV{1.2}

                        \coordinate (P1) at ({\tMid*\uNx + \aU*\uNx + \bV*\vNx},
                                            {\tMid*\uNy + \aU*\uNy + \bV*\vNy},
                                            {\tMid*\uNz + \aU*\uNz + \bV*\vNz});
                        \coordinate (P2) at ({\tMid*\uNx - \aU*\uNx + \bV*\vNx},
                                            {\tMid*\uNy - \aU*\uNy + \bV*\vNy},
                                            {\tMid*\uNz - \aU*\uNz + \bV*\vNz});
                        \coordinate (P3) at ({\tMid*\uNx - \aU*\uNx - \bV*\vNx},
                                            {\tMid*\uNy - \aU*\uNy - \bV*\vNy},
                                            {\tMid*\uNz - \aU*\uNz - \bV*\vNz});
                        \coordinate (P4) at ({\tMid*\uNx + \aU*\uNx - \bV*\vNx},
                                            {\tMid*\uNy + \aU*\uNy - \bV*\vNy},
                                            {\tMid*\uNz + \aU*\uNz - \bV*\vNz});
                        \draw[thick, brown] (P1)--(P2)--(P3)--(P4)--cycle;

                        % =========================
                        % Base ortonormal del plano
                        % =========================
                        \pgfmathsetmacro{\invSqrtTwo}{0.70710678}

                        \pgfmathsetmacro{\eoneX}{ \invSqrtTwo}
                        \pgfmathsetmacro{\eoneY}{ 0}
                        \pgfmathsetmacro{\eoneZ}{-\invSqrtTwo}

                        \pgfmathsetmacro{\etwoX}{ \invSqrtTwo}
                        \pgfmathsetmacro{\etwoY}{ 0}
                        \pgfmathsetmacro{\etwoZ}{ \invSqrtTwo}

                        % Semiejes
                        \def\EA{1.10}
                        \def\EB{0.55}
                        \def\ea{0.65}
                        \def\eb{0.33}

                        % ============================================================
                        % NUEVO: parámetro de tiempo final y velocidades angulares
                        % ============================================================
                        \def\omegaBig{75}     % (grados/unidad tiempo) roja
                        \def\omegaSmall{75}   % (grados/unidad tiempo) azul
                        \def\nTurns{2} % <-- número de vueltas extra (entero: 0,1,2,...)

                        % ============================================================
                        % Recta que une ambos centros de masas en cada instante
                        % ============================================================

                        \fill[yellow] (O) circle (0.6pt);

                        % =========================
                        % Centro de masas / punto C(t_F) sobre la recta C(t)=(1,0,-1)t
                        % =========================
                        \coordinate (CMF) at ({\tF*\uNx},{\tF*\uNy},{\tF*\uNz});

                        % marca el CM en tF (sin quitar el origen)
                        \fill[yellow] (CMF) circle (0.6pt);

                        % flecha discontinua O -> CM(tF)
                        \draw[dashed, black, ->] (O) -- (CMF);

                        % Desplazamientos en C(t) (INICIALES: NO TOCAR, para que quede igual)
                        \def\sBig{0.4}
                        \def\sSmall{-0.3}

                        % =========================
                        % Masas (puntos sobre elipses)  (IGUAL QUE ANTES)
                        % =========================
                        \def\thBig{280}
                        \def\thSmall{200}

                        \pgfmathsetmacro{\PBx}{ (\sBig*\uNx) + (\EA*cos(\thBig))*\eoneX + (\EB*sin(\thBig))*\etwoX }
                        \pgfmathsetmacro{\PBy}{ (\sBig*\uNy) + (\EA*cos(\thBig))*\eoneY + (\EB*sin(\thBig))*\etwoY }
                        \pgfmathsetmacro{\PBz}{ (\sBig*\uNz) + (\EA*cos(\thBig))*\eoneZ + (\EB*sin(\thBig))*\etwoZ }

                        \pgfmathsetmacro{\PSx}{ (\sSmall*\uNx) + (\ea*cos(\thSmall))*\eoneX + (\eb*sin(\thSmall))*\etwoX }
                        \pgfmathsetmacro{\PSy}{ (\sSmall*\uNy) + (\ea*cos(\thSmall))*\eoneY + (\eb*sin(\thSmall))*\etwoY }
                        \pgfmathsetmacro{\PSz}{ (\sSmall*\uNz) + (\ea*cos(\thSmall))*\eoneZ + (\eb*sin(\thSmall))*\etwoZ }

                        % proyecta y define coords EN pantalla (sin doble transformación)
                        \tdplottransformmainscreen{\PBx}{\PBy}{\PBz}
                        \begin{scope}[tdplot_screen_coords]
                        \coordinate (PBscreen) at (\tdplotresx,\tdplotresy);
                        \end{scope}

                        \tdplottransformmainscreen{\PSx}{\PSy}{\PSz}
                        \begin{scope}[tdplot_screen_coords]
                        \coordinate (PSscreen) at (\tdplotresx,\tdplotresy);
                        \end{scope}

                        % esferas en pantalla
                        \begin{scope}[tdplot_screen_coords]
                        \shade[ball color=green!70!white, draw=green!40!black, opacity=0.7]
                            (PSscreen) circle[radius=3.0pt];
                        \shade[ball color=cyan!70!white, draw=cyan!40!black, opacity=0.7]
                            (PBscreen) circle[radius=1.0pt];
                        \end{scope}

                        % ============================================================
                        % NUEVO: estado FINAL en tF (sin borrar el inicial)
                        %   - avance en C(t): s -> s + tF
                        %   - fases: th -> th + omega*tF  (si quieres sentidos opuestos, aquí se cambia signo)
                        % ============================================================
                        \pgfmathsetmacro{\sBigF}{\sBig + \tF}
                        \pgfmathsetmacro{\sSmallF}{\sSmall + \tF}

                        % --- incrementos angulares totales (incluyendo vueltas completas)
                        \pgfmathsetmacro{\DthBig}{(\omegaBig*\tF + 360*\nTurns)}   % roja horario
                        \pgfmathsetmacro{\DthSmall}{ (\omegaSmall*\tF - 360*\nTurns)} % azul antihorario

                        \pgfmathsetmacro{\thBigF}{\thBig + \DthBig}     % ya incluye sentido y vueltas
                        \pgfmathsetmacro{\thSmallF}{\thSmall + \DthSmall}

                        \pgfmathsetmacro{\PBxF}{ (\sBigF*\uNx) + (\EA*cos(\thBigF))*\eoneX + (\EB*sin(\thBigF))*\etwoX }
                        \pgfmathsetmacro{\PByF}{ (\sBigF*\uNy) + (\EA*cos(\thBigF))*\eoneY + (\EB*sin(\thBigF))*\etwoY }
                        \pgfmathsetmacro{\PBzF}{ (\sBigF*\uNz) + (\EA*cos(\thBigF))*\eoneZ + (\EB*sin(\thBigF))*\etwoZ }

                        \pgfmathsetmacro{\PSxF}{ (\sSmallF*\uNx) + (\ea*cos(\thSmallF))*\eoneX + (\eb*sin(\thSmallF))*\etwoX }
                        \pgfmathsetmacro{\PSyF}{ (\sSmallF*\uNy) + (\ea*cos(\thSmallF))*\eoneY + (\eb*sin(\thSmallF))*\etwoY }
                        \pgfmathsetmacro{\PSzF}{ (\sSmallF*\uNz) + (\ea*cos(\thSmallF))*\eoneZ + (\eb*sin(\thSmallF))*\etwoZ }

                        % ------------------------------------------------------------
                        % NUEVO: hélices desde t=0 (tu estado actual) hasta t=tF
                        % ------------------------------------------------------------

                        \draw[red, thick, opacity=0.75]
                        plot[domain=0:1, samples=240, variable=\tau]
                        (
                        { (\sBig + \tF*\tau)*\uNx
                        + (\EA*cos(\thBig + \DthBig*\tau))*\eoneX
                        + (\EB*sin(\thBig + \DthBig*\tau))*\etwoX },
                        { (\sBig + \tF*\tau)*\uNy
                        + (\EA*cos(\thBig + \DthBig*\tau))*\eoneY
                        + (\EB*sin(\thBig + \DthBig*\tau))*\etwoY },
                        { (\sBig + \tF*\tau)*\uNz
                        + (\EA*cos(\thBig + \DthBig*\tau))*\eoneZ
                        + (\EB*sin(\thBig + \DthBig*\tau))*\etwoZ }
                        );

                        \draw[blue, thick, opacity=0.75]
                        plot[domain=0:1, samples=240, variable=\tau]
                        (
                        { (\sSmall + \tF*\tau)*\uNx
                        + (\ea*cos(\thSmall + \DthSmall*\tau))*\eoneX
                        + (\eb*sin(\thSmall + \DthSmall*\tau))*\etwoX },
                        { (\sSmall + \tF*\tau)*\uNy
                        + (\ea*cos(\thSmall + \DthSmall*\tau))*\eoneY
                        + (\eb*sin(\thSmall + \DthSmall*\tau))*\etwoY },
                        { (\sSmall + \tF*\tau)*\uNz
                        + (\ea*cos(\thSmall + \DthSmall*\tau))*\eoneZ
                        + (\eb*sin(\thSmall + \DthSmall*\tau))*\etwoZ }
                        );

                        % ------------------------------------------------------------
                        % NUEVO: esferas FINALES (tenues), sin tocar las iniciales
                        % (las dibujo al final para que queden encima)
                        % ------------------------------------------------------------
                        \tdplottransformmainscreen{\PBxF}{\PByF}{\PBzF}
                        \begin{scope}[tdplot_screen_coords]
                        \coordinate (PBscreenF) at (\tdplotresx,\tdplotresy);
                        \end{scope}

                        \tdplottransformmainscreen{\PSxF}{\PSyF}{\PSzF}
                        \begin{scope}[tdplot_screen_coords]
                        \coordinate (PSscreenF) at (\tdplotresx,\tdplotresy);
                        \end{scope}

                        \begin{scope}[tdplot_screen_coords]
                        \shade[ball color=green!70!black, draw=green!40!black]
                            (PSscreenF) circle[radius=3.0pt];
                        \shade[ball color=cyan!70!black, draw=cyan!40!black]
                            (PBscreenF) circle[radius=1.0pt];
                        \end{scope}

                        % =========================
                        % Flechas de sentido SOBRE LAS HÉLICES
                        % =========================
                        \def\dtau{0.08}      % longitud del tramo (0.03--0.12 suele ir bien)
                        \def\tauA{0.1}      % dónde empieza la flecha (cerca del final)

                        % --- Flecha roja (sobre hélice roja) ---
                        \draw[red, very thick, ->]
                        plot[domain=\tauA:\tauA+\dtau, samples=40, variable=\tau]
                        (
                        { (\sBig + \tF*\tau)*\uNx
                        + (\EA*cos(\thBig + \DthBig*\tau))*\eoneX
                        + (\EB*sin(\thBig + \DthBig*\tau))*\etwoX },
                        { (\sBig + \tF*\tau)*\uNy
                        + (\EA*cos(\thBig + \DthBig*\tau))*\eoneY
                        + (\EB*sin(\thBig + \DthBig*\tau))*\etwoY },
                        { (\sBig + \tF*\tau)*\uNz
                        + (\EA*cos(\thBig + \DthBig*\tau))*\eoneZ
                        + (\EB*sin(\thBig + \DthBig*\tau))*\etwoZ }
                        );

                        % --- Flecha azul (sobre hélice azul) ---
                        \draw[blue, very thick, ->]
                        plot[domain=\tauA:\tauA+\dtau, samples=40, variable=\tau]
                        (
                        { (\sSmall + \tF*\tau)*\uNx
                        + (\ea*cos(\thSmall + \DthSmall*\tau))*\eoneX
                        + (\eb*sin(\thSmall + \DthSmall*\tau))*\etwoX },
                        { (\sSmall + \tF*\tau)*\uNy
                        + (\ea*cos(\thSmall + \DthSmall*\tau))*\eoneY
                        + (\eb*sin(\thSmall + \DthSmall*\tau))*\etwoY },
                        { (\sSmall + \tF*\tau)*\uNz
                        + (\ea*cos(\thSmall + \DthSmall*\tau))*\eoneZ
                        + (\eb*sin(\thSmall + \DthSmall*\tau))*\etwoZ }
                        );

                    \end{scope}

                \end{tikzpicture}
                \caption{Situación del apartado c)}
                \label{fig:ej2c}
            \end{figure}
        \end{itemize}
    \end{ejercicio}

    \newpage

    \begin{ejercicio}[4 puntos]
        Dos masas, $m_1 = 4\cdot 10^{24}\,\mathrm{Kg}$ y $m_2 = 10^{24}\,\mathrm{Kg}$, 
        se mueven en órbitas circulares coplanarias alrededor de su centro de masas. 
        Se pretende colocar satélites en órbita en los puntos de libración $L_4$ y $L_5$ 
        correspondientes a esas masas primarias, que sabemos que son estables para el problema restringido de los 
        tres cuerpos circular. Se pide:
        \begin{enumerate}
            \item[a)] [1] Determinar la masa $\mu$ de la primaria más pequeña en las unidades apropiadas 
            para que la masa total de las primarias sea $1$ y encuentra 
            las coordenadas de los puntos de libración $L_4$ y $L_5$ en el sistema de referencia 
            con origen el centro de masas de las primarias, supuesto que la primaria de mayor masa se sitúa en el 
            punto $P_1 = (-\mu,0)$ y la otra en el $P_2 = (1-\mu,0)$. \\

            Sabemos que $m_1 = 1 - \mu$, $m_2 = \mu$, $\mu \in ]0, 1/2]$ y $m_1 + m_2 = 1$, 
            por lo que la masa $\mu$ en las unidades apropiadas será

            $$\mu = \dfrac{m_2}{m_1 + m_2} = 
            \dfrac{10^{24}\,\mathrm{Kg}}{4\cdot 10^{24}\,\mathrm{Kg} + 10^{24}\,\mathrm{Kg}} = \dfrac{1}{5}$$

            Por teoría sabemos que tanto $L_4$ como $L_5$, colocándolos como vértices, forman un triángulo equilátero de lado $1$ con las primarias. Por lo tanto, 
            los puntos de libración $L_4$ y $L_5$ son aquellos $z \in \mathbb{R}^2$ que verifican $$|z - P_1| = |z-P_2| = |P_1 - P_2| = 1$$
            Deducimos entonces que la abscisa de $L_4$ y $L_5$ está en la mediatriz de las primarias, es decir:
            $$M = \dfrac{P_1+P_2}{2} = \left(\dfrac{-\mu + 1 - \mu}{2},0 \right) = \left(\dfrac{1 - 2 \mu}{2},0 \right) = \left(\dfrac{1}{2} - \mu,0 \right)$$

            Denotando por $z = (x,y)$, entonces $x = \nicefrac{1}{2} - \mu$. \\

            Para obtener la altura, imponemos $|z-P_1| = 1$ (también se podría imponer $|z-P_2| = 1$). Como 
            $$z-P_1 = \left( \dfrac{1}{2} - \mu - (-\mu),y \right) = \left( \dfrac{1}{2},y \right)$$
            Entonces 
            $$|z-P_1| = 1 \iff |z-P_1|^2 = 1 \iff \left( \dfrac{1}{2} \right)^2 + y^2 = 1 \iff y^2 = 1 - \dfrac{1}{4} = \dfrac{3}{4} \iff y = \pm \dfrac{\sqrt{3}}{2}$$

            Consecuentemente 

            $$L_4 = \left( \dfrac{1}{2} - \mu, \dfrac{\sqrt{3}}{2} \right), \quad L_5 = \left( \dfrac{1}{2} - \mu, -\dfrac{\sqrt{3}}{2} \right)$$

            Sustituyendo $\mu = \nicefrac{1}{5}$

            $$L_4 = \left( \dfrac{3}{10}, \dfrac{\sqrt{3}}{2} \right), \quad L_5 = \left( \dfrac{3}{10}, -\dfrac{\sqrt{3}}{2} \right)$$

            \newpage

            \item[b)] [1] Haz un esbozo del movimiento de los tres cuerpos si el satélite se sitúa en $L_4$. \\

            \begin{center}
                \begin{tikzpicture}[scale=2.7, line cap=round, line join=round]
                \shorthandoff{>}
                \definecolor{cM1}{RGB}{120,190,230}   % m1 (azul)
                \definecolor{cM2}{RGB}{ 60,200,110}   % m2 (verde)
                \definecolor{cL4}{RGB}{230,140, 40}   % L4 (naranja)
                \definecolor{tri}{RGB}{210, 70,210}   % triángulo (magenta)

                % --- origen ---
                \coordinate (O) at (0,0);

                \coordinate (m1) at ( 0.70,  0.32);
                \coordinate (m2) at (-1.1264624985, -0.4948832686);

                % equilátero lado 2 con L_4
                \coordinate (L4) at ( 0.4924783624, -1.6692045571);


                % --- tres órbitas concéntricas centradas en O ---
                \draw[dashed, line width=0.9pt, cM1, dash pattern=on 5pt off 4pt]
                (O) circle[radius=0.75]
                node[pos=0.15, above right, white] {$m_1$};

                \draw[dashed, line width=0.9pt, cM2, dash pattern=on 5pt off 4pt]
                (O) circle[radius=1.24]
                node[pos=0.10, above, white] {$m_2$};

                \draw[dashed, line width=0.9pt, cL4, dash pattern=on 5pt off 4pt]
                (O) circle[radius=1.74]
                node[pos=0.05, above left, white] {$L_4$};

                % --- triángulo punteado (si lo quieres mantener) ---
                \draw[dashed, tri, line width=1.0pt, dash pattern=on 4pt off 3pt]
                (m1)--(L4)--(m2)--cycle;

                % --- puntos (colores aproximados) ---
                \fill[cM1] (m1) circle[radius=0.18];
                \fill[cM2] (m2) circle[radius=0.09];
                \fill[cL4] (L4) circle[radius=0.04];
                \fill[black] (O)  circle[radius=0.03];

                % --- etiquetas de los puntos ---
                \node[black] at ($(m1)+(0.2,0.2)$) {$m_1$};
                \node[black] at ($(m2)+(-0.15,-0.15)$) {$m_2$};
                \node[black] at ($(L4)+(0.12,-0.1)$) {$L_4$};

                \draw[-{Stealth[length=2mm, width=2mm]}, black, thick]
                (0.59,0.47) to[bend right=7] (0.45,0.6);

                \draw[-{Stealth[length=2mm, width=2mm]}, black, thick]
                (-1.09,-0.585) to[bend right=3] (-1,-0.74);

                \draw[-{Stealth[length=2mm, width=2mm]}, black, thick]
                (0.535,-1.665) to[bend right=5] (0.65,-1.6);

                \end{tikzpicture}
            \end{center}

            En el sistema inercial (con centro de masas fijo en el origen) las dos primarias describen una órbita circular a la misma velocidad angular, así como
            el satélite situado en $L_4$. De esta manera, en cada instante los tres vértices están a distancia fija $|P_1 - P_2| = 1$, formando un triángulo equilátero de lado $1$,
            que rota rígidamente (sin deformarse) alrededor del centro de masas. 

            \newpage

            \item[c)] [2] Con los valores obtenidos en los apartados anteriores, probar que la función potencial
            $$
            \Phi(z) = \frac{1}{2}|z|^2 + \frac{1-\mu}{|P_1 - z|} + \frac{\mu}{|P_2 - z|} + \frac{1}{2}\mu(1-\mu),
            \quad z \in \mathbb{R}^2 \setminus \{P_1,P_2\},
            $$
            alcanza su mínimo absoluto en los puntos $L_4$ y $L_5$ y 
            calcula el valor de la constante de Jacobi en esos puntos. \\

            Sea $\rho_1 = |z-P_1|$ y $\rho_2 = |z-P_2|$. Buscamos expresar $|z|^2$ en función de $\rho_1$ y $\rho_2$.
            Primero 
            $$|z-P_1|^2 = |z|^2 + |P_1|^2 - 2 z P_1$$
            $$|z-P_2|^2 = |z|^2 + |P_2|^2 - 2 z P_2$$
            Multiplicando la primera por $(1-\mu)$ y la segunda por $\mu$, y sumándolas, obtenemos
            \begin{equation}\label{eq:ec1}
                (1-\mu)\rho_1^2 + \mu \rho_2^2 = |z|^2 + (1 - \mu)|P_1|^2 + \mu |P_2|^2 -
                2z \cdot ((1-\mu)P_1 + \mu P_2)
            \end{equation}

            Como el centro de masas está en el origen, entonces $(1 - \mu)P_1 + \mu P_2 = 0$, y
            además sabemos que $|P_1|^2 = \mu^2$ y $|P_2|^2 = (1-\mu)^2$, de donde
            \begin{equation}\label{eq:ec2}
                (1-\mu)|P_1|^2 + \mu|P_2|^2 = (1-\mu) \mu^2 + \mu (1-\mu)^2 = \mu (1-\mu)
            \end{equation}

            Sustituyendo (\ref{eq:ec2}) en (\ref{eq:ec1})
            \begin{equation}\label{eq:ec3}
                (1-\mu)\rho_1^2 + \mu \rho_2^2 = |z|^2 + \mu(1-\mu) \iff 
                |z|^2 = (1-\mu)\rho_1^2 + \mu \rho_2^2 - \mu (1-\mu)
            \end{equation}

            Recuperando la función potencial dada en el enunciado, multiplicamos por $2$ a ambos lados, obteniendo
            \begin{gather}\label{eq:ec4}
                2\Phi(z) = |z|^2 + \frac{2(1-\mu)}{\rho_1} + \frac{2\mu}{\rho_2} + \mu(1-\mu),
            \quad z \in \mathbb{R}^2 \setminus \{P_1,P_2\},
            \end{gather}

            y sustituimos (\ref{eq:ec3}) en (\ref{eq:ec4}), llegando a

            $$2 \Phi(z) = [(1-\mu)\rho_1^2 + \mu \rho_2^2 - \mu (1-\mu)] + 
            \frac{2(1-\mu)}{\rho_1} + \frac{2\mu}{\rho_2} + \mu(1-\mu) =$$
            $$(1-\mu)\rho_1^2 + \mu \rho_2^2 + \frac{2(1-\mu)}{\rho_1} + \frac{2\mu}{\rho_2}$$
            Factorizando con $(1-\mu)$ y $\mu$, conseguimos la expresión cómoda

            \begin{equation}\label{eq:ec5}
                2 \Phi(z) = (1 - \mu) \left(\rho_1^2 + \dfrac{2}{\rho_1} \right) + \mu 
                \left(\rho_2^2 + \dfrac{2}{\rho_2} \right)
            \end{equation}


            Sea ahora la función \Func{g}{\mathbb{R}^{+}}{\mathbb{R}}{\rho}{\rho^2 + \dfrac{2}{\rho}}
            Vemos que 
            $$g'(\rho) = 2 \rho - \dfrac{2}{\rho^2}, \quad g''(\rho) = 2 + \dfrac{4}{\rho^3} > 0 \quad \forall \rho > 0$$
            Por lo que $g$ es estrictamente convexa, y su mínimo global se alcanza en los puntos críticos $g'(\rho) = 0$,
            es decir,
            $$g'(\rho) = 0 \iff 2 \rho - \dfrac{2}{\rho^2} = 0 \iff \cancel{2} \rho = \dfrac{\cancel{2}}{\rho^2} 
            \iff \rho^3 = 1 \iff \rho = 1$$
            Además, $g(1) = 1+2 = 3$, y, por ser $\rho = 1$ mínimo, $g(\rho) \geqslant 3 \quad \forall \rho > 0$.
            Teniendo esto en cuenta, vemos que de (\ref{eq:ec5}) se deduce que 
            $$2 \Phi(z) \geqslant (1 - \mu) \cdot 3 + \mu \cdot 3 = 3 \Longrightarrow \Phi(z) \geqslant \dfrac{3}{2}$$
            El mínimo de $\Phi$ se alcanza en caso de que $g(\rho_1) = 3 = g(\rho_2)$, es decir, $\rho_1 = 1 = \rho_2$,
            pero como $\rho_1 = |z - P_1| = 1 = |z-P_2| = \rho_2$, y los únicos puntos que verifican
            esto último son $L_4$ y $L_5$, por lo realizado en el apartado a), queda demostrado que
            $\Phi$ alcanza su mínimo absoluto en los puntos $L_4$ y $L_5$. \\

            Falta calcular la constante de Jacobi en $L_4$ y $L_5$. Por definición, $$J = 2 \Phi(z(t)) - |\dot{z}(t)|^2$$
            Como $L_4$ y $L_5$ son puntos de equilibrio en el problema restringido circular (demostrado en 
            teoría), entonces la solución $z = z(t)$ es constante, $z(t) \equiv c$, luego $\dot{z}(t) \equiv 0$. 
            Entonces $J(c) = 2 \Phi(c)$, y como hemos visto que el mínimo absoluto de $\Phi$ se alcanza en 
            $L_4$ y $L_5$, y además $\Phi(L_4) = \Phi(L_5) = \nicefrac{3}{2}$, concluimos que
            $$J(L_4) = J(L_5) = 2 \cdot \dfrac{3}{2} = 3$$
        \end{enumerate}
    \end{ejercicio}

\end{document}