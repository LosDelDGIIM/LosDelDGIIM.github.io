\subsection{Relación 2. Integracion Numérica}
\setcounter{ejercicio}{0}


\begin{ejercicio}~\label{ej:2.3.1}
    En la integración numérica se obtienen fórmulas simples, con pocos nodos, para aproximar la integral en un intervalo $[a, b]$. Estas fórmulas, al tener pocos nodos, no dan resultados satisfactorios en ocasiones, pero unas tienen un mayor grado de exactitud que otras.
    \begin{enumerate}
        \item Explica cómo podrías obtener fórmulas de tipo interpolatorio clásico con más exactitud de $n$, cuando puedes elegir libremente los nodos de interpolación: $x_0, \ldots, x_n$.
        
        Al tratarse de fórmulas de tipo interpolatorio con $n+1$ nodos, sabemos que tendrán grado mínimo de exactitud $n$. Para añadir $k$ grados de exactitud más, hemos de imponer exactitud en $\{x^i\Pi(x)\mid i\in \{0,1,\ldots,k-1\}\}$, donde $k\in \{1,2,n+1\}$.

        \item Sea $a$ igual a la suma de los dígitos de tu DNI; sea $b = a + 3$. Calcula la fórmula con nodos $a, x_1$ de mayor grado de exactitud para aproximar la integral entre $a$ y $b$.
        
        Buscamos por tanto la siguiente fórmula de tipo interpolatorio:
        \begin{equation*}
            \int_{a}^{b} f(x)dx \approx \alpha_0 f(a) + \alpha_1 f(x_1)
        \end{equation*}

        Definimos el siguiente polinomio:
        \begin{equation*}
            \Pi(x) = (x-a)(x-x_1) = x^2 - (a+x_1)x + ax_1
        \end{equation*}

        Sabemos que será exacta en $\bb{P}_1$, y el grado máximo de exactitud es $2\cdot 1+1=3$. Por tanto, buscamos por tanto imponer exactitud en $\{\Pi(x), x\Pi(x)\}$.
        \begin{align*}
            0 = \int_{a}^{b} \Pi(x)dx &= \int_{a}^{b} (x^2 - (a+x_1)x + ax_1)dx = \left[\dfrac{x^3}{3} - \dfrac{(a+x_1)x^2}{2} + ax_1x\right]_{a}^{a+3}\\
            &= \left[\dfrac{(a+3)^3}{3} - \dfrac{(a+x_1)(a+3)^2}{2} + ax_1(a+3)\right] - \left[\dfrac{a^3}{3} - \dfrac{(a+x_1)a^2}{2} + ax_1a\right]\\
            &= 3[a^2+3a+3] - \dfrac{(a+x_1)(6a+9)}{2} + 3ax_1\\
            &= \cancel{3a^2} + 9a + 9 - \cancel{3a^2}-\cancel{3ax_1} - \dfrac{9}{2}(a+x_1) + \cancel{3ax_1}\\
            &= \dfrac{9}{2}\left(2a+2-a-x_1\right) = \dfrac{9}{2}(a+2-x_1)
        \end{align*}

        Por tanto, tenemos que $x_1 = a + 2$, y ya tenemos determinados los nodos.
        \begin{equation*}
            \int_{a}^{b} f(x)dx \approx \alpha_0 f(a) + \alpha_1 f(a+2)
        \end{equation*}

        Buscamos ahora los coeficientes $\alpha_0$ y $\alpha_1$, imponiendo exactitud en $\{1,x\}$:
        \begin{align*}
            \int_{a}^{b} 1 &= b-a = 3 = \alpha_0 + \alpha_1\\
            \int_{a}^{b} x &= \left[\dfrac{x^2}{2}\right]_{a}^{a+3} = \dfrac{(a+3)^2}{2} - \dfrac{a^2}{2} = \dfrac{6a+9}{2} = \alpha_0\cdot a + \alpha_1\cdot (a+2)
        \end{align*}

        Tenemos por tanto el siguiente sistema de ecuaciones:
        \begin{equation*}
            \begin{cases}
                \alpha_0 + \alpha_1 = 3\\
                a(\alpha_0 + \alpha_1) + 2\alpha_1 = \dfrac{6a + 9}{2}
            \end{cases}
        \end{equation*}

        La segunda ecuación queda como:
        \begin{equation*}
            a\cdot 3 + 2\alpha_1 = \dfrac{6a + 9}{2} \Longrightarrow 2\alpha_1 = \dfrac{6a + 9-6a}{2} \Longrightarrow \alpha_1 = \dfrac{9}{4}
        \end{equation*}

        Sustituyendo en la primera ecuación:
        \begin{equation*}
            \alpha_0 + \dfrac{9}{4} = 3 \Longrightarrow \alpha_0 = \dfrac{3}{4}
        \end{equation*}

        Por tanto, la fórmula de integración numérica es:
        \begin{equation*}
            \int_{a}^{b} f(x)dx \approx \dfrac{3}{4}\left(f(a) + 3f(a+2)\right)
        \end{equation*}

        Sabemos que esta fórmula es exacta en $\bb{P}_2$, veamos ahora si lo es para $x^3$:
        \begin{align*}
            \int_{a}^{b} x^3 &= \left[\dfrac{x^4}{4}\right]_{a}^{a+3} = \dfrac{(a+3)^4}{4} - \dfrac{a^4}{4} = \dfrac{12a^3 + 54a^2 + 108a + 81}{4}\\
            &\neq \dfrac{3}{4}\left(a^3 + 3(a+2)^3\right) = \dfrac{3}{4}\left(a^3 + 3(a^3+6a^2 + 12a + 8)\right) = \dfrac{3}{4}\left(4a^3 + 18a^2 + 36a + 24\right)
            =\\&= \dfrac{12a^3 + 54a^2 + 108a + 72}{4}
        \end{align*}

        Por tanto, como la fórmula no es exacta en $x^3$, el grado de exactitud es $2$.

        \item Sea $f:\bb{R}\to \bb{R}$ dada por:
        \begin{equation*}
            f(x) = \begin{cases}
                x^2 & x\leq 0 \\
                -x^2 & x > 0
            \end{cases}
        \end{equation*}

        Aplica la fórmula simple obtenida para aproximar, previo cambio de variable si es necesario, el valor de la integral: $\int_{-1}^{1} f(x)dx$.

        Buscamos un cambio de variable que nos permita aplicar la fórmula obtenida, transformando el intervalo $[a,a+3]$ en $[x_0,x_0+h]$.
        Sea este cambio de variable:
        \begin{equation*}
            x = x_0 + h\cdot \frac{t-a}{3}\qquad \forall t\in [a,a+3]
        \end{equation*}

        De esta forma, tenemos que:
        \begin{equation*}
            \int_{x_0}^{x_0+h} f(x)dx = \int_{a}^{a+3} f\left(x_0 + h\cdot \frac{t-a}{3}\right)\cdot \frac{h}{3}dt
        \end{equation*}

        Por tanto, aplicando la fórmula obtenida:
        \begin{align*}
            \int_{x_0}^{x_0+h} f(x)dx &\approx \dfrac{h}{3}\cdot \dfrac{3}{4}\left(f(x_0) + 3f\left(x_0 + h\cdot \frac{2}{3}\right)\right)
            = \dfrac{h}{4}\left(f(x_0) + 3f\left(x_0 + h\cdot \frac{2}{3}\right)\right)
        \end{align*}

        En nuestro caso, tenemos que $x_0 = -1$, $h = 2$. Por tanto:
        \begin{align*}
            \int_{-1}^{1} f(x)dx &\approx \dfrac{2}{4}\left(f(-1) + 3f\left(-1+\dfrac{2\cdot 2}{3}\right)\right)
            = \dfrac{1}{2}\left(1+3f\left(\dfrac{1}{3}\right)\right)\\
            &= \dfrac{1}{2}\left(1 + 3\cdot -\left(\dfrac{1}{3}\right)^2\right) = \dfrac{1}{2}\left(1 - \dfrac{1}{3}\right) = \dfrac{1}{2}\cdot \dfrac{2}{3} = \dfrac{1}{3}
        \end{align*}

        \item Aplica la fórmula compuesta asociada a la fórmula simple, haciendo dos subintervalos a partir del $[-1,1]$, para aproximar el mismo valor de la integral anterior.
        
        Tenemos que:
        \begin{align*}
            \int_{-1}^{1} f(x)dx &= \int_{-1}^{0} f(x)dx + \int_{0}^{1} f(x)dx
            \approx \dfrac{1}{4}\left[f(-1) + 3f\left(-1+\dfrac{2}{3}\right) + f(0) + 3f\left(0+\dfrac{2}{3}\right)\right]
            =\\&= \dfrac{1}{4}\left[f(-1) + 3f\left(-\dfrac{1}{3}\right) + f(0) + 3f\left(\dfrac{2}{3}\right)\right]
            =\\&= \dfrac{1}{4}\left[1 + 3\cdot \dfrac{1}{9} + 0 -3\cdot \dfrac{4}{9}\right] = 0
        \end{align*}
        \item ¿Qué puedes decir del error de la fórmula simple obtenida, de la compuesta asociada a ella y de sus aplicaciones particulares en el apartado anterior?
        
        El error de interpolación cometido al interpolar mediante los puntos $a,a+2$ es:
        \begin{equation*}
            E(x)=f[a,a+2,x]\Pi(x)\qquad \text{donde}\qquad \Pi(x) = (x-a)(x-(a+2))
            = x^2 - 2(1+a)x + a(a+2)
        \end{equation*}

        Por tanto, el error cometido al aproximar la integral por la fórmula simple es:
        \begin{equation*}
            R(f) = \int_{a}^{b} E(x) = \int_{a}^{a+3} f[a,a+2,x]\Pi(x)dx
        \end{equation*}

        Como $\Pi(x)$ cambia de signo en $[a,a+3]$, no podemos aplicar el Teorema del Valor Medio Integral Generalizado. Usamos que:
        \begin{multline*}
            f[a,a+2,a+2,x] = \dfrac{f[a,a+2,x]-f[a,a+2,a+2]}{x-(a+2)} \Longrightarrow\\ \Longrightarrow f[a,a+2,x] = f[a,a+2,a+2,x](x-(a+2)) + f[a,a+2,a+2]
        \end{multline*}

        Por tanto, tenemos que:
        \begin{align*}
            R(f) &= \int_{a}^{a+3}\left(f[a,a+2,a+2,x](x-(a+2)) + f[a,a+2,a+2]\right)\Pi(x)dx
            =\\&= \int_{a}^{a+3} f[a,a+2,a+2,x](x-(a+2))\Pi(x)dx + f[a,a+2,a+2]\int_{a}^{a+3} \Pi(x)dx
        \end{align*}

        Tenemos que calcular ahora ambas integrales. Por un lado, como es exacta en $\Pi(x)$, sabemos que:
        \begin{equation*}
            \int_{a}^{a+3} \Pi(x)dx = 0
        \end{equation*}

        Por otro lado, como $(x-(a+2))\Pi(x)$ no cambia de signo en $[a,a+3]$ y es un polinomio de grado $3$, podemos aplicar el Teorema del Valor Medio Integral Generalizado. Por tanto, existe $\mu\in [a,a+3]$ tal que:
        \begin{equation*}
            R(f) = f[a,a+2,a+2,\mu]\int_{a}^{a+2} (x-(a+2))\Pi(x)dx
        \end{equation*}

        Calculamos dicha integral:
        \begin{align*}
            \int_{a}^{a+2} &(x-(a+2))\Pi(x)dx = \int_{a}^{a+2} (x-a)(x-(a+2))^2dx
            =\\&= \int_{a}^{a+2} (x-a)((x-a)-2)^2dx
            = \int_{a}^{a+2} (x-a)((x-a)^2 - 4(x-a) + 4)dx
            =\\&= \int_{a}^{a+2} (x-a)^3 - 4(x-a)^2 + 4(x-a)dx
            = \left[\dfrac{(x-a)^4}{4} - \dfrac{4(x-a)^3}{3} + 4\dfrac{(x-a)^2}{2}\right]_{a}^{a+2}
            =\\&= \left[\dfrac{(3)^4}{4} - \dfrac{4(3)^3}{3} + 4\dfrac{(3)^2}{2}\right] = \dfrac{9}{4}
        \end{align*}
        
        Por tanto, el error cometido al aproximar la integral por la fórmula simple es:
        \begin{equation*}
            R(f) = f[a,a+2,a+2,\mu]\cdot \dfrac{9}{4}
        \end{equation*}

        Por las propiedades de las diferencias divididas, sabemos que $\exists \xi\in [a,a+3]$ tal que:
        \begin{equation*}
            R(f) = \dfrac{9f'''(\xi)}{4\cdot 3!} = \dfrac{3f'''(\xi)}{8}
        \end{equation*}

        Por tanto, el error cometido al aproximar la integral por la fórmula compuesta es:
        \begin{equation*}
            R(f) = \dfrac{3}{8}\left(f'''(\xi_1) + f'''(\xi_2)\right)
            = \dfrac{3}{4}f'''(\xi)
        \end{equation*}
        con $\xi\in [a,a+3]$.
    \end{enumerate}
\end{ejercicio}

\begin{ejercicio}~\label{ej:2.3.2}
    Determina razonadamente si es posible diseñar una fórmula numérica de tipo interpolatorio en el espacio generado por $\{1, x, x^2, x^4\}$ para aproximar
    \begin{equation*}
        \int_{-2}^{2} f(x) dx + \int_{-2}^{2} |x|f(x) dx
    \end{equation*}
    usando para ello los datos $\int_{-1}^{1} f(x) dx$, $\int_{-1}^{1} |x|f(x) dx$, $f(0)$ y $f'(0)$. En particular determina el peso de $f'(0)$.\\


    En primer lugar, buscamos el interpolante $p\in V=\cc{L}\{1,x,x^2,x^4\}$ que verifique $L_i(p)=L_i(f)$ para $i=0,1,2,3$, donde:
    \begin{align*}
        L_0(f) &= \int_{-1}^{1} f(x)dx,\\
        L_1(f) &= \int_{-1}^{1} |x|f(x)dx,\\
        L_2(f) &= f(0),\\
        L_3(f) &= f'(0).
    \end{align*}

    Recordemos que $L_i(f)$ es conocido para $i=0,1,2,3$.
    Sea por tanto:
    \begin{equation*}
        p(x)=a+bx+cx^2+dx^4\in V
    \end{equation*}

    Tenemos que:
    \begin{align*}
        L_0(f) &= L_0(p) = \int_{-1}^{1} p(x)dx = \int_{-1}^{1} (a + bx + cx^2 + dx^4)dx = 2\left[a + \dfrac{c}{3} + \dfrac{d}{5}\right]\\
        L_1(f) &= L_1(p) = \int_{-1}^{1} |x|p(x)dx = \int_{-1}^{1} |x|(a + bx + cx^2 + dx^4)dx = 2\left[\dfrac{a}{2} + \dfrac{c}{4} + \dfrac{d}{6}\right]\\
        L_2(f) &= L_2(p) = p(0) = a,\\
        L_3(f) &= L_3(p) = p'(0) = b.
    \end{align*}

    Por tanto, los valores de $a$ y $b$ ya están determinados, y tenemos que resolver el siguiente sistema de ecuaciones:
    \begin{equation*}
        \begin{cases}
            2\left[a + \dfrac{c}{3} + \dfrac{d}{5}\right] = L_0(f)\\
            2\left[\dfrac{a}{2} + \dfrac{c}{4} + \dfrac{d}{6}\right] = L_1(f)\\
            a = L_2(f)\\
            b = L_3(f)
        \end{cases}
    \end{equation*}
    
    Para determinar si este sistema tiene solución (que es lo que nos interesa), basta con comprobar que el siguiente determinante es distinto de cero:
    \begin{equation*}
        \det\begin{pmatrix}
            2 & 0 & \nicefrac{2}{3} & \nicefrac{2}{5}\\
            1 & 0 & \nicefrac{1}{2} & \nicefrac{1}{3}\\
            1 & 0 & 0 & 0\\
            0 & 1 & 0 & 0
        \end{pmatrix} = -\det\begin{pmatrix}
            \nicefrac{2}{3} & \nicefrac{2}{5}\\
            \nicefrac{1}{2} & \nicefrac{1}{3}
        \end{pmatrix} = -\dfrac{2}{3}\cdot \dfrac{1}{3} + \dfrac{2}{5}\cdot \dfrac{1}{2} = -\dfrac{2}{9} + \dfrac{1}{5}\neq 0
    \end{equation*}

    Por tanto, el sistema tiene solución, y por tanto es posible encontrar el interpolante $p\in V$ que verifique las condiciones impuestas. Ahora, es necesario comprobar si existen $\alpha_0, \alpha_1, \alpha_2, \alpha_3$ tales que:
    \begin{align*}
        \sum_{i=0}^{3} \alpha_i L_i(f) &= L(p)
    \end{align*}

    Calculamos $L(p)$:
    \begin{align*}
        L(p) &= \int_{-2}^{2} p(x)dx + \int_{-2}^{2} |x|p(x)dx
    \end{align*}

    Calculamos cada una de las integrales:
    \begin{align*}
        \int_{-2}^{2} p(x)dx &= \int_{-2}^{2} (a + bx + cx^2 + dx^4)dx = 2\left[2a+ \dfrac{c\cdot 2^3}{3} + \dfrac{d\cdot 2^5}{5}\right]
        = 4a + \dfrac{16c}{3} + \dfrac{64d}{5}
        \\
        \int_{-2}^{2} |x|p(x)dx &= \int_{-2}^{2} |x|(a + bx + cx^2 + dx^4)dx = 2\left[\dfrac{a\cdot 2^2}{2} + \dfrac{c\cdot 2^4}{4} + \dfrac{d\cdot 2^6}{6}\right]
        = 4a + 8c + \dfrac{64d}{3}
    \end{align*}

    Por tanto, tenemos que:
    \begin{align*}
        L(p) &= 8a + \dfrac{40c}{3} + \dfrac{512d}{15}
    \end{align*}

    Para probar la existencia de $\alpha_0, \alpha_1, \alpha_2, \alpha_3$ tales que se tiene lo pedido, basta con ver que lo anterior es una combinación lineal de los $L_i(f)$; y para ello, basta con comprobar que $c$ y $d$ son una combinación lineal de los $L_i(f)$, ya que $a$ y $b$ ya lo son. Observando el sistema vemos que esto se tiene (no van a quedar multiplicándose ni dividiéndose, solo sumando), luego queda demostrada la existencia de $\alpha_0, \alpha_1, \alpha_2, \alpha_3$ tales que se tiene lo pedido.

    Para obtener el peso de $f'(0)$, basta con obtener el coeficiente de $b$ en la expresión de $L(p)$. Vemos que no aparece explícitamente, y tampoco aparecerá en $c$ ni en $d$ (puesto que $c,d$ dependerán de sí mismos y de $a$). Pore tanto, el peso de $f'(0)$ es $0$.
\end{ejercicio}

\begin{ejercicio}~\label{ej:2.3.3}
    Considera la fórmula de cuadratura simple del trapecio en la forma
    \begin{equation*}
        \int_{a}^{b} f(x) dx = T(a, b) + R(f).
    \end{equation*}
    \begin{enumerate}
        \item Obtén la expresión del error $R(f)$ para $f$ suficientemente regular.
        
        La fórmula del trapecio es:
        \begin{equation*}
            T(a, b) = \dfrac{b-a}{2}\left(f(a) + f(b)\right)
        \end{equation*}

        El error de interpolación cometido es:
        \begin{equation*}
            E(x) = f[a,b,x]\Pi(x)\qquad \text{donde}\qquad \Pi(x) = (x-a)(x-b)
        \end{equation*}

        Por tanto, el error cometido al aproximar la integral por la fórmula del trapecio es:
        \begin{equation*}
            R(f) = \int_{a}^{b} E(x)dx = \int_{a}^{b} f[a,b,x]\Pi(x)dx
        \end{equation*}

        Como $\Pi(x)$ no cambia de signo en $[a,b]$ y es un polinomio de grado $2$, podemos aplicar el Teorema del Valor Medio Integral Generalizado. Por tanto, existe $\mu\in [a,b]$ tal que:
        \begin{equation*}
            R(f) = f[a,b,\mu]\int_{a}^{b} \Pi(x)dx
        \end{equation*}

        Calculamos dicha integral:
        \begin{align*}
            \int_{a}^{b} \Pi(x)dx &= \int_{a}^{b} (x-a)(x-b)dx = \int_{a}^{b} (x^2 - (a+b)x + ab)dx
            = \left[\dfrac{x^3}{3} - \dfrac{(a+b)x^2}{2} + abx\right]_{a}^{b}\\
            &= \dfrac{b^3-a^3}{3} - \dfrac{(a+b)(b^2-a^2)}{2} + ab(b-a)
            =\\&= \dfrac{b^3-a^3}{3} - \dfrac{(a+b)^2(b-a)}{2} + ab(b-a)
            =\\&= \dfrac{2b^3-2a^3-3a^2(b-a)-\cancel{6ab(b-a)}-3b^2(b-a)+\cancel{6ab(b-a)}}{6}
            =\\&= \dfrac{2b^3-2a^3-3a^2b+3a^3-3b^3+3b^2a}{6}
            =\\&= \dfrac{-b^3+a^3-3a^2b+3b^2a}{6} = \dfrac{(a-b)^3}{6}
        \end{align*}

        Por tanto, el error cometido al aproximar la integral por la fórmula del trapecio es:
        \begin{equation*}
            R(f) = f[a,b,\mu]\cdot \dfrac{(a-b)^3}{6}
        \end{equation*}

        Por las propiedades de las diferencias divididas, sabemos que $\exists \xi\in [a,b]$ tal que:
        \begin{equation*}
            R(f) = -\dfrac{f''(\xi)(b-a)^3}{12}
        \end{equation*}
        \item Obtén la fórmula compuesta asociada y la correspondiente expresión del error.
        
        Tenemos que la fórmula compuesta asociada a la del trapecio es:
        \begin{equation*}
            \int_{a}^{b} f(x) dx = \sum_{i=0}^{n-1}\int_{x_i}^{x_{i+1}} f(x) dx = \sum_{i=0}^{n-1} \dfrac{h}{2}\left(f(x_i) + f(x_{i+1})\right)
            = \dfrac{h}{2}\left(f(a) + 2\sum_{i=1}^{n-1} f(x_i) + f(b)\right)
        \end{equation*}
        donde $h = \frac{b-a}{n}$ y $x_i = a + ih$ para $i=0,1,\ldots,n$.

        El error de interpolación cometido al aproximar la integral por la fórmula compuesta del trapecio es:
        \begin{equation*}
            R(f) = \sum_{i=0}^{n-1} -\dfrac{f''(\xi_i)(x_{i+1}-x_i)^3}{12} = -\dfrac{h^3}{12}\sum_{i=0}^{n-1} f''(\xi_i)
            = -\dfrac{h^3n}{12}\cdot f''(\xi)
        \end{equation*}
        con $\xi\in [a,b]$, donde $n$ es el número de subintervalos en los que se ha dividido el intervalo $[a,b]$. Por tanto:
        \begin{equation*}
            R(f) = -\dfrac{(b-a)h^2}{12}\cdot f''(\xi)
        \end{equation*}
        \item Llama $h = b - a$. De forma similar a la vista en clase para la integración adaptativa con la fórmula de Simpson, obtén un criterio de estimación del error
        \begin{equation*}
            \int_{a}^{b} f(x) dx - T(a, m) - T(m, b)
        \end{equation*}
        basado en $T(a, b)$, $T(a, m)$ y $T(m, b)$, siendo $m = \frac{a+b}{2}$.


        Tenemos que:
        \begin{align*}
            \left|\int_{a}^{b} f(x) dx - T(a, m) - T(m, b)\right| &= \left|T(a, b) + R(f) - T(a, m) - T(m, b)\right|
        \end{align*}

        Por otro lado, se tiene que:
        \begin{align*}
            T(a,b) + R(f) &= T(a,m) + T(m,b) -\dfrac{f''\left(\wt{\xi}\right)(b-a)^3}{12}\cdot \frac{1}{4}
        \end{align*}

        Por tanto, tenemos que:
        \begin{align*}
            \left|\int_{a}^{b} f(x) dx - T(a, m) - T(m, b)\right| &= \left|-\dfrac{f''\left(\wt{\xi}\right)(b-a)^3}{12}\cdot \frac{1}{4}\right|
        \end{align*}

        Supongamos ahora por hipótesis que $f''(\xi)\approx f''\left(\wt{\xi}\right)$, y por tanto:
        \begin{align*}
            T(a,b) -\dfrac{f''\left(\wt{\xi}\right)(b-a)^3}{12} &\approx T(a,m) + T(m,b) -\dfrac{f''\left(\wt{\xi}\right)(b-a)^3}{12}\cdot \frac{1}{4}
        \end{align*}

        Despejando:
        \begin{align*}
            \dfrac{3}{4}f''\left(\wt{\xi}\right)(b-a)^3 &\approx T(a,b) - T(a,m) - T(m,b)
            \Longrightarrow \\ &\Longrightarrow
            \dfrac{f''\left(\wt{\xi}\right)(b-a)^3}{12} \approx \dfrac{4}{3}\left(T(a,b) - T(a,m) - T(m,b)\right)
        \end{align*}

        Por tanto, la aproximación del error cometido es:
        \begin{equation*}
            \dfrac{1}{3}\left|T(a,b) - T(a,m) - T(m,b)\right|
        \end{equation*}

        \item Estima el error cometido en la aproximación en dos subintervalos
        \begin{equation*}
            \int_{4}^{8} \left(1 + \frac{e^{-x}}{x}\right)dx \approx T(4, 6) + T(6, 8) = 4.0054471
        \end{equation*}
        sabiendo que $f(4) = 1.0045789$, $f(6) = 1.0004131$ y $f(8) = 1.0000419$.

        Calculamos $T(a,b)=T(4,8)$:
        \begin{align*}
            T(4,8) &= \dfrac{8-4}{2}\left(f(4) + f(8)\right) = 4.0092416
        \end{align*}

        Por tanto, tenemos que:
        \begin{equation*}
            \dfrac{1}{3}\left|T(4,8) - T(4,6) - T(6,8)\right| = \dfrac{1}{3}\left|4.0092416 - 4.0054471\right| \approx 1.2648333\cdot 10^{-3}
        \end{equation*}
    \end{enumerate}
\end{ejercicio}

\begin{ejercicio}~\label{ej:2.3.4}
    Se pretende aproximar una integral del tipo
    \begin{equation*}
        \int_{-1}^{1} f(x)(1 - x^2)dx
    \end{equation*}
    utilizando tres nodos, es decir:
    \begin{equation*}
        \int_{-1}^{1} f(x)(1 - x^2)dx \approx \alpha_0 f(x_0) + \alpha_1 f(x_1) + \alpha_2 f(x_2)
    \end{equation*}
    \begin{enumerate}
        \item\label{ap:1} Si fijamos los nodos $x_0 = -1$, $x_1 = 0$ y $x_2 = 1$, determina el valor de los parámetros para que sea una fórmula de tipo interpolatorio, así como el orden de exactitud de dicha fórmula.
        
        Suponemos que pide una fórmula de tipo interpolatorio clásico. Obtenemos los coeficientes $\alpha_0$, $\alpha_1$ y $\alpha_2$ imponiendo exactitud. En primer lugar, tenemos que:
        \begin{align*}
            \int_{-1}^{1} (1 - x^2)dx &= 2\left[1 - \dfrac{1}{3}\right] = \dfrac{4}{3}\\
            \int_{-1}^{1} x(1 - x^2)dx &= 0\\
            \int_{-1}^{1} x^2(1 - x^2)dx &= 2\left[\dfrac{1}{3} - \dfrac{1}{5}\right] = \dfrac{4}{15}
        \end{align*}

        Por tanto, tras imponer exactitud, obtenemos el siguiente sistema de ecuaciones:
        \begin{equation*}
            \begin{cases}
                \alpha_0 + \alpha_1 + \alpha_2 = \dfrac{4}{3}\\
                -\alpha_0 + \alpha_2 = 0\\
                \alpha_0 + \alpha_2 = \dfrac{4}{15}
            \end{cases}
        \end{equation*}

        Resolviendo el sistema, obtenemos:
        \begin{equation*}
            \alpha_0 = \alpha_2 = \dfrac{2}{15}\qquad \alpha_1 = \dfrac{16}{15}
        \end{equation*}

        Por tanto, la fórmula de tipo interpolatorio es:
        \begin{equation*}
            \int_{-1}^{1} f(x)(1 - x^2)dx \approx \dfrac{2}{15}\left(f(-1) + 8f(0) + f(1)\right)
        \end{equation*}

        Para determinar el orden de exactitud, tenemos que ver si la fórmula es exacta en $\{x^3,x^4\}$:
        \begin{align*}
            \int_{-1}^{1} x^3(1 - x^2)dx &= 0 \neq \dfrac{2}{15}\left(-1+1\right) = 0\\
            \int_{-1}^{1} x^4(1 - x^2)dx &= 2\left[\dfrac{1}{5} - \dfrac{1}{7}\right] = \dfrac{4}{35} \neq \dfrac{2}{15}\left(1+0+1\right) = \dfrac{4}{15}
        \end{align*}

        Por tanto, la fórmula es exacta en $\{1,x,x^2,x^3\}$, pero no en $\{x^4\}$. Por tanto, el orden de exactitud es $3$.
        \item ¿Cuáles serían los nodos si utilizamos una fórmula de Newton-Cotes abierta?
        
        Como buscamos $3$ nodos, estos deben estar equiespaciados en $]-1,1[$. Por tanto, los nodos serían:
        \begin{equation*}
            x_0 = -\frac{1}{2}, \quad x_1 = 0, \quad x_2 = \frac{1}{2}
        \end{equation*}
        \item\label{ap:3} Determina la fórmula gaussiana correspondiente así como la expresión del error.
        
        Como buscamos que sea gaussiana, ha de tener grado de exactitud $2\cdot 2+1 = 5$. Por tanto, imponemos exactitud en $\{\Pi(x), x\Pi(x), x^2\Pi(x)\}$, donde:
        \begin{equation*}
            \Pi(x) = (x-x_0)(x-x_1)(x-x_2) = x^3+ax^2 + bx + c
        \end{equation*}

        Calculamos los coeficientes $a$, $b$ y $c$, para lo cual antes calcularemos las siguientes integrales:
        \begin{align*}
            \int_{-1}^{1} \Pi(x)dx &= \int_{-1}^{1} (x^3 + ax^2 + bx + c)dx = 2\left[\dfrac{a}{3} + c\right]\\
            \int_{-1}^{1} x\Pi(x)dx &= \int_{-1}^{1} x(x^3 + ax^2 + bx + c)dx = 2\left[\dfrac{1}{5} + \dfrac{b}{3}\right]\\
            \int_{-1}^{1} x^2\Pi(x)dx &= \int_{-1}^{1} x^2(x^3 + ax^2 + bx + c)dx = 2\left[\dfrac{a}{5} + \dfrac{c}{3}\right]\\
            \int_{-1}^{1} x^3\Pi(x)dx &= \int_{-1}^{1} x^3(x^3 + ax^2 + bx + c)dx = 2\left[\dfrac{1}{7} + \dfrac{b}{5}\right]\\
            \int_{-1}^{1} x^4\Pi(x)dx &= \int_{-1}^{1} x^4(x^3 + ax^2 + bx + c)dx = 2\left[\dfrac{a}{7} + \dfrac{c}{5}\right]\\
        \end{align*}

        Imponiendo exactitud, obtenemos el siguiente sistema de ecuaciones:
        \begin{align*}
            0 &= \int_{-1}^{1} (1-x^2)\Pi(x)dx = 2\left[\dfrac{a}{3} + c\right] - 2\left[\dfrac{a}{5} + \dfrac{c}{3}\right]
            = 2\left[\dfrac{2}{15}a + \dfrac{2}{3}c\right] = \dfrac{4}{3}\left[\dfrac{1}{5}a + c\right]\\
            0 &= \int_{-1}^{1} x(1-x^2)\Pi(x)dx = 2\left[\dfrac{1}{5} + \dfrac{b}{3}\right] - 2\left[\dfrac{1}{7} + \dfrac{b}{5}\right]
            = 2\left[\dfrac{2}{35} + \dfrac{2}{15}b\right]
            = \dfrac{4}{5}\left[\dfrac{1}{7} + \dfrac{1}{3}b\right]\\
            0 &= \int_{-1}^{1} x^2(1-x^2)\Pi(x)dx = 2\left[\dfrac{a}{5} + \dfrac{c}{3}\right] - 2\left[\dfrac{a}{7} + \dfrac{c}{5}\right]
            = 2\left[\dfrac{2}{35}a + \dfrac{2}{15}c\right]
            = \dfrac{4}{5}\left[\dfrac{1}{7}a + \dfrac{1}{3}c\right]
        \end{align*}

        Resolviendo el sistema, obtenemos:
        \begin{equation*}
            b=\nicefrac{-3}{7}, \quad a=c=0.
        \end{equation*}

        Por tanto, tenemos:
        \begin{equation*}
            \Pi(x) = x^3 - \frac{3}{7}x = x\left(x^2 - \frac{3}{7}\right)
        \end{equation*}

        Por tanto, los nodos son:
        \begin{equation*}
            x_0 = -\sqrt{\frac{3}{7}}, \quad x_1 = 0, \quad x_2 = \sqrt{\frac{3}{7}}
        \end{equation*}

        Y la fórmula gaussiana es:
        \begin{equation*}
            \int_{-1}^{1} f(x)(1 - x^2)dx \approx \alpha_0 f\left(-\sqrt{\frac{3}{7}}\right) + \alpha_1 f(0) + \alpha_2 f\left(\sqrt{\frac{3}{7}}\right)
        \end{equation*}

        Para obtener los coeficientes $\alpha_0$, $\alpha_1$ y $\alpha_2$, imponemos exactitud en $\{1, x, x^2\}$:
        \begin{align*}
            \int_{-1}^{1} (1 - x^2)dx &= 2\left[1 - \dfrac{1}{3}\right] = \dfrac{4}{3} = \alpha_0 + \alpha_1 + \alpha_2\\
            \int_{-1}^{1} x(1 - x^2)dx &= 0 = \sqrt{\dfrac{3}{7}}\left(\alpha_2 - \alpha_0\right)\\
            \int_{-1}^{1} x^2(1 - x^2)dx &= 2\left[\dfrac{1}{3} - \dfrac{1}{5}\right] = \dfrac{4}{15} = {\dfrac{3}{7}}\left(\alpha_0 + \alpha_2\right)
        \end{align*}

        Resolviendo el sistema, obtenemos:
        \begin{equation*}
            \alpha_0 = \alpha_2 = \dfrac{14}{45}, \quad \alpha_1 = \dfrac{32}{45}
        \end{equation*}

        Por tanto, la fórmula gaussiana es:
        \begin{equation*}
            \int_{-1}^{1} f(x)(1 - x^2)dx \approx \dfrac{2}{45}\left[7f\left(-\sqrt{\frac{3}{7}}\right) + 16f(0) + 7\left(\sqrt{\frac{3}{7}}\right)\right]
        \end{equation*}

        Respecto al error, tenemos que:
        \begin{equation*}
            R(f) = \dfrac{f^{(4)}(\xi)}{4!}\cdot \int_{-1}^{1} (1 - x^2)x^2\left(x^2 - \frac{3}{7}\right)^2dx
        \end{equation*}

        Calculamos la integral:
        \begin{align*}
            \int_{-1}^{1} (1 - x^2)x^2\left(x^2 - \frac{3}{7}\right)^2dx &=
            2\int_{0}^{1} (1 - x^2)x^2\left(x^2 - \frac{3}{7}\right)^2dx
            = \dfrac{32}{2205}
        \end{align*}

        Por tanto, el error es:
        \begin{equation*}
            R(f) = \dfrac{16f^{(4)}(\xi)}{735}\qquad \text{con } \xi\in [-1,1].
        \end{equation*}


        \item Utiliza las fórmulas de los apartados \ref{ap:1} y \ref{ap:3} para aproximar
        \begin{equation*}
            \int_{-1}^{1} \cos(x^2)(1 - x^2)dx
        \end{equation*}

        Para el apartado \ref{ap:1}, tenemos que:
        \begin{align*}
            \int_{-1}^{1} \cos(x^2)(1 - x^2)dx &\approx \dfrac{2}{15}\left[\cos(1) + 8\cos(0) + \cos(1)\right] = \dfrac{2}{15}\left[\cos(-1) + 8\cos(0) + \cos(1)\right]\\
            &= \dfrac{2}{15}\left[2\cos(1) + 8\right] \approx 1.210747
        \end{align*}

        Para el apartado \ref{ap:3}, tenemos que:
        \begin{align*}
            \int_{-1}^{1} \cos(x^2)(1 - x^2)dx &\approx \dfrac{2}{45}\left[7\cos\left(-\sqrt{\frac{3}{7}}\right) + 16\cos(0) + 7\cos\left(\sqrt{\frac{3}{7}}\right)\right]\\
            &= \dfrac{2}{45}\left[14\cos\left(\sqrt{\frac{3}{7}}\right) + 16\right] \approx 1.204694
        \end{align*}
    \end{enumerate}
\end{ejercicio}

\begin{ejercicio}~\label{ej:2.3.5}
    Se considera la fórmula de integración numérica
    \begin{equation*}
        \int_{-1}^{2} f(x)x dx \approx a_0 f(0) + a_1 f(2) + a_2 f'(0) + a_3f'(2).
    \end{equation*}
    \begin{enumerate}
        \item Determina los coeficientes $a_0$, $a_1$, $a_2$ y $a_3$ para que la fórmula anterior sea de tipo interpolatorio.
        
        Imponemos exactitud en $\{1, x, x^2, x^3\}$:
        \begin{align*}
            \int_{-1}^{2} x dx &= \left[\dfrac{x^2}{2}\right]_{-1}^{2} = \dfrac{4-1}{2} = \dfrac{3}{2} = a_0 + a_1\\
            \int_{-1}^{2} x^2 dx &= \left[\dfrac{x^3}{3}\right]_{-1}^{2} = \dfrac{8+1}{3} = 3 = 2a_1 + a_2 + a_3\\
            \int_{-1}^{2} x^3 dx &= \left[\dfrac{x^4}{4}\right]_{-1}^{2} = \dfrac{16-1}{4} = \dfrac{15}{4} = 4a_1 + 4a_3\\
            \int_{-1}^{2} x^4 dx &= \left[\dfrac{x^5}{5}\right]_{-1}^{2} = \dfrac{32+1}{5} = \dfrac{33}{5} = 8a_1 + 3\cdot 2^2\cdot a_3
        \end{align*}

        Por tanto, tenemos el siguiente sistema de ecuaciones:
        \begin{equation*}
            \begin{cases}
                a_0 + a_1 = \nicefrac{3}{2}\\
                2a_1 + a_2 + a_3 = 3\\
                4a_1 + 4a_3 = \nicefrac{15}{4}\\
                8a_1 + 12a_3 = \nicefrac{33}{5}
            \end{cases}
        \end{equation*}

        Por tanto, resolviendo el sistema, obtenemos:
        \begin{equation*}
            a_0 = \dfrac{27}{80},\qquad
            a_1 = \dfrac{93}{80},\qquad
            a_2 = \dfrac{9}{10},\qquad
            a_3 = -\dfrac{9}{40}.
        \end{equation*}

        Por tanto, la fórmula de integración numérica es:
        \begin{equation*}
            \int_{-1}^{2} f(x)x dx \approx \dfrac{3}{10}\left[\dfrac{9}{8}f(0) + \dfrac{31}{8}f(2) + 3f'(0) - \dfrac{3}{4}f'(2)\right].
        \end{equation*}
        \item Indica el grado de exactitud de la fórmula anterior. ¿Es el grado de exactitud superior al esperado?
        
        Veamos si es exacta en $x^4$:
        \begin{align*}
            \int_{-1}^{2} x^4 x dx &= \left[\dfrac{x^6}{6}\right]_{-1}^{2} = \dfrac{64-1}{6} = \dfrac{63}{6} = \dfrac{21}{2}\neq \dfrac{3}{10}\left[\dfrac{9}{8}\cdot 0 + \dfrac{31}{8}\cdot 2^4 + 3\cdot 0 - \dfrac{3}{4}\cdot 4\cdot 2^3\right] =\\&= \dfrac{3}{10}\left[2\cdot 31 - 3\cdot 8\right] = \dfrac{57}{5}
        \end{align*}

        Por tanto, la fórmula no es exacta en $x^4$, pero sí lo es en $\{1, x, x^2, x^3\}$. Por tanto, el grado de exactitud es $3$, que es el esperado.
        \item Si se pretende utilizar una fórmula gaussiana con 2 nodos para aproximar la integral, determina cuáles serían dichos nodos y la expresión del error cometido en la aproximación.
        
        Para que sea gaussiana, ha de tener grado de exactitud $2\cdot 1 + 1 = 3$. Para ello, definimos el polinomio:
        \begin{equation*}
            \Pi(x) = (x-x_0)(x-x_1) = x^2 + ax + b
        \end{equation*}

        Imponemos exactitud en $\{\Pi(x), x\Pi(x)\}$ para obtener los nodos:
        \begin{align*}
            0 = \int_{-1}^{2} x\Pi(x)dx &= \int_{-1}^{2} x(x^2 + ax + b)dx = \left[\dfrac{x^4}{4} + \dfrac{a}{3}x^3 + \dfrac{b}{2}x^2\right]_{-1}^{2} =\\&= \dfrac{16-1}{4} + \dfrac{a}{3}\cdot (8+1) + \dfrac{b}{2}\cdot (4-1)
            = \dfrac{15}{4} + 3a + \dfrac{3b}{2}\\
            0 = \int_{-1}^{2} x^2\Pi(x)dx &= \int_{-1}^{2} x^2(x^2 + ax + b)dx = \left[\dfrac{x^5}{5} + \dfrac{a}{4}x^4 + \dfrac{b}{3}x^3\right]_{-1}^{2} =\\&= \dfrac{32+1}{5} + \dfrac{a}{4}\cdot (16-1) + \dfrac{b}{3}\cdot (8+1)
            = \dfrac{33}{5} + \frac{15a}{4} + 3b
        \end{align*}

        Por tanto, tenemos el siguiente sistema de ecuaciones:
        \begin{equation*}
            \begin{cases}
                \nicefrac{15}{4} + 3a + \nicefrac{3b}{2} = 0\\
                \nicefrac{33}{5} + \nicefrac{15a}{4} + 3b = 0
            \end{cases}
        \end{equation*}

        Resolviendo el sistema, obtenemos:
        \begin{equation*}
            a = -\frac{2}{5}, \quad b = -\frac{17}{10}
        \end{equation*}

        Por tanto, tenemos que:
        \begin{equation*}
            \Pi(x) = x^2 - \frac{2}{5}x - \frac{17}{10}
        \end{equation*}

        Los nodos son las raíces de $\Pi(x)$, que son:
        \begin{equation*}
            x_0 = \dfrac{2-\sqrt{174}}{10}, \quad x_1 = \dfrac{2+\sqrt{174}}{10}
        \end{equation*}

        La fórmula gaussiana por tanto es:
        \begin{equation*}
            \int_{-1}^{2} f(x)x dx \approx \alpha_0 f\left(\dfrac{2-\sqrt{174}}{10}\right) + \alpha_1 f\left(\dfrac{2+\sqrt{174}}{10}\right)
        \end{equation*}

        Para obtener los coeficientes $\alpha_0$ y $\alpha_1$, imponemos exactitud en $\{1, x\}$:
        \begin{align*}
            \int_{-1}^{2} x dx &= \left[\dfrac{x^2}{2}\right]_{-1}^{2} = \dfrac{4-1}{2} = \dfrac{3}{2} = \alpha_0 + \alpha_1\\
            \int_{-1}^{2} x^2 dx &= \left[\dfrac{x^3}{3}\right]_{-1}^{2} = \dfrac{8+1}{3} = 3 = \alpha_0\cdot \dfrac{2-\sqrt{174}}{10} + \alpha_1\cdot \dfrac{2+\sqrt{174}}{10}
        \end{align*}

        Resolviendo el sistema, obtenemos:
        \begin{equation*}
            \alpha_0 = \dfrac{3}{4}-\dfrac{9\sqrt{174}}{116}, \quad
            \alpha_1 = \dfrac{3}{4}+\dfrac{9\sqrt{174}}{116}.
        \end{equation*}

        Por tanto, la fórmula gaussiana es:
        \begin{equation*}
            \int_{-1}^{2} f(x)x dx \approx \left(\dfrac{3}{4}-\dfrac{9\sqrt{174}}{116}\right)f\left(\dfrac{2-\sqrt{174}}{10}\right) + \left(\dfrac{3}{4}+\dfrac{9\sqrt{174}}{116}\right)f\left(\dfrac{2+\sqrt{174}}{10}\right)
        \end{equation*}

        Respecto al error cometido, tenemos que $\exists \xi\in [-1,2]$ tal que:
        \begin{equation*}
            R(f) = \dfrac{1}{4!}f^{(4)}(\xi)\cdot \int_{-1}^{2} x\Pi^2(x)dx
        \end{equation*}

        Calculemos la integral:
        \begin{align*}
            \int_{-1}^{2} x\Pi^2(x)dx &= \int_{-1}^{2} x\left(x^2 - \frac{2}{5}x - \frac{17}{10}\right)^2dx
            =\\&= \int_{-1}^{2} x^5 - \dfrac{4}{5}x^4 - \dfrac{81}{25}x^3 + \dfrac{34}{25}x^2 + \dfrac{289}{100}x dx
            = \dfrac{297}{200}
        \end{align*}

        Por tanto, el error cometido es:
        \begin{equation*}
            R(f) = \dfrac{99}{1600}f^{(4)}(\xi).
        \end{equation*}
    \end{enumerate}
\end{ejercicio}

\begin{ejercicio}~\label{ej:2.3.6}
    Se pretende aproximar la integral
    \begin{equation*}
        \int_{a}^{b} f(x)dx = S_n(f) + R(f)
    \end{equation*}
    donde $S_n(f)$ es una fórmula de integración compuesta obtenida al hacer una partición uniforme del intervalo $[a, b]$ de la forma:
    \begin{equation*}
        a = x_0 < x_1 < \ldots < x_n = b, \quad x_i = x_{i-1} + h, \quad h = \frac{b - a}{n}
    \end{equation*}
    y $R(f)$ es el error de integración numérica que tiene el siguiente desarrollo:
    \begin{equation*}
        R(f) = a_1h^3 + a_2h^6 + \cdots + a_mh^{3m} + \cdots
    \end{equation*}
    Siguiendo el mismo argumento de la integración de Romberg, combina $S_n(f)$ con $S_{3n}(f)$ para obtener una aproximación más precisa para la integral. Aplica recursivamente el método.\\

    Triplicando el número de subintervalos, obtenemos:
    \begin{equation*}
        \int_{a}^{b} f(x)dx = S_{3n}(f) + a_1\cdot \left(\dfrac{h}{3}\right)^3 + a_2\cdot \left(\dfrac{h}{3}\right)^6 + \cdots + a_m\cdot \left(\dfrac{h}{3}\right)^{3m} + \cdots
    \end{equation*}
    Combinando las dos aproximaciones, obtenemos:
    \begin{align*}
        \int_{a}^{b} f(x)dx &= \dfrac{3^3S_{3n}(f)-S_n(f)}{3^3-1} + \dfrac{1-3^3}{3^3}\cdot a_2h^6 + \cdots
    \end{align*}

    Definimos por tanto como sigue la recursión para cada $j\in \bb{N}_0$, $k\in \{0,1,\dots, j\}$:
    \begin{align*}
        R(j,0) &= S_{3^j n}(f)\\
        R(j,k) &= \dfrac{3^{3k}R(j, k-1) - R(j-1,k-1)}{3^{3k} - 1}
    \end{align*}


\end{ejercicio}

\begin{ejercicio}~\label{ej:2.3.7}
    A veces, para construir fórmulas de integración numérica es posible utilizar nodos que se encuentran fuera del intervalo de integración. Considera la fórmula:
    \begin{equation*}
        \int_{a}^{a+h} f(x)dx = \frac{5h}{12}f(a + h) + \frac{2h}{3}f(a) - \frac{h}{12}f(a - h) + R(f)
    \end{equation*}
    \begin{enumerate}
        \item Demuestra que es de tipo interpolatorio y determina el grado de exactitud.
        
        Imponemos exactitud en $\{1, x, x^2,\dots\}$:
        \begin{align*}
            \int_{a}^{a+h} 1dx &= h = \frac{5h}{12} + \frac{2h}{3} - \frac{h}{12}
            = h
            \\
            \int_{a}^{a+h} xdx &= \left[\dfrac{x^2}{2}\right]_{a}^{a+h} = \dfrac{(a+h)^2 - a^2}{2} = \dfrac{2ah + h^2}{2} = \dfrac{5h}{12} (a + h) + \frac{2h}{3}a - \frac{h}{12}(a - h)\\
            \int_{a}^{a+h} x^2dx &= \left[\dfrac{x^3}{3}\right]_{a}^{a+h} = \dfrac{(a+h)^3 - a^3}{3} = \dfrac{3a^2h + 3ah^2 + h^3}{3} = a^2h + ah^2 + \dfrac{h^3}{3}
            =\\&=
            \frac{5h}{12} \left(a^2 + 2ah + h^2\right) + \frac{2h}{3}a^2 - \frac{h}{12}(a^2 - 2ah + h^2)\\
            \int_{a}^{a+h} x^3dx &= \left[\dfrac{x^4}{4}\right]_{a}^{a+h} = \dfrac{(a+h)^4 - a^4}{4} = \dfrac{4a^3h + 6a^2h^2 + 4ah^3 + h^4}{4}
            \neq\\&\neq \dfrac{5h}{12} (a+h)^3 + \frac{2h}{3}a^3 - \frac{h}{12}(a-h)^3
            =\\&= \frac{5h}{12} \left(a^3 + 3a^2h + 3ah^2 + h^3\right) + \frac{2h}{3}a^3 - \frac{h}{12}\left(a^3 - 3a^2h + 3ah^2 - h^3\right)
        \end{align*}
        donde la última desigualdad se cumple porque los coeficientes de $h^4$ no coinciden. Por tanto, el grado de exactitud es $2$.
        \item Proporciona una expresión para el error de integración numérica asociado a la fórmula.
        
        El error de interpolación es:
        \begin{align*}
            E(x) &= f[a, a + h, a - h,x]\cdot \Pi(x)\\
            \Pi(x) &= (x - (a + h))(x - a)(x - (a - h))
            = [(x - a)^2 - h^2](x-a) = (x - a)^3 - h^2(x - a)
        \end{align*}

        Como $\Pi(x)$ no cambia de signo en el intervalo $[a, a + h]$, por el Teorema del Valor Medio de la Integral Generalizado, existe $\xi\in [a, a + h]$ tal que:
        \begin{equation*}
            R(f) = \int_{a}^{a+h} E(x)dx = f[a, a + h, a - h, \xi]\cdot \int_{a}^{a+h} \Pi(x)dx
        \end{equation*}

        Calculamos la integral:
        \begin{align*}
            \int_{a}^{a+h} \Pi(x)dx &= \int_{a}^{a+h} \left[(x - a)^3 - h^2(x - a)\right]dx
            = \left[\dfrac{(x - a)^4}{4} - \dfrac{h^2(x - a)^2}{2}\right]_{a}^{a+h}\\
            &= \left[\dfrac{h^4}{4} - \dfrac{h^2\cdot h^2}{2}\right] = -\dfrac{h^4}{4}
        \end{align*}

        Por tanto, el error de integración numérica es:
        \begin{equation*}
            R(f) = -\dfrac{h^4}{4}f[a, a + h, a - h, \xi].
        \end{equation*}

        Por las propiedades de las diferencias divididas, tenemos que $\exists \eta\in [a-h, a + h]$ tal que:
        \begin{equation*}
            R(f) = -\dfrac{h^4}{24}f^{(3)}(\eta).
        \end{equation*}

        \item Deduce la fórmula compuesta asociada a dicha fórmula.
        
        Sea $n$ el número de subintervalos en los que se divide el intervalo $[a, a + h]$. Entonces, tenemos que:
        \begin{align*}
            \int_{a}^{a + h} f(x)dx &= \sum_{i=0}^{n-1}\int_{x_i}^{x_{i+1}} f(x)dx
            \approx \sum_{i=0}^{n-1}\left[\frac{5\wt{h}}{12}f(x_{i+1}) + \frac{2\wt{h}}{3}f(x_i) - \frac{\wt{h}}{12}f(x_{i-1})\right]
        \end{align*}
    \end{enumerate}
\end{ejercicio}

\begin{ejercicio}[DGIIM 2023/24]~\label{ej:2.3.8}
    Se considera la fórmula de integración numérica
    \begin{equation*}
        \int_{-1}^{1} f(x)(1 - x^2)dx = \alpha_0 f(x_0) + \alpha_1 f(x_1) + R(f).
    \end{equation*}
    \begin{enumerate}
        \item Determina los nodos y los coeficientes para que la fórmula anterior tenga grado de exactitud máximo. ¿Cuál es ese grado de exactitud?
        
        Para obtener la fórmula Gaussiana, el grado de exactitud máximo es $2\cdot 1 + 1 = 3$. Para ello, definimos el polinomio:
        \begin{equation*}
            \Pi(x) = (x - x_0)(x - x_1) = x^2 + ax + b
        \end{equation*}

        Imponemos exactitud en $\{\Pi(x), x\Pi(x)\}$ para obtener los nodos, pero previamente:
        \begin{align*}
            \int_{-1}^{1} \Pi(x)dx &= \int_{-1}^{1} (x^2 + ax + b)dx = 2\left[\dfrac{1}{3} + 0 + b\right] = \dfrac{2}{3} + 2b\\
            \int_{-1}^{1} x\Pi(x)dx &= \int_{-1}^{1} x(x^2 + ax + b)dx = 2\left[0 \dfrac{a}{3} + 0\right] = \dfrac{2a}{3}\\
            \int_{-1}^{1} x^2\Pi(x)dx &= \int_{-1}^{1} x^2(x^2 + ax + b)dx = 2\left[\dfrac{1}{5} + 0 + \dfrac{b}{3}\right] = \dfrac{2}{5} + \dfrac{2b}{3}\\
            \int_{-1}^{1} x^3\Pi(x)dx &= \int_{-1}^{1} x^3(x^2 + ax + b)dx = 2\left[0 + \frac{a}{5} + 0\right] = \dfrac{2a}{5}
        \end{align*}

        Por tanto, imponiendo exactitud en $\{\Pi(x), x\Pi(x)\}$, tenemos el siguiente sistema de ecuaciones:
        \begin{align*}
            0 = \int_{-1}^{1} \Pi(x)(1 - x^2)dx &= \dfrac{2}{3} + 2b - \dfrac{2}{5} - \dfrac{2b}{3} = \dfrac{4}{15} + \dfrac{4b}{3} \Longrightarrow
            b = -\dfrac{1}{5}\\
            0 = \int_{-1}^{1} x\Pi(x)(1 - x^2)dx &= \dfrac{2a}{3} - \dfrac{2a}{5}
            = \dfrac{4a}{15}
            \Longrightarrow a = 0
        \end{align*}

        Por tanto, tenemos que:
        \begin{equation*}
            \Pi(x) = x^2 - \frac{1}{5}
        \end{equation*}

        Los nodos son las raíces de $\Pi(x)$, que son:
        \begin{equation*}
            x_0 = -\dfrac{\sqrt{5}}{5}, \quad x_1 = \dfrac{\sqrt{5}}{5}
        \end{equation*}

        La fórmula gaussiana por tanto es:
        \begin{equation*}
            \int_{-1}^{1} f(x)(1 - x^2)dx \approx \alpha_0 f\left(-\dfrac{\sqrt{5}}{5}\right) + \alpha_1 f\left(\dfrac{\sqrt{5}}{5}\right)
        \end{equation*}

        Para obtener los coeficientes $\alpha_0$ y $\alpha_1$, imponemos exactitud en $\{1, x\}$:
        \begin{align*}
            \int_{-1}^{1} (1 - x^2)dx &= 2\left[1 - \dfrac{1}{3}\right] = \dfrac{4}{3} = \alpha_0 + \alpha_1\\
            \int_{-1}^{1} x(1 - x^2)dx &= 0 = \dfrac{\sqrt{5}}{5}\left(\alpha_1 - \alpha_0\right)
        \end{align*}

        Resolviendo el sistema, obtenemos:
        \begin{equation*}
            \alpha_0 = \alpha_1 = \dfrac{2}{3}
        \end{equation*}

        Por tanto, la fórmula gaussiana es:
        \begin{equation*}
            \int_{-1}^{1} f(x)(1 - x^2)dx \approx \dfrac{2}{3}\left[f\left(-\dfrac{\sqrt{5}}{5}\right) + f\left(\dfrac{\sqrt{5}}{5}\right)\right]
        \end{equation*}
        El grado de exactitud es $3$, que es el máximo posible.
        \item Obtén la expresión del error de dicha fórmula.
        
        El error cometido es:
        \begin{align*}
            R(f) &= \dfrac{f^{(4)}(\xi)}{4!}\cdot \int_{-1}^{1} (1 - x^2)\Pi^2(x)dx
        \end{align*}

        Calculamos la integral:
        \begin{align*}
            \int_{-1}^{1} (1 - x^2)\Pi^2(x)dx &= \int_{-1}^{1} (1 - x^2)\left(x^2 - \frac{1}{5}\right)^2dx
            = 2\int_{0}^{1} (1 - x^2)\left(x^4 - \frac{2}{5}x^2 + \frac{1}{25}\right)dx\\
            &= 2\int_{0}^{1} -x^6 + \frac{7}{5}x^4 - \dfrac{11}{25}x^2 + \frac{1}{25}dx
            =\\&= 2\left[-\dfrac{1}{7} + \dfrac{7}{5}\cdot \dfrac{1}{5} - \dfrac{11}{25}\cdot \dfrac{1}{3} + \dfrac{1}{25}\right]
            = \dfrac{32}{525}
        \end{align*}

        Por tanto, el error de integración numérica es:
        \begin{equation*}
            R(f) = \dfrac{f^{(4)}(\xi)}{4!}\cdot \dfrac{32}{525} = \dfrac{16f^{(4)}(\xi)}{175}.
        \end{equation*}
        donde $\xi\in [-1, 1]$.
        \item Utiliza la fórmula anterior para estimar el valor de
        \begin{equation*}
            \int_{-1}^{1} \ln(x^2 + 1)(1 - x^2)dx .
        \end{equation*}

        Utilizando la fórmula gaussiana obtenida, tenemos que:
        \begin{align*}
            \int_{-1}^{1} \ln(x^2 + 1)(1 - x^2)dx &\approx \dfrac{2}{3}\left[\ln\left(\left(-\dfrac{\sqrt{5}}{5}\right)^2 + 1\right) + \ln\left(\left(\dfrac{\sqrt{5}}{5}\right)^2 + 1\right)\right]\\
            &= \dfrac{4}{3}\left[2\ln\left(\dfrac{5}{25} + 1\right)\right] = \dfrac{4}{3}\cdot \ln\left(\dfrac{6}{5}\right) \approx 0.24309
        \end{align*}
    \end{enumerate}
\end{ejercicio}

\begin{ejercicio}[DGIIM 2023/24]~\label{ej:2.3.9}
    Considera la fórmula de cuadratura de tipo interpolatorio:
    \begin{equation*}
        \int_{a}^{a+h} f(x)dx = \frac{3h}{4}f(a) + \frac{h}{4}f(a + 2h) + R(f).
    \end{equation*}
    \begin{enumerate}
        \item Proporciona una expresión para el error de integración numérica asociado a la fórmula.
        
        El error de interpolación es:
        \begin{align*}
            E(x) &= f[a, a + 2h, x]\cdot \Pi(x)\\
            \Pi(x) &= (x - a)(x - (a + 2h))
        \end{align*}

        Como $\Pi(x)$ no cambia de signo en el intervalo $[a, a + h]$, por el Teorema del Valor Medio de la Integral Generalizado, existe $\xi\in [a, a + h]$ tal que:
        \begin{equation*}
            R(f) = \int_{a}^{a+h} E(x)dx = f[a, a + 2h, \xi]\cdot \int_{a}^{a+h} \Pi(x)dx
        \end{equation*}

        Calculamos la integral:
        \begin{align*}
            \int_{a}^{a+h} \Pi(x)dx &= \int_{a}^{a+h} (x - a)(x - (a + 2h))dx
            = \int_{a}^{a+h} (x^2 -2(a + h)x + a(a + 2h))dx =\\
            &= \left[\dfrac{x^3}{3} - (a + h)x^2 + a(a + 2h)x\right]_{a}^{a+h}
            =\\&= \left[\dfrac{(a + h)^3 - a^3}{3} - (a + h)\left((a + h)^2 - a^2\right) + a(a + 2h)(a + h - a)\right]
            =\\&= \left[\dfrac{3a^2h + 3h^2a + h^3}{3} - (a + h)\left(2ah + h^2\right) + ah(a + 2h)\right]
            =\\&= \cancel{a^2h} + \bcancel{ah^2} + \dfrac{h^3}{3} - \cancel{2a^2h} - \bcancel{ah^2} -\bcancel{2ah^2} - h^3 + \cancel{a^2h}+ \bcancel{2ah^2}
            = -\dfrac{2h^3}{3}
        \end{align*}

        Por tanto, el error de integración numérica es:
        \begin{equation*}
            R(f) = -\dfrac{2h^3}{3}f[a, a + 2h, \xi].
        \end{equation*}

        Por las propiedades de las diferencias divididas, tenemos que $\exists \eta\in [a, a + 2h]$ tal que:
        \begin{equation*}
            R(f) = -\dfrac{h^3}{3}f^{(2)}(\eta).
        \end{equation*}
        \item Deduce la fórmula compuesta asociada a dicha fórmula incluyendo una expresión del error.
        
        Sea $n$ el número de subintervalos en los que se divide el intervalo $[a, a + h]$. Entonces, tenemos que:
        \begin{align*}
            \int_{a}^{a + h} f(x)dx &= \sum_{i=0}^{n-1}\int_{x_i}^{x_{i+1}} f(x)dx
            \approx \sum_{i=0}^{n-1}\left[\frac{3\wt{h}}{4}f(x_i) + \frac{\wt{h}}{4}f(x_{i+2})\right]
            =\\&= \dfrac{3\wt{h}}{4}\left[f(x_0) + f(x_1)\right] + \dfrac{\wt{h}}{4}\left[f(x_n) + f(x_{n+1})\right]
            + \wt{h}\sum_{i=2}^{n-1}f(x_i)
        \end{align*}

        Respecto al error, tenemos que:
        \begin{align*}
            R(f) &= \sum_{i=0}^{n-1}R_i(f) = \sum_{i=0}^{n-1}\left(-\dfrac{\wt{h}^3}{3}f^{(2)}(\eta_i)\right)
            = -\dfrac{\wt{h}^3}{3}\sum_{i=0}^{n-1}f^{(2)}(\eta_i)
            = -\dfrac{\wt{h}^3n}{3}f^{(2)}(\xi)
            = -\dfrac{h\cdot \wt{h}^2}{3}f^{(2)}(\xi)
        \end{align*}
        donde $\xi\in [a, a + 2h]$.
        \item Deduce un método multipaso lineal para aproximar la solución del PVI
        \begin{equation*}
            \begin{cases}
                x' = f(f, x) \\
                x(t_0) = \mu
            \end{cases}
        \end{equation*}

        % // TODO: Cont Hacer
    \end{enumerate}
\end{ejercicio}

\begin{ejercicio}
    Considerar la fórmula numérica siguiente:
    \begin{equation*}
        \int_{-1}^1f(x)(1-x^2)\ dx=\alpha_0f(-1)+\alpha_1f(0)+\alpha_2f(1)+R(f)
    \end{equation*}
    \begin{enumerate}
        \item Hallar los valores de $\alpha_0$, $\alpha_1$ y $\alpha_2$.
        
        Calculamos cada uno de los polinomios básicos de Lagrange:
        \begin{align*}
            \ell_0(x)
            &=\prod_{\substack{j=0\\j\neq 0}}^2\frac{x-x_j}{x_0-x_j}
            = \frac{x-x_1}{x_0-x_1}\cdot\frac{x-x_2}{x_0-x_2}
            = \dfrac{x(x-1)}{(-1)(-2)} = \dfrac{x(x-1)}{2}\\
            \ell_1(x)
            &= \prod_{\substack{j=0\\j\neq 1}}^2\frac{x-x_j}{x_1-x_j}
            = \frac{x-x_0}{x_1-x_0}\cdot\frac{x-x_2}{x_1-x_2}
            = \dfrac{(x+1)(x-1)}{1(-1)} = -(x+1)(x-1)\\
            \ell_2(x)
            &= \prod_{\substack{j=0\\j\neq 2}}^2\frac{x-x_j}{x_2-x_j}
            = \frac{x-x_0}{x_2-x_0}\cdot\frac{x-x_1}{x_2-x_1}
            = \dfrac{x(x+1)}{(2)1} = \dfrac{x(x+1)}{2}
        \end{align*}

        Multiplicamos ahora cada uno de los polinomios por la función peso:
        \begin{align*}
            \ell_0(x)(1-x^2) &= -\ell_0(x)(x+1)(x-1) = -\dfrac{x(x-1)^2(x+1)}{2} = -\frac{1}{2}(x^4-x^3-x^2+x)\\
            \ell_1(x)(1-x^2) &= -\ell_1(x)(x+1)(x-1) = (x+1)^2(x-1)^2 = x^4-2x^2+1\\
            \ell_2(x)(1-x^2) &= -\ell_2(x)(x+1)(x-1) = -\dfrac{x(x+1)^2(x-1)}{2} = -\frac{1}{2}(x^4+x^3-x^2-x)
        \end{align*}

        Calculamos ahora los valores de $\alpha_0$, $\alpha_1$ y $\alpha_2$:
        \begin{align*}
            \alpha_0 &= \int_{-1}^1\ell_0(x)(1-x^2)\ dx = -\frac{1}{2}\int_{-1}^1(x^4-x^3-x^2+x)\ dx = -\left(\dfrac{1}{5}-\dfrac{1}{3}\right) = \dfrac{2}{15}\\
            \alpha_1 &= \int_{-1}^1\ell_1(x)(1-x^2)\ dx = \int_{-1}^1(x^4-2x^2+1)\ dx = 2\left(\dfrac{1}{5}-\dfrac{2}{3}+1\right) = \dfrac{16}{15}\\
            \alpha_2 &= \int_{-1}^1\ell_2(x)(1-x^2)\ dx = -\frac{1}{2}\int_{-1}^1(x^4+x^3-x^2-x)\ dx = \dfrac{2}{15}
        \end{align*}

        Por tanto, tenemos que:
        \begin{align*}
            \int_{-1}^1f(x)(1-x^2)\ dx &\approx \int_{-1}^1\left[\ell_0(x)f(-1)+\ell_1(x)f(0)+\ell_2(x)f(1)\right](1-x^2)\ dx\\
            &= \left(\int_{-1}^1\ell_0(x)(1-x^2)\ dx\right)f(-1)+\left(\int_{-1}^1\ell_1(x)(1-x^2)\ dx\right)f(0)+\\&\hspace{1.5cm}+\left(\int_{-1}^1\ell_2(x)(1-x^2)\ dx\right)f(1)\\
            &= \dfrac{2}{15}f(-1)+\dfrac{16}{15}f(0)+\dfrac{2}{15}f(1)
        \end{align*}
        \item Hallar una expresión del error $R(f)$.
        
        Tenemos que la expresión del error cometido al aproximar $f(x)$ por el polinomio de interpolación de Lagrange de grado 2 es:
        \begin{equation*}
            E(x) = f[-1,0,1,x]\Pi(x)\qquad \text{donde}\qquad \Pi(x) = \prod_{j=0}^2(x-x_j)=x(x-1)(x+1)
        \end{equation*}

        Por tanto:
        \begin{equation*}
            R(f)=L(E)=\int_{-1}^1E(x)(1-x^2)\ dx = \int_{-1}^1f[-1,0,1,x]\Pi(x)(1-x^2)\ dx
        \end{equation*}

        Sabemos que $\Pi(x)$ cambia de signo en $x=0$. Para evitar esto, hacemos uso de que:
        \begin{multline*}
            f[-1, 0, 0, 1, x] = \dfrac{f[-1, 0, 1, x]-f[-1, 0, 0, 1]}{x-0}
            \Longrightarrow\\\Longrightarrow f[-1, 0, 1, x] = f[-1, 0, 0, 1, x]x + f[-1, 0, 0, 1]
        \end{multline*}

        Por tanto, tenemos que:
        \begin{align*}
            R(f) &= \int_{-1}^1\left(f[-1, 0, 0, 1, x]x + f[-1, 0, 0, 1]\right)x(x-1)(x+1)(1-x^2)\ dx
            =\\&= -\int_{-1}^1\left(f[-1, 0, 0, 1, x]x^2+f[-1, 0, 0, 1]x\right)(x-1)^2(x+1)^2\ dx
            =\\&= -\int_{-1}^1f[-1, 0, 0, 1, x]x^2(x-1)^2(x+1)^2\ dx - f[-1, 0, 0, 1]\int_{-1}^1x(x-1)^2(x+1)^2\ dx
        \end{align*}

        Por el Teorema del Valor Medio Integral Generalizado, $\exists \mu\in [-1,1]$ tal que:
        \begin{align*}
            R(f) &= -f[-1, 0, 0, 1, \mu]\int_{-1}^1x^2(x-1)^2(x+1)^2\ dx - f[-1, 0, 0, 1]\int_{-1}^1x(x-1)^2(x+1)^2\ dx
            =\\&= -f[-1, 0, 0, 1, \mu]\int_{-1}^1(x^6-2x^4+x^2)\ dx - f[-1, 0, 0, 1]\int_{-1}^1(x^5-2x^3+x)\ dx
            =\\&= -2f[-1, 0, 0, 1, \mu]\left(\dfrac{1}{7}-\dfrac{2}{5}+\dfrac{1}{3}\right) - f[-1, 0, 0, 1]\cdot 0
            \\&= -\dfrac{16}{105}\cdot f[-1, 0, 0, 1, \mu]
        \end{align*}

        Suponiendo $f\in C^4[-1,1]$, $\exists \xi\in [-1,1]$ tal que:
        \begin{equation*}
            R(f) = -\dfrac{16}{105}\cdot \dfrac{f^{(4)}(\xi)}{4!}
            = -\dfrac{2}{315}\cdot f^{(4)}(\xi)
        \end{equation*}
    \end{enumerate}
\end{ejercicio}


\begin{ejercicio}
    Se pretende aproximar mediante integración de Romberg la integral:
    \begin{equation*}
        \int_1^3 \frac{1}{x} \, dx.
    \end{equation*}
    Calcula para ello \( R(2, 2) \).\\

    Definimos la siguiente función auxiliar:
    \Func{f}{[1,3]}{\bb{R}}{x}{\nicefrac{1}{x}}

    Buscamos construir la siguiente tabla:
    \begin{equation*}
        \begin{array}{ccc}
            R(0, 0) \\
            R(1, 0) & R(1, 1) \\
            R(2, 0) & R(2, 1) & R(2, 2)
        \end{array}
    \end{equation*}

    Calculamos en primer lugar \( R(i, 0) \) para cada $i\in \{0,1,2\}$:
    \begin{align*}
        R(0, 0) &= T_1 = (3-1)\cdot \dfrac{f(3)-f(1)}{2}
        = \dfrac{4}{3}\\
        R(1, 0) &= T_2 = \dfrac{3-1}{2\cdot 2}\left(f(1)+2\cdot f\left(1+\dfrac{3-1}{2}\right)+f(3)\right)
        = \dfrac{7}{6}\\
        R(2, 0) &= T_{4} =\\&= \dfrac{3-1}{4\cdot 2}\left(f(1)+2\left[f\left(1+\dfrac{3-1}{4}\right)+f\left(1+2\cdot \dfrac{3-1}{4}\right)+f\left(1+3\cdot \dfrac{3-1}{4}\right)\right]+f(3)\right)
        =\\&= \dfrac{67}{60}
    \end{align*}

    Una vez obtenidos esos valores, calculamos \( R(i, j) \) para \( i,j=1,2 \), con $ j < i $:
    \begin{align*}
        R(1, 1) &= \dfrac{4R(1,0)-R(0,0)}{3} = \dfrac{10}{9}\\
        R(2, 1) &= \dfrac{4R(2,0)-R(1,0)}{3} = \dfrac{11}{10}\\
        R(2, 2) &= \dfrac{4^2R(2,1)-R(1,1)}{15} = \dfrac{742}{675}\approx 1.09925925
    \end{align*}
\end{ejercicio}

\begin{ejercicio}
    Dada la regla de integración numérica
    \begin{equation*}
        \int_a^b f(x) \, dx = L_n(f, h) + c_1 h + c_2 h^2 + c_3 h^3 + \ldots
    \end{equation*}
    ¿Cómo se haría un procedimiento similar a la integración de Romberg con esta fórmula?\\


    Tomando $\nicefrac{h}{2}$, llegamos a que:
    \begin{align*}
        \int_a^b f(x) \, dx &= L_n\left(f,\nicefrac{h}{2}\right) + c_1 \cdot \frac{h}{2} + c_2 \cdot \left(\frac{h}{2}\right)^2 + c_3 \cdot \left(\frac{h}{2}\right)^3 + \ldots\\
    \end{align*}

    Buscamos ahora eliminar el término del error de orden $h$. Multiplicando por $2$ esta expresión y restándole la original, obtenemos:
    \begin{align*}
        \hspace{-1cm}\int_a^b f(x) \, dx &= 2L_n\left(f,\nicefrac{h}{2}\right) - L_n(f, h) + c_1 \cdot \left(h-h\right) + c_2 \cdot \left(2\left(\frac{h}{2}\right)^2 - h^2\right) + c_3 \cdot \left(2\left(\frac{h}{2}\right)^3 - h^3\right) + \ldots\\
        \hspace{-1cm}&= 2L_n\left(f,\nicefrac{h}{2}\right) - L_n(f, h) - c_2 \cdot \left(\frac{h^2}{2}\right) - c_3 \cdot \left(\frac{3h^3}{4}\right) + \ldots
    \end{align*}

    Hemos conseguido eliminar el término de orden $h$, pero nos quedan los términos de orden $h^2$ y $h^3$. De forma similar a la integración de Romberg, podemos definir los siguientes términos:
    \begin{align*}
        L(i,0) &= L_n(f, \nicefrac{h}{2^i}),\qquad i=0,1,\ldots\\
        L(i,j) &= \dfrac{2^jL(i,j-1)-L(i-1,j-1)}{2^j-1}, \quad i,j\in \{0,1,\ldots\}, \quad j\leq i\\
    \end{align*}

    De esta forma, podemos aproximar la integral de la siguiente forma:
    \begin{align*}
        \int_a^b f(x) \, dx &\approx L(N,N)
    \end{align*}
    donde $N$ es el número de pasos que hemos dado.
\end{ejercicio}