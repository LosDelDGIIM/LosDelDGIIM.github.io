\documentclass[12pt]{article}

\input{../../_assets/preambulo.tex}

\usepackage{stackengine}

\begin{document}

    % 1. Foto de fondo
    % 2. Título
    % 3. Encabezado Izquierdo
    % 4. Color de fondo
    % 5. Coord x del titulo
    % 6. Coord y del titulo
    % 7. Fecha

    
    \input{../../_assets/portada}
    \portadaExamen{etsiitA4.jpg}{MNII\\Examen III}{MNII. Examen III}{MidnightBlue}{-8}{28}{2025}{}

    \begin{description}
        \item[Asignatura] Métodos Numéricos II.
        \item[Curso Académico] 2023/24.
        \item[Grado] Grado en Ingeniería Informática y Matemáticas.
        \item[Grupo] Único.
        \item[Profesor] Lidia Fernández Rodríguez.
        \item[Descripción] Primer Parcial.
        \item[Fecha] 9 de Abril de 2024.
        \item[Duración] 2 horas y 30 minutos.
        \item[Observaciones] Los ejercicios se encuentran resueltos, posiblemente en mayor detalle, en el documento de Relaciones. Se recomienda ver ambas soluciones.
    \end{description}
    \newpage


    % ------------------------------------
    
    \begin{ejercicio}[2 puntos]
        Contesta razonadamente a las siguientes preguntas:
        \begin{enumerate}
          \item Se pretende resolver la ecuación $$ f(x) = 0 $$ ¿Qué debe cumplir la función \( f \) para que el método de Newton-Raphson tenga convergencia al menos cúbica? (0.5 puntos)
          \item ¿Es el método de Newton-Raphson para resolver el sistema $$ F(x) = 0 $$ invariante frente a transformaciones lineales de \( F \)?  (1 punto)
          \begin{observacion}
          Que sea invariante frente a transformaciones lineales quiere decir que la secuencia de aproximaciones $\{X_n\}$ es la misma si se aplica al sistema \( F(X) = 0 \) o si se aplica al sistema $AF(X) = 0$, 
          siendo \( A \) una matriz no singular, partiendo del mismo vector inicial \( X_0 \).
          \end{observacion}
          \item ¿El error en las fórmulas de derivación numérica disminuye si aumentamos el número de nodos? (0.5 puntos)
        \end{enumerate}
    \end{ejercicio}
        
    \begin{ejercicio}[4 puntos]
        El problema de trisección de un ángulo consiste en hallar las razones trigonométricas de $\alpha/3$, conociendo las de $\alpha \in ]0, \pi/2[$
        \begin{enumerate}
          \item (0.5 puntos) Llamando \( x = \sen(\alpha/3) \) y \( a = \sen(\alpha) \), demuestra que $x$ es solución de la ecuación
          \begin{equation}\label{eq:ej2}
            -4x^3 + 3x - a = 0
          \end{equation}
          \item Construye una sucesión de Sturm de polinomios asociada a $$ p(x) = -4x^3 + 3x - a $$ y deduce que \( p \) tiene exactamente 3 raíces reales. (1 punto. Sucesión 0.5 puntos y Raíces 0.5 puntos)
          \item Demuestra que \( \sen(\alpha/3) \) es la única solución de la ecuación \( p(x) = 0 \), en el intervalo \( ]0, a/2[ \) y que, tomando como valores iniciales \( x_0 = a/3 \) o \( x_0 = a/2 \), el método de Newton-Raphson converge.
          (1 punto. Solución en $]0, a/2[$ 0.5 puntos y Condiciones NR 0.5 puntos)
          \item Para resolver (\ref{eq:ej2}) se propone el método iterativo
          \[
          x_{n+1} = \frac{a}{3 - 4x_n^2}
          \]
          Estudia bajo qué condiciones el método converge a la solución. ¿Cuál de los dos métodos converge más rápidamente? (1 punto. Convergencia 0.5 puntos, Comparación 0.5 puntos)
          \item Tomando \( a = 1/2 \), realiza una iteración del método de Newton-Raphson partiendo de \( x_0 = 1/6 \) para obtener una aproximación de \( \sen(\pi/18) \). (0.5 puntos)         
        \end{enumerate}
    \end{ejercicio}

    
        
    \begin{ejercicio}[4 puntos]
      Dada la fórmula de derivación numérica de tipo interpolatorio:
      \[
      f'(0) = \alpha_0 f(-1) + \alpha_1 f(1) + \alpha_2 f(2) + \alpha_3 f(a) + R(f), \quad a \neq -1, 1, 2.
      \]

      \begin{enumerate}
        \item Sin realizar ningún cálculo, ¿puedes indicar el máximo grado de exactitud que puede tener la fórmula? Justifica la respuesta. (0.5 puntos)
        \item Determina los valores de \( \alpha_0, \alpha_1, \alpha_2, \alpha_3 \) y \( a \) para que la fórmula tenga el mayor grado de exactitud posible. ¿Cuál es ese grado de exactitud? (1.5 puntos. Plantear el Sistema 0.5 puntos, 
        Valores de $\alpha_i$ 0.5 puntos y Valor de $a$ 0.5 puntos)
        \item Determina la expresión del error indicando las condiciones sobre derivabilidad de la función \( f \). (1 punto)  
        \item Aplica el resultado para la función $xe^{x^2 + 1}$. (1 punto) 
      \end{enumerate}
    \end{ejercicio}

    \newpage

    \setcounter{ejercicio}{0}

    \begin{ejercicio}[2 puntos]
        Contesta razonadamente a las siguientes preguntas:
        \begin{enumerate}
          \item Se pretende resolver la ecuación $$ f(x) = 0 $$ ¿Qué debe cumplir la función \( f \) para que el método de Newton-Raphson tenga convergencia al menos cúbica? (0.5 puntos) \\
          
          Consideramos $x_{n+1} = g(x_n)$ donde $g(x) = x - \frac{f(x)}{f'(x)}$. Entonces:
          \begin{align*}
            g'(x) &= 1 - \frac{f'(x)^2 - f(x) f''(x)}{f'(x)^2} 
            = \frac{f(x) f''(x)}{f'(x)^2}\\
            g''(x) &= \frac{(f'(x) f''(x) + f(x) f'''(x)) f'(x)^2 - 2 f(x) f'(x) f''(x)^2}{f'(x)^4}
            \\&= \frac{f'(x)^2 f''(x) + f(x) f'(x) f'''(x) - 2 f(x) f''(x)^2}{f'(x)^3}
          \end{align*}

          Si $s$ es la solución de $f(x) = 0$ que buscamos:
          \begin{align*}
            g'(s) &= 0\\
            g''(s) &= \frac{f'(s)^2 f''(s)}{f'(s)^3} \Longrightarrow g''(s) = 0 \iff f''(s) = 0
          \end{align*}

          Entonces, si $f$ es de clase 3 en el intervalo en el que está localizada la raíz $s$ y 
          $f''(s) = 0$, el método de NR tendrá convergencia local al menos cúbica.

          \item ¿Es el método de Newton-Raphson para resolver el sistema $$ F(x) = 0 $$ invariante frente a transformaciones lineales de \( F \)?  (1 punto)
          \begin{observacion}
            Que sea invariante frente a transformaciones lineales quiere decir que la secuencia de aproximaciones $\{X_n\}$ es la misma si se aplica al sistema \( F(X) = 0 \) o si se aplica al sistema $AF(X) = 0$, 
            siendo \( A \) una matriz no singular, partiendo del mismo vector inicial \( X_0 \).
          \end{observacion}

          Queremos resolver el sistema $F(X) = 0$. Consideramos como aproximación inicial $X_0$, y el método $$X_{n+1} = X_n - JF(X_n)^{-1} F(X_n),\quad n \ge 0$$
          Si llamamos $$G(X) = A F(X) \Rightarrow JG = A \cdot JF \quad\quad (*)$$
          $$\Rightarrow JG(X_n)^{-1} = (A JF(X_n))^{-1} = JF(X_n)^{-1} \cdot A^{-1}$$
          La sucesión construida con $G$ será entonces:
          \[
          X_0,\quad \wt{X}_{n+1} = \wt{X}_n - JG(\wt{X}_n)^{-1} \cdot G(\wt{X}_n) \Rightarrow
          \]
          \[
          \wt{X}_{n+1} = \wt{X}_n - JF(\wt{X}_n)^{-1} \cdot A^{-1} \cdot A \cdot F(\wt{X}_n)
          \]
          \[
          \wt{X}_{n+1} = \wt{X}_n - JF(\wt{X}_n)^{-1} \cdot F(\wt{X}_n), \quad n \ge 0
          \]
          Como partimos del mismo $X_0$ la sucesión es la misma.

          \[
          (*) \quad F(X) = \begin{pmatrix}
          f_1(x)\\
          \vdots \\
          f_n(x)
          \end{pmatrix}, \quad JF = \begin{pmatrix}
          \frac{\partial f_1}{\partial x_1} & \cdots & \frac{\partial f_1}{\partial x_n} \\
          \vdots & \ddots & \vdots \\
          \frac{\partial f_n}{\partial x_1} & \cdots & \frac{\partial f_n}{\partial x_n}
          \end{pmatrix}
          \]
          \[
          A \cdot F(X) = \begin{pmatrix}
          a_{11} & \cdots & a_{1n} \\
          \vdots & \ddots & \vdots \\
          a_{n1} & \cdots & a_{nn}
          \end{pmatrix}
          \begin{pmatrix}
          f_1(x)\\
          \vdots \\
          f_n(x)
          \end{pmatrix}
          = \begin{pmatrix}
          a_{11} f_1(x) + \dots + a_{1n} f_n(x) \\
          \vdots \\
          a_{n1} f_1(x) + \dots + a_{nn} f_n(x)
          \end{pmatrix}
          \]
          \[
          \frac{\partial}{\partial x_j}(a_{i1} f_1(x) + \dots + a_{in} f_n(x))
          = a_{i1} \frac{\partial}{\partial x_j} f_1(x) + \dots + a_{in} \frac{\partial}{\partial x_j} f_n(x)
          \]
          \[
          = (a_{i1} \cdots a_{in}) 
          \begin{pmatrix}
          \frac{\partial}{\partial x_j} f_1(x) \\
          \vdots \\
          \frac{\partial}{\partial x_j} f_n(x)
          \end{pmatrix}
          \]
          donde el elemento $ij$ es el de la matriz $J(A F(X))$.

          Entonces:
          \[
          J(A F(X)) = \begin{pmatrix}
          a_{11} \frac{\partial}{\partial x_1} f_1(x) + \dots + a_{1n} \frac{\partial}{\partial x_1} f_n(x) & \dots & a_{11} \frac{\partial}{\partial x_n} f_1(x) + \dots + a_{1n} \frac{\partial}{\partial x_n} f_n(x) \\
          \vdots & \ddots & \vdots \\
          a_{n1} \frac{\partial}{\partial x_1} f_1(x) + \dots + a_{nn} \frac{\partial}{\partial x_1} f_n(x) & \dots & a_{n1} \frac{\partial}{\partial x_n} f_1(x) + \dots + a_{nn} \frac{\partial}{\partial x_n} f_n(x)
          \end{pmatrix}
          \]
          \[
          = A \cdot JF(X)
          \]

          \item ¿El error en las fórmulas de derivación numérica disminuye si aumentamos el número de nodos? (0.5 puntos) \\
          
          No, puede ocurrir el fenómeno de Runge. Este suceso provoca que, al aumentar el número de nodos en la interpolación polinómica, las oscilaciones cerca de los extremos aumenten, incrementándose también el error de la aproximación. \\

          Un ejemplo visto en teoría es el de la fórmula de Newton-Cotes. Por ejemplo: 

          $$\int_{-4}^{4} \dfrac{dx}{1+x^2}$$

          Cuando el número de nodos va a infinito, el error no tiende a $0$.

        \end{enumerate}
    \end{ejercicio}


    \begin{ejercicio}[4 puntos]
        El problema de trisección de un ángulo consiste en hallar las razones trigonométricas de $\alpha/3$, conociendo las de $\alpha \in ]0, \pi/2[$
        \begin{enumerate}
          \item (0.5 puntos) Llamando \( x = \sen(\alpha/3) \) y \( a = \sen(\alpha) \), demuestra que $x$ es solución de la ecuación
          \begin{equation*}
            -4x^3 + 3x - a = 0
          \end{equation*}

          Consideramos $\alpha \in ]0, \pi/2[$, $x = \sen\left(\frac{\alpha}{3}\right)$ y $a = \sen \alpha$. Entonces:
          \begin{align*}
              \sen(\alpha)
              &= \sen\left(\dfrac{\alpha}{3}+\dfrac{2\alpha}{3}\right)=\sen\left(\dfrac{\alpha}{3}\right)\cos\left(\dfrac{2\alpha}{3}\right)+\cos\left(\dfrac{\alpha}{3}\right)\sen\left(\dfrac{2\alpha}{3}\right)\\
              &= \sen\left(\dfrac{\alpha}{3}\right)\left[\cos^2\left(\dfrac{\alpha}{3}\right)-\sen^2\left(\dfrac{\alpha}{3}\right)\right]+\cos\left(\dfrac{\alpha}{3}\right)\left[2\sen\left(\dfrac{\alpha}{3}\right)\cos\left(\dfrac{\alpha}{3}\right)\right]\\
              &= \sen\left(\dfrac{\alpha}{3}\right)\left[1-2\sen^2\left(\dfrac{\alpha}{3}\right)\right]+2\cos^2\left(\dfrac{\alpha}{3}\right)\sen\left(\dfrac{\alpha}{3}\right)\\
              &= \sen\left(\dfrac{\alpha}{3}\right)\left[1-2\sen^2\left(\dfrac{\alpha}{3}\right)+2\left(1-\sen^2\left(\dfrac{\alpha}{3}\right)\right)\right]\\
              &= \sen\left(\dfrac{\alpha}{3}\right)\left[3-4\sen^2\left(\dfrac{\alpha}{3}\right)\right]
              = 3\sen\left(\dfrac{\alpha}{3}\right)-4\sen^3\left(\dfrac{\alpha}{3}\right)
          \end{align*}

          Por tanto, $x=\sen\left(\nicefrac{\alpha}{3}\right)$ es solución de la ecuación $-4x^3 + 3x - a = 0$.

          \item Construye una sucesión de Sturm de polinomios asociada a $$ p(x) = -4x^3 + 3x - a $$ y deduce que \( p \) tiene exactamente 3 raíces reales. (1 punto. Sucesión 0.5 puntos y Raíces 0.5 puntos) \\
          
          Ahora, sea $p(x) = -4x^3 + 3x - a$, con $a \in ]0,1[$

          \[
          \alpha = \max\left\{ \frac{3}{4}, \frac{a}{4} \right\} = \frac{3}{4}
          \]

          \[
          \Rightarrow \text{Todas las raíces de } p(x) \text{ están en el intervalo }
          \left[ -\frac{7}{4}, \frac{7}{4} \right] \subset [-2, 2]
          \]

          Ahora, obtenemos la sucesión de Sturm asociada a $p(x)$:
          \[
          f_0(x) = -4x^3 + 3x - a
          \]
          \[
          f_1(x) = -12x^2 + 3
          \]
          \[
          f_2(x) = -2x + a
          \]
          \[
          f_3(x) = 3a^2 - 3 < 0 \quad \text{porque } a \in ]0,1[
          \]

          \[
          \begin{array}{c|cccc|c}
          x & f_0(x) & f_1(x) & f_2(x) & f_3(x) & \text{Cambios de signo} \\
          \hline
          -2 & + & - & + & - & 3 \\
          2 & - & - & - & - & 0 \\
          \hline
          \end{array}
          \]

          Entonces, \(p(x)\) tiene 3 raíces reales en \([-2,2]\).

          \item Demuestra que \( \sen(\alpha/3) \) es la única solución de la ecuación \( p(x) = 0 \), en el intervalo \( ]0, a/2[ \) y que, tomando como valores iniciales \( x_0 = a/3 \) o \( x_0 = a/2 \), el método de Newton-Raphson converge.
          (1 punto. Solución en $]0, a/2[$ 0.5 puntos y Condiciones NR 0.5 puntos)

          \[
          \begin{array}{c|cccc|c}
          x & f_0(x) & f_1(x) & f_2(x) & f_3(x) & \text{Cambios de signo} \\
          \hline
          0 & - & + & + & - & 2 \\
          a/2 & + & + & 0 & - & 1
          \end{array}
          \]

          \[
          \frac{a}{2} (1 - a^2), \quad 0 < \sen\left(\frac{\alpha}{3}\right)
          \]

          Ahora, queremos ver si $$\sen\left(\frac{\alpha}{3}\right) < \frac{\sen(\alpha)}{2}$$

          Definiendo $$f(x) = \sen\left(\frac{\alpha}{3}\right) - \frac{\sen(\alpha)}{2}$$ vemos que $f(0) = 0$ y $$f'(x) = \frac{1}{3} \cos\left(\frac{\alpha}{3}\right) - \frac{\cos(\alpha)}{2} < 0 \quad \forall x \in ]0, a/2[$$

          Por tanto, la desigualdad $\sen\left(\frac{\alpha}{3}\right) < \frac{\sen(\alpha)}{2}$ es cierta.

          Como tenemos una función continua estrictamente monótona, que se anula, solo puede anularse una vez, y, por tanto, hay exactamente una raíz en \(]0, a/2[\).

          \[
          p'(x) = -12x^2 + 3, \quad p'(x)=0 \implies x^2 = \frac14 \implies x = \pm \frac12
          \]

          Como \(a < 1\), \(p'(x)\) no se anula en \(]0, a/2[\).

          Veamos las condiciones de convergencia del método de Newton-Raphson:
          \begin{enumerate}
            \item \(p(0) \, p(a/2) < 0\)
            \item \(p'(x) \neq 0 \quad \forall x \in ]0,a/2[\)
            \item \(p''(x) = -24x \le 0\) en \(]0, a/2[\), no cambia de signo
            \item \[
                  \max \left\{ \frac{|f(0)|}{|f'(0)|}, \frac{|f(a/2)|}{|f'(a/2)|} \right\}
                  = \max \left\{ |-a/3|, a/6 \right\} = a/3 \le a/2
                  \]
          \end{enumerate}

          Entonces, por el teorema de convergencia global del método de NR, este converge si tomamos cualquier \(x_0 \in ]0, a/2[\). En particular, converge si tomamos \(x_0 = a/3\) o \(x_0 = a/2\).


          \item Para resolver (\ref{eq:ej2}) se propone el método iterativo
          \[
          x_{n+1} = \frac{a}{3 - 4x_n^2}
          \]
          Estudia bajo qué condiciones el método converge a la solución. ¿Cuál de los dos métodos converge más rápidamente? (1 punto. Convergencia 0.5 puntos, Comparación 0.5 puntos)

          \[
          x_{n+1} = g(x_n), \quad g(x) = \frac{a}{3 - 4x^2}
          \]

          Si \(g(s) = s\),  
          \[
          s = \frac{a}{3 - 4s^2} \quad\Rightarrow\quad -4s^3 + 3s = a
          \]
          Si hay convergencia, el método converge a la raíz.

          Si \(s\) es la solución de la ecuación \(-4x^3 + 3x - a = 0\), entonces:
          \[
          3 - 4s^2 = \frac{a}{s}
          \]
          \[
          g'(s) = \frac{8as}{(a/s)^2} = \frac{8s^3}{a} \neq 0
          \]
          \[
          |g'(s)| = \frac{8s^3}{a} < a^2 \le 1
          \]
          \[
          \text{(pues \(0 < s < a/2 \implies \frac{8s^3}{a} \le \frac{8 a^3}{2^3 a}\))}
          \]

          Hay convergencia local pero el orden de convergencia es menor que NR.

          \item Tomando \( a = 1/2 \), realiza una iteración del método de Newton-Raphson partiendo de \( x_0 = 1/6 \) para obtener una aproximación de \( \sen(\pi/18) \). (0.5 puntos)         
          
          \[
          a = \frac12, \quad \alpha = \sen^{-1} a \implies \alpha = \frac{\pi}{6}
          \]
          \[
          x = \sen\left(\frac{\alpha}{3}\right) = \sen\left(\frac{\pi}{18}\right)
          \]
          \[
          x_0 = \frac16
          \]
          \[
          x_{n+1} = x_n - \frac{-4x_n^3 + 3x_n - \frac12}{-12x_n^2 + 3}
          \]
          \[
          x_1 = 0.173611
          \]
          \[
          \left(\sen\frac{\pi}{18} \approx 0.173648\right)
          \]

        \end{enumerate}
    \end{ejercicio}


    \begin{ejercicio}[4 puntos]
      Dada la fórmula de derivación numérica de tipo interpolatorio:
      \[
      f'(0) = \alpha_0 f(-1) + \alpha_1 f(1) + \alpha_2 f(2) + \alpha_3 f(a) + R(f), \quad a \neq -1, 1, 2.
      \]

      \begin{enumerate}
        \item Sin realizar ningún cálculo, ¿puedes indicar el máximo grado de exactitud que puede tener la fórmula? Justifica la respuesta. (0.5 puntos) \\

        Es una fórmula con 4 nodos ($n=3$) y estamos aproximando una derivada primera ($k=1$), entonces según el teorema visto en clase (limitación de grado de exactitud), el máximo orden de exactitud es
        \[
        n+k = 4.
        \]

        \item Determina los valores de \( \alpha_0, \alpha_1, \alpha_2, \alpha_3 \) y \( a \) para que la fórmula tenga el mayor grado de exactitud posible. ¿Cuál es ese grado de exactitud? (1.5 puntos. Plantear el Sistema 0.5 puntos, 
        Valores de $\alpha_i$ 0.5 puntos y Valor de $a$ 0.5 puntos) \\

        Imponemos exactitud en $1, x, x^2, x^3$ y después comprobamos si puede haber exactitud en $x^4$.

        \[
        \begin{rcases}
        1 \hspace{0.19cm} \to 0 = \alpha_0 + \alpha_1 + \alpha_2 + \alpha_3 \\
        x \hspace{0.16cm} \to 1 = -\alpha_0 + \alpha_1 + 2\alpha_2 + a\alpha_3, \\
        x^2 \to 0 = \alpha_0 + \alpha_1 + 4\alpha_2 + a^2 \alpha_3, \\
        x^3 \to 0 = -\alpha_0 + \alpha_1 + 8\alpha_2 + a^3 \alpha_3.
        \end{rcases}
        \]

        Resolviendo el sistema matricial paso a paso, se obtiene:

        $$
        \left(\begin{array}{cccc|c}
        1 & 1 & 1 & 1 & 0 \\
        -1 & 1 & 2 & a & 1 \\
        1 & 1 & 4 & a^2 & 0 \\
        -1 & 1 & 8 & a^3 & 0 \\
        \end{array}\right) 
        \underset{\begin{subarray}{c}
          F_3' = F_3 - F_1 \\
          \vspace{-0.05cm} \\
          F_4' = F_4 + F_1
          \end{subarray}}{\xrightarrow{F_2' = F_2 + F_1}}
        \left(\begin{array}{cccc|c}
        1 & 1 & 1 & 1       & 0 \\
        0 & 2 & 3 & a+1     & 1 \\
        0 & 0 & 3 & a^2 - 1 & 0 \\
        0 & 2 & 9 & a^3 + 1 & 0 \\
        \end{array}\right) \xrightarrow{}
        $$

        \[
        \underset{\begin{subarray}{c}
          F_4' = F_4 - F_2
          \end{subarray}}{\xrightarrow{}}
        \left(\begin{array}{cccc|c}
        1 & 1 & 1 & 1     & 0 \\
        0 & 2 & 3 & a+1   & 1 \\
        0 & 0 & 3 & a^2-1 & 0 \\
        0 & 0 & 6 & a^3-a & -1 \\
        \end{array}\right)
        \xrightarrow{F_4' = F_4 - 2F_3}
        \left(\begin{array}{cccc|c}
        1 & 1 & 1 & 1            & 0 \\
        0 & 2 & 3 & a+1          & 1 \\
        0 & 0 & 3 & a^2-1        & 0 \\
        0 & 0 & 0 & (a-2)(a^2-1) & -1 \\
        \end{array}\right)
        \]

        $$a(a^2-1) - 2(a^2-1) = (a-2)(a^2-1) \hspace{0.5cm} (=a^3 - 2a^2 - a + 2)$$

        $$
        \alpha_3 = -\frac{1}{(a-2)(a^2-1)}
        $$$$
        \alpha_2 = \frac{1}{3} \left(\frac{(a^2-1)}{(a-2)(a^2-1)} \right) = \frac{1}{3(a-2)}, 
        $$$$
        \alpha_1 = \frac{1}{2} \left( 1 - 3 \cdot \frac{1}{3(a - 2)} + \frac{(a + 1)}{(a - 2)(a^2 - 1)} \right) \\
            = \frac{1}{2} \left( \frac{(a - 2)(a - 1) - (a - 1) + 1}{(a - 2)(a - 1)} \right)
        $$$$
            = \frac{1}{2} \cdot \frac{a^2-4a+4}{(a - 2)(a - 1)} = \frac{(a - 2)}{2(a - 1)}
        $$$$
        \alpha_0 = - \frac{a - 2}{2(a - 1)} - \frac{1}{3(a - 2)} + \frac{1}{(a - 2)(a^2 - 1)} = 
        $$$$
        \frac{-3(a^2 - 4a + 4)(a + 1) - 2(a^2 - 1) + 6}{6 (a^2 - 1)(a - 2)} = \frac{-3a^3 + 7a^2 - 4}{6 (a^2 - 1)(a - 2)} =
        $$$$
         - \frac{(3a + 42)}{6 (a + 1)}
        $$

        Si además imponemos exactitud en $x^4$:

        $$\begin{cases}
        0 = \alpha_0 + \alpha_2 + 16\alpha_2 + a^4\alpha_3 \\\\
        \dfrac{-3a^3 + 7a^2 - 4}{6 (a^2 - 1)(a - 2)} + \dfrac{a^2 - 4a + 4}{2 (a - 2)(a - 1)} + \dfrac{16 (a^2 - 1)}{3 (a - 2)(a^2 - 1)} - \dfrac{a^4}{(a - 2)(a^2 - 1)} = 0 \\\\
        -3a^3 + 7a^2 - 4 + 3 (a + 1)(a^2 - 4a + 4) + 32 (a^2 - 1) - 6a^4 = 0 \\\\
        
        -6a^4 + 30a^2 - 24 = 0 \quad \Longrightarrow \quad a = -2, a = 2, a = -1, a = 1

        \end{cases}$$

        Como el enunciado nos decía que $a \neq -1, 1, 2$, entonces se consigue exactitud 4 si \boxed{a=-2}. \\

        Se resuelve más sencillo si a esta ecuación le restamos la primera del sistema anterior y queda

        $$15\alpha_2 + (a^4-1)\alpha_3 = 0$$
        $$15 \dfrac{1}{3(a-2)} + (a^4-1) \left(\dfrac{1}{(a-2)(a^2-1)}\right) = 0$$
        $$\dfrac{5}{(a-2)} - \dfrac{a^2+1}{a-2} = 0 \Longrightarrow a^2 + 1 = 5 \Longrightarrow a^2 = 4 \Longrightarrow a = \pm 2$$

        y nuevamente se llega a que $a=-2$ es el único valor que cumple con las hipótesis del enunciado. \\

        Entonces, el máximo grado de exactitud es $4$ y la fórmula queda:

        $$\alpha_0 = - \dfrac{3(-2) + 2}{6 \cdot (-1)} = \dfrac{-2}{3}$$
        $$\alpha_1 = \dfrac{-4}{2 \cdot (-3)} = \dfrac{2}{3}$$
        $$\alpha_2 = \dfrac{1}{3(-4)} = -\dfrac{1}{12}$$
        $$\alpha_3 = -\dfrac{1}{(-4)3} = \dfrac{1}{12}$$

        \begin{center}
          \boxed{f'(0) = -\tfrac{2}{3} f(-1) + \tfrac{2}{3} f(1) - \tfrac{1}{12} f(2) + \tfrac{1}{12} f(-2) + R(f).}
        \end{center}
        
        También se puede hacer con los polinomios de Lagrange:

        $x_0 = -1$, $x_1 = 1$, $x_2 = 2$, $x_3 = a$

        \[
        \ell_0(x) = \frac{(x-1)(x-2)(x-a)}{(-1-1)(-1-2)(-1-a)} = \frac{(x-1)(x-2)(x-a)}{-6(a+1)}
        \]

        \[
        \ell_1(x) = \frac{(x+1)(x-2)(x-a)}{(1+1)(1-2)(1-a)} = \frac{(x+1)(x-2)(x-a)}{-2(1-a)} = \frac{(x+1)(x-2)(x-a)}{2(a-1)}
        \]

        \[
        \ell_2(x) = \frac{(x+1)(x-1)(x-a)}{(2+1)(2-1)(2-a)} = \frac{(x+1)(x-1)(x-a)}{3(2-a)}
        \]

        \[
        \ell_3(x) = \frac{(x+1)(x-1)(x-2)}{(a+1)(a-1)(a-2)}
        \]

        \[
        \ell_0'(x) = -\frac{1}{6(a+1)} \left[ (x-2)(x-a) + (x-1)(x-a) + (x-1)(x-2) \right]
        \]

        \[
        \ell_0'(0) = -\frac{1}{6(a+1)} \left[ 2a + a + 2 \right] = \boxed{-\frac{3a + 2}{6(a+1)} = \alpha_0}
        \]

        \[
        \ell_1'(x) = \frac{1}{2(a+1)} \left[ (x-2)(x-a) + (x+1)(x-a) + (x+1)(x-2) \right]
        \]

        \[
        \ell_1'(0) = \frac{1}{2(a-1)} \left[ 2a - a - 2 \right] = \boxed{\frac{a-2}{2(a-1)} = \alpha_1}
        \]

        \[
        \ell_2'(x) = \frac{1}{3(2-a)} \left[ (x-1)(x-a) + (x+1)(x-a) + (x+1)(x-1) \right]
        \]

        \[
        \ell_2'(0) = \frac{1}{3(2-a)} \left[ a - a - 1 \right] = \boxed{-\frac{1}{3(2-a)} = \alpha_2}
        \]

        \[
        \ell_3'(x) = \frac{1}{(a+1)(a-1)(a-2)} \left[ (x-1)(x-2) + (x+1)(x-2) + (x+1)(x-1) \right]
        \]

        \[
        \ell_3'(0) = \frac{1}{(a+1)(a-1)(a-2)} \left[ 2 - 2 - 1 \right] = \boxed{\frac{-1}{(a+1)(a-1)(a-2)} = \alpha_3}
        \]


        \item Determina la expresión del error indicando las condiciones sobre derivabilidad de la función \( f \). (1 punto) \\
        
        \[
        E(x) = f[-2,-1,1,2,x]\underbrace{(x+1)(x-1)(x+2)(x-2)}_{(x^2-1)(x^2-4)}.
        \]

        \[
        R(f) = E'(0).
        \]

        $$
        E'(x) = f[-2,-1,1,2,x,x] (x+1)(x-1)(x+2)(x-2)$$
        $$
        + f[-2,-1,1,2,x] \overbrace{\left((x-1)(x+2)(x-2) + (x+1)(x+2)(x-2) + (x+1)(x-1) \right)}^{2x(x^2-4) + 2x(x^2-1)}
        $$

        \[
        E'(0) = 4 f[-2,-1,1,2,0,0] = \frac{4}{5!} f^{(v)}(\xi), \quad \xi \in [-2,2].
        \]

        Es necesario que $f$ sea de clase $5$ en $[-2,2]$.

        \item Aplica el resultado para la función $xe^{x^2 + 1}$. (1 punto) \\
      
        Sea
        \[
        f(x) = x e^{x^2+1}.
        \]

        Entonces
        \[
        f'(0) \approx -\tfrac{2}{3} f(-1) + \tfrac{2}{3} f(1) - \tfrac{1}{12} f(2) + \tfrac{1}{12} f(-2) = \tfrac{4}{3} e^2 - \tfrac{4}{3} e^5 \approx -39\text{.}649
        \]

        mientras que el valor exacto es:
        \[
        f'(0) = 2.71828 \quad (\text{error muy grande}).
        \]
      \end{enumerate}
    \end{ejercicio}


\end{document}