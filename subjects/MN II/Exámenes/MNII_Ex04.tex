\documentclass[12pt]{article}

\input{../../_assets/preambulo.tex}


\begin{document}

    % 1. Foto de fondo
    % 2. Título
    % 3. Encabezado Izquierdo
    % 4. Color de fondo
    % 5. Coord x del titulo
    % 6. Coord y del titulo
    % 7. Fecha

    
    \input{../../_assets/portada}
    \portadaExamen{etsiitA4.jpg}{MN II\\Examen IV}{MN II. Examen IV}{MidnightBlue}{-8}{28}{2025}{}

    \begin{description}
        \item[Asignatura] Métodos Numéricos II.
        \item[Curso Académico] 2023/24.
        \item[Grado] Grado en Ingeniería Informática y Matemáticas.
        \item[Grupo] Único.
        \item[Profesor] Lidia Fernández Rodríguez.
        \item[Descripción] Segundo Parcial.
        \item[Fecha] 15 de Mayo de 2024.
        \item[Duración] 2 horas y 30 minutos.
        \item[Observaciones] Los ejercicios se encuentran resueltos, posiblemente en mayor detalle, en el documento de Relaciones. Se recomienda ver ambas soluciones.
    \end{description}
    \newpage


    % ------------------------------------
    
    \begin{ejercicio}[3 puntos]
        Se considera la fórmula de integración numérica
        \[
        \int_{-1}^{1} f(x)\,(1 - x^2)\,dx \;=\; \alpha_0\,f(x_0)\;+\;\alpha_1\,f(x_1)\;+\;R(f).
        \]
        \begin{enumerate}
          \item Determina los nodos y los coeficientes para que la fórmula anterior tenga grado de exactitud máximo. ¿Cuál es ese grado de exactitud? (1.5 puntos)
          \item Obtén la expresión del error de dicha fórmula. (1 puntos)
          \item Utiliza la fórmula anterior para estimar el valor de
          \[
            \int_{-1}^{1} \ln\bigl(x^2+1\bigr)\,(1 - x^2)\,dx. \quad \text{ (0.5 puntos)}
          \]
        \end{enumerate}
    \end{ejercicio}
        
    \begin{ejercicio}[3 puntos]
        Considera la fórmula de cuadratura de tipo interpolatorio
        \[
        \int_{a}^{\,a+h} f(x)\,dx \;=\; \frac{3h}{4}\,f(a)\;+\;\frac{h}{4}\,f(a+2h)\;+\;R(f).
        \]
        \begin{enumerate}
          \item Proporciona una expresión para el error de integración numérica asociado a la fórmula. (1 punto)
          \item Deduce la fórmula compuesta asociada a dicha fórmula, incluyendo una expresión del error. (1 punto)
          \item (1 punto) Deduce un método multipaso lineal para aproximar la solución del PVI 
        \begin{equation}\label{eq:pvi}
            \begin{cases}
              x' = f(t,x),\\
              x(t_0)=\mu.
            \end{cases}
        \end{equation}            
        \end{enumerate}
    \end{ejercicio}
        
    \begin{ejercicio}[2 puntos]
        Para resolver numéricamente el PVI (\ref{eq:pvi}) se propone el método de Runge–Kutta Radau dado por el arreglo de Butcher
        \[
        \begin{array}{c|cc}
        0   & 1/4 & -1/4 \\
        2/3 & 1/4 & 5/12 \\
        \hline
              & 1/4 & 3/4
        \end{array}
        \]
        Estudia la convergencia del método. \\ 
        Nota: No es necesario que compruebes que $\Phi$ es Lipschitziana. \\ 

        \begin{observacion}
            Se valora un punto el estudio de la consistencia, y otro el estudio de la estabilidad.
        \end{observacion}
    \end{ejercicio}

    \newpage
        
    \begin{ejercicio}[2 puntos]
        Para aproximar la solución del PVI (\ref{eq:pvi}) se considera el método multipaso
        \[
        x_{n+3} \;=\; x_n \;+\; h\bigl(\beta_2\,f_{n+2} + \beta_1\,f_{n+1}\bigr).
        \]
        \begin{enumerate}
          \item ¿Qué relaciones deben existir entre los parámetros $\beta_1$ y $\beta_2$ para que el método anterior sea convergente? Justifica tu respuesta. (0.5 puntos)
          \item Calcula los coeficientes $\beta_1$ y $\beta_2$ para que el orden de convergencia sea máximo. Indica el orden de convergencia y el término principal del error de truncatura local. (0.5 puntos)
          \item (1 punto) Se pretende aproximar $x(1)$, donde $x(t)$ es la solución del PVI
          \[
            \begin{cases}
              x' = x + t,\\
              x(0)=1.
            \end{cases}
          \]
          Para ello, tomando $h=1/4$, utiliza el método de Euler para obtener las condiciones iniciales que necesites. A continuación utiliza el método anterior hasta aproximar $x(1)$.
        \end{enumerate}
    \end{ejercicio}

    \newpage

    \setcounter{ejercicio}{0}

    \begin{ejercicio}[3 puntos]
        Se considera la fórmula de integración numérica
        \[
        \int_{-1}^{1} f(x)\,(1 - x^2)\,dx \;=\; \alpha_0\,f(x_0)\;+\;\alpha_1\,f(x_1)\;+\;R(f).
        \]
        \begin{enumerate}
          \item Determina los nodos y los coeficientes para que la fórmula anterior tenga grado de exactitud máximo. ¿Cuál es ese grado de exactitud? (1.5 puntos) \\
          
          Consideramos $\Pi(x) = (x-x_0)(x-x_1) = x^2+ax+b$. Ahora, para que esta fórmula simple sea gaussiana debe verificar que: 

          $$\int_{-1}^{1} \Pi(x)(1-x^2)dx = 0 \Longrightarrow \dfrac{x^3}{3} + a \cancelto{0}{\dfrac{x^2}{2}} + bx - \dfrac{x^5}{5} - a \cancelto{0}{\dfrac{x^4}{4}} - b \dfrac{x^3}{3} \bigg]_{-1}^{1} =$$
          $$\dfrac{2}{3} - \dfrac{2}{5} - b \dfrac{2}{3} + 2b = 0 \Longrightarrow \dfrac{4}{15} + \dfrac{4b}{3} = 0 \Longrightarrow \boxed{b = -\dfrac{1}{5}}$$

          $$\int_{-1}^{1} x \Pi(x)(1-x^2)dx = 0 \Longrightarrow \dfrac{x^4}{4} + a \dfrac{x^3}{3} + b \cancelto{0}{\dfrac{x^2}{2}} - \cancelto{0}{\dfrac{x^6}{6}} - a \dfrac{x^5}{5} - b \cancelto{0}{\dfrac{x^4}{4}} \bigg]_{-1}^{1} =$$
          $$a \dfrac{2}{3} - a \dfrac{2}{5} = 0 \Longrightarrow \boxed{a = 0}$$

          Así

          $$\Pi(x) = x^2+ax+b = x^2 - \dfrac{1}{5}$$

          con raíces:

          $$\Pi(x) = 0 \Longrightarrow x_0 = -\dfrac{1}{\sqrt{5}} = -\dfrac{\sqrt{5}}{5}, \quad x_1 = \dfrac{1}{\sqrt{5}} = \dfrac{\sqrt{5}}{5}$$

          Imponemos exactitud en $\{1,x\}$.

          \begin{itemize}
            \item $f(x) \equiv 1 \Longrightarrow \displaystyle\int_{-1}^{1} (1-x^2) dx = \alpha_0 + \alpha_1 \Longrightarrow \dfrac{4}{3} = \alpha_0 + \alpha_1$
            \item $f(x) \equiv x \Longrightarrow \displaystyle\int_{-1}^{1} x(1-x^2) dx = -\dfrac{\alpha_0}{\sqrt{5}} + \dfrac{\alpha_1}{\sqrt{5}}  \Longrightarrow 0 = -\dfrac{\alpha_0}{\sqrt{5}} + \dfrac{\alpha_1}{\sqrt{5}}$
          \end{itemize}

          de donde $\alpha_0 = \alpha_1 = \nicefrac{2}{3}$. Por tanto:

          $$\int_{-1}^{1} f(x) (1-x^2) dx \approx \dfrac{2}{3} f \left( -\dfrac{1}{\sqrt{5}} \right) + \dfrac{2}{3} f \left( \dfrac{1}{\sqrt{5}} \right)$$

          La fórmula tiene grado de exactitud $3$ por ser gaussiana.

          \item Obtén la expresión del error de dicha fórmula. (1 puntos) 
          
          Es una fórmula gaussiana, así que el error será:

          $$R(f) = \dfrac{f^{(iv)} (\chi)}{4!} \cdot \int_{-1}^{1} (1-x^2) dx = \dfrac{f^{(iv)} (\chi)}{4!} \cdot \dfrac{32}{525}$$

          $$R(f) = \dfrac{4}{1575} f^{(iv)}(\chi) \quad \chi \in ]-1,1[$$

          \begin{observacion}
            Es un error poner $R(f) = \displaystyle\int_{-1}^{1} f[x_0,x_1,x]dx$.
          \end{observacion}

          \item Utiliza la fórmula anterior para estimar el valor de
          \[
            \int_{-1}^{1} \ln\bigl(x^2+1\bigr)\,(1 - x^2)\,dx. \quad \text{ (0.5 puntos)}
          \]

          $$\int_{-1}^{1} \ln\bigl(x^2+1\bigr)\,(1 - x^2)\,dx \approx \dfrac{2}{3} \ln \left( \dfrac{6}{5} \right) + \dfrac{2}{3} \ln \left( \dfrac{6}{5} \right) = \dfrac{4}{3} \ln \left( \dfrac{6}{5} \right) = 0.243095$$

          \begin{observacion}
            El valor ``exacto'' es $0.224098$. 
          \end{observacion}
        \end{enumerate}
    \end{ejercicio}

    \newpage

    \begin{ejercicio}[3 puntos]
      Considera la fórmula de cuadratura de tipo interpolatorio
      \[
      \int_{a}^{\,a+h} f(x)\,dx \;=\; \frac{3h}{4}\,f(a)\;+\;\frac{h}{4}\,f(a+2h)\;+\;R(f).
      \]
      \begin{enumerate}
        \item Proporciona una expresión para el error de integración numérica asociado a la fórmula. (1 punto)
        
        $$R(f) = \int_a^{a+h} f[a, a+2h, x] (x-a) (x-(a+2h)) dx \stackrel{(*)}{=} f[a,a+2h, \chi] \int_{a}^{a+h} (x-a)(x-(a+2h)) dx = $$
        $$f[a,a+2h, \chi] \left[ \int_a^{a+h} (x-a)^2 dx + \int_a^{a+h} (-2h)(x-a) dx \right] = $$
        $$f[a,a+2h,\chi] \left( \dfrac{(x-a)^3}{3} \bigg]_a^{a+h} - 2h \dfrac{(x-a)^2}{2} \bigg]_a^{a+h}  \right) = $$
        $$\dfrac{f''(\mu)}{2} \left( \dfrac{h^3}{3} - h \cdot h^3 \right) = \dfrac{f''(\mu)}{6} (-2h^3) = - \dfrac{f''(\mu)}{3} h^3$$

        con $\chi \in ]a, a+2h[$ y $\mu \in ]a, a+h[$.

        \item Deduce la fórmula compuesta asociada a dicha fórmula, incluyendo una expresión del error. (1 punto) \\
        
        Consideramos una partición equiespaciada del intervalo $[a,b]$, donde $a = x_0 < x_1 < \cdots < x_n = b$, con $x_{i+1} = x_i + h$ y $h = \nicefrac{(b-a)}{n}$. Entonces, la fórmula compuesta será:
        $$\int_a^b f(x) dx = \sum_{i=0}^{n-1} \int_{x_i}^{x_{i+1}} f(x) dx = \sum_{i=0}^{n-1} \left( \dfrac{3h}{4} f(x_i) + \dfrac{h}{4} f(x_{i+2}) \right) + \overbrace{\sum_{i=0}^{n-1} \left( - \dfrac{f^{''}(\mu)}{3} \right) h^3}^{R(f)} = $$
        $$h \left( \dfrac{3}{4} f(a) + \dfrac{3}{4} f(a+h) + \dfrac{3}{4} \sum_{i=2}^{n-1} f(x_i) + \dfrac{1}{4} \sum_{i=2}^{n-1} f(x_i) \right) + R(f) = $$
        $$h \left( \dfrac{3}{4} f(a) + \dfrac{3}{4} f(a+h) + \sum_{i=2}^{n-1} f(x_i) + \dfrac{1}{4} f(b) + \dfrac{1}{4} f(b+h) \right) + R(f)$$

        donde 
        $$R(f) = - \dfrac{h^3 n}{3} \sum_{i=0}^{n-1} \dfrac{f^{''}(\mu)}{n} = - \dfrac{h^3 n}{3} f''(\tilde{\mu}) = - \dfrac{(b-a)^3 n}{n^3 \cdot 3} f^{''}(\tilde{\mu}) = - \dfrac{(b-a)^3}{3n^2} f^{''}(\tilde{\mu})$$

        \begin{observacion}
          Se resta $-0.3$ puntos si no se agrupa.
        \end{observacion}

        \newpage

        \item (1 punto) Deduce un método multipaso lineal para aproximar la solución del PVI 
        \begin{equation}
            \begin{cases}
              x' = f(t,x),\\
              x(t_0)=\mu.
            \end{cases}
        \end{equation}
        
        $$x_{n+1} - x_n \approx x(t_{n+1}) - x(t_n) = \int_{t_n}^{t_{n+1}} x'(t) dt = \int_{t_n}^{t_{n+1}} f(t,x(t)) dt \approx \dfrac{3h}{4} f(t_n,x_n) + \dfrac{h}{4} f(t_{n+2}, x_{n+2})$$

        Queda entonces

        $$x_{n+1} = x_n + h \left( \dfrac{3}{4} f_n + \dfrac{1}{4} f_{n+2} \right)$$

        Se puede hacer también con $h$ negativa:

        $$x_{n+1} - x_{n+2} \approx x(t_{n+1}) - x(t_{n+2}) = \int_{t_{n+2}}^{t_{n+1}} x'(t) dt = \int_{t_{n+2}}^{t_{n+1}} f(t,x(t)) dt \approx $$
        $$ \dfrac{3 (-h)}{4} f(t_{n+2},x_{n+2}) + \dfrac{(-h)}{4} f(\overbrace{t_{n+2} - 2h}^{t_n}, x_{n})$$

        de donde

        $$x_{n+2} \approx x_{n+1} + \dfrac{3h}{4} f_{n+2} + \dfrac{h}{4} f_n$$
      \end{enumerate}
    \end{ejercicio}

    \newpage

    \begin{ejercicio}[2 puntos]
      Para resolver numéricamente el PVI (\ref{eq:pvi}) se propone el método de Runge-Kutta Radau dado por el arreglo de Butcher
      \[
      \begin{array}{c|cc}
      0   & 1/4 & -1/4 \\
      2/3 & 1/4 & 5/12 \\
      \hline
            & 1/4 & 3/4
      \end{array}
      \]
      Estudia la convergencia del método. \\ 
      Nota: No es necesario que compruebes que $\Phi$ es Lipschitziana. \\ 

      \begin{observacion}
          Se valora un punto el estudio de la consistencia, y otro el estudio de la estabilidad. \\
      \end{observacion}

      Vemos en primer lugar que:

      $$x_{n+1} = x_n + h \left( \dfrac{1}{4} K_1 + \dfrac{3}{4} K_2 \right)$$
      con 
      $$K_1 = f \left(t, x + h \left( \dfrac{1}{4} K_1 - \dfrac{1}{4} K_2 \right) \right)$$
      $$K_2 = f \left(t + \dfrac{2}{3} h, x + h \left( \dfrac{1}{4} K_1 + \dfrac{5}{12} K_2 \right) \right)$$

      y 

      $$\Phi( ) = \dfrac{1}{4} K_1 + \dfrac{3}{4} K_2$$

      Estudiamos primero la consistencia:

      \begin{itemize}
        \item $p(\lambda) = \lambda - 1$, $p(1) = 0$.
        \item $\Phi(x(t_{n+1}), x(t_n); t_n, 0) = f(t_n, x(t_n))$. Para ver esto, observamos que si $h=0$, entonces $K_1 = K_2 = f(t,x)$, y entonces:
        
        $$\Phi(x(t_{n+1}), x(t_n); t_n, 0) = \dfrac{1}{4} f(t_n, x(t_n)) + \dfrac{3}{4} f(t_n, x(t_n)) = f(t_n, x(t_n))$$

        Por tanto es consistente. También se puede ver la consistencia sabiendo que $RK$ es consistente si y solo si $b_1 + \cdots + b_n = 1$, en este caso, $b_1 = \nicefrac{1}{4}$ y $b_2 = \nicefrac{3}{4}$, luego se cumple que $b_1 + b_2 = 1$, de tal
        manera que el método es consistente.
      \end{itemize}

      Vemos la estabilidad:

      \begin{itemize}
        \item Todas las raíces de $p(\lambda)$ están en el disco unidad y las de módulo $1$ son simples. Como $p(\lambda) = \lambda - 1$, solo tiene una raíz, $\lambda = 1$, que es simple. Por tanto, el método es estable.
      \end{itemize}

      Como el método es consistente y estable, es convergente. \\

      Faltaría ver que $\Phi$ es Lipschitziana, pero no es necesario comprobarlo para este ejercicio.
    \end{ejercicio}     

    \begin{ejercicio}[2 puntos]
      Para aproximar la solución del PVI (\ref{eq:pvi}) se considera el método multipaso
      \[
      x_{n+3} \;=\; x_n \;+\; h\bigl(\beta_2\,f_{n+2} + \beta_1\,f_{n+1}\bigr).
      \]
      \begin{enumerate}
        \item ¿Qué relaciones deben existir entre los parámetros $\beta_1$ y $\beta_2$ para que el método anterior sea convergente? Justifica tu respuesta. (0.5 puntos)
        
        Para que el método sea convergente, debe ser consistente y estable. 

        \begin{itemize}
          \item Estabilidad. Obtenemos el primer polinomio característico: $p(\lambda) = \lambda^3 - 1$, que tiene $3$ raíces distintas de módulo $1$, luego el método es estable.
          \item Consistencia. $\alpha_0 = 1$ y $\alpha_1 = \alpha_2 = 0$. Ahora, estudiamos $C_1$ y $C_2$:
          $$C_1 = 1 - \alpha_0 = 1 - 1 = 0$$
          $$C_2 = 3 - 0 \cdot \alpha_0 - \beta_2 - \beta_1 = 0$$

          obteniendo que la relación entre los parámetros $\beta_1$ y $\beta_2$ es:
          $$\beta_1 + \beta_2 = 3$$

          Por lo tanto, el método es convergente $\iff$ es estable y consistente $\iff \beta_1 + \beta_2 = 3$ 
        \end{itemize}

        \item Calcula los coeficientes $\beta_1$ y $\beta_2$ para que el orden de convergencia sea máximo. Indica el orden de convergencia y el término principal del error de truncatura local. (0.5 puntos)
        
        $$C_2 = \dfrac{3^2}{2} - \dfrac{0^2}{2} \alpha_0 - 2 \beta_2 - \beta_1 = 0$$

        $$\beta_1 + 2 \beta_2 = \dfrac{9}{2}$$
        $$3 - \beta_2 + 2\beta_2 = \dfrac{9}{2}$$
        $$\beta_2 = \dfrac{9}{2} - 3$$

        de donde

        $$\beta_1 = \dfrac{3}{2}$$
        $$\beta_2 = \dfrac{3}{2}$$

        Ahora

        $$C_3 = \dfrac{3^3}{3!} - \dfrac{2^2}{2} \beta_2 - \dfrac{1}{2} \beta_1 = \dfrac{9}{2} - 2 \dfrac{3}{2} - \dfrac{3}{4} = \dfrac{3}{4} \neq 0$$

        Y vemos que el orden de convergencia máximo es $2$, siempre que $\beta_1 = \beta_2 = \nicefrac{3}{2}$. \\

        El término principal del error de truncatura local es:

        $$\dfrac{3}{4} x^{'''}(\chi) h^3$$

        \item (1 punto) Se pretende aproximar $x(1)$, donde $x(t)$ es la solución del PVI
        \[
          \begin{cases}
            x' = x + t,\\
            x(0)=1.
          \end{cases}
        \]

        Para ello, tomando $h=1/4$, utiliza el método de Euler para obtener las condiciones iniciales que necesites. A continuación utiliza el método anterior hasta aproximar $x(1)$. \\

        Como el paso es $h = 1/4$, si partimos de $t_0 = 0$, podemos aproximar $x(1)$ con $n=4$ pasos, de tal forma que $x(1) \approx x_4$. Comenzamos a iterar, usando el método de Euler: $x_{n+1} = x_n + h f(t_n, x_n)$, con $f(t,x) = x+t$

        \begin{itemize}
          \item $x_0 = 1$
          \item $x_1 = x_0 + h f(t_0, x_0) = 1 + \frac{1}{4} (1 + 0) = 1.25$
          \item $x_2 = x_1 + h f(t_1, x_1) = 1.25 + \frac{1}{4} (1.25 + \frac{1}{4}) = 1.625$
        \end{itemize}

        Ahora, usamos que $x_{n+3} = x_n + h \left( \dfrac{3}{2} f_{n+1} + \dfrac{3}{2} f_{n+2}\right)$, luego:

        \begin{itemize}
          \item $x_3 = x_0 + h \left( \frac{3}{2} (x_{1} + t_1) + \frac{3}{2} (x_2 + t_2) \right) = 1 + \frac{1}{4} \left( \frac{3}{2} (1.25 + 0.25) + \frac{3}{2} (1.625 + 0.5) \right) = 2.35938$
          \item $x_4 = x_{1} + h \left( \frac{3}{2} (x_{2} + t_2) + \frac{3}{2} (x_{3} + t_3) \right) = 3.21289$
        \end{itemize}
        
        La solución exacta es (se puede obtener con un cambio de variable $u = x+t-1$ y factor integrante $e^{-t}$):

        $$x(t) = 2e^t - t - 1$$
        $$x(1) = 2e - 2 \approx 3.43656$$
      \end{enumerate}
    \end{ejercicio}
\end{document}