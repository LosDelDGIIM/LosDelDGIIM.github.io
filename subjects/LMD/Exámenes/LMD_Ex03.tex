\documentclass[12pt]{article}

\input{../../_assets/preambulo.tex}
% Define a custom command for email addresses
\newcommand{\email}[1]{\href{mailto:#1}{{{\color{blue}#1}}}}

\fancyhead[L]{\helv \nouppercase{\leftmark}}
\fancyhead[R]{\helv \nouppercase{\rightmark}}


% Comando para \bf en vez de \mathbf
\renewcommand{\bf}[1]{\mathbf{#1}}

% Operador matemático para \Con
\DeclareMathOperator{\Con}{Con}

% Operador matemático para los átomos
\DeclareMathOperator{\Atm}{Atm}

% Operador matemático para el cardinal
\DeclareMathOperator{\Car}{Car}

% Comando para \mcd y \mcm
\DeclareMathOperator{\mcd}{mcd}
\DeclareMathOperator{\mcm}{mcm}

% Comando para \dom
\DeclareMathOperator{\dom}{dom}


% Paquete para mapas de Karnaugh
\usepackage{karnaugh-map}

% Tachar filas
\usetikzlibrary{tikzmark}

\usepackage{forest}


\begin{document}

     % 1. Foto de fondo
    % 2. Título
    % 3. Encabezado Izquierdo
    % 4. Color de fondo
    % 5. Coord x del titulo
    % 6. Coord y del titulo
    % 7. Fecha

    
    \input{../../_assets/portada}
    \portadaExamen{etsiitA4.jpg}{LMD\\Examen III}{Lógica y Métodos Discretos. Examen III}{MidnightBlue}{-8}{28}{2023-2024}{Antonio Romero Martín\\Carolina González Ríos\\Daniel Gómez García\\Arturo Olivares Martos}

    \begin{description}
        \item[Asignatura] Lógica y Métodos Discretos.
        \item[Curso Académico] 2023-24.
        \item[Grado] Doble Grado en Ingienería Informática y Matemáticas.
        \item[Grupo] Único.
        \item[Profesor] Francisco Miguel García Olmedo.
        \item[Descripción] Convocatoria ordinaria.
        \item[Fecha] 14 de junio de 2024.
        \item[Observaciones] El examen se hacía por grupos de 3/4 personas. La entrega se abrió en Prado a las 13:00 y se cerró a las 21:30.
        Tan solo se pedía entregar 5 ejercicios de los 6 propuestos.
    
    \end{description}
    \newpage
    
    \begin{ejercicio}
        Sea la relación de recurrencia que para todo número natural $n$ proporcione
        el número exacto $a_n$ de cadenas de bits de longitud $n$ que contenga al menos un par de ceros
        consecutivos. Responda a las siguientes cuestiones:
        \begin{enumerate}
            \item Encuentre razonadamente la relación de recurrencia descrita.
            
            Fijado $n\in \omega$, con $n\geq 2$, veremos cuantas cadenas de longitud $n$ que contienen al menos un par de ceros consecutivos hay, que será $a_n$.
            Distinguimos dos casos:
            \begin{itemize}
                \item Si la cadena termina en $1$, habrá tantas como cadenas de longitud $n-1$ que contienen al menos un par de ceros consecutivos,
                es decir, $a_{n-1}$.

                \item Si la cadena termina en $0$, volvemos a distinguir dos subcasos:
                \begin{itemize}
                    \item Si el penúltimo bit es $1$, entonces habrá tantas cadenas como cadenas de longitud $n-2$ que contienen al menos un par de ceros consecutivos,
                    es decir, $a_{n-2}$.

                    \item Si el penúltimo bit es $0$, entonces la cadena ya contiene un par de ceros consecutivos, por lo que en los $n-2$ bits restantes
                    puedes elegir cualquier combinación de bits, por lo que puedes formar $2^{n-2}$ cadenas de longitud $n$.
                \end{itemize}
            \end{itemize}

            Por tanto, la relación de recurrencia para $a_n$ es:
            \begin{equation*}
                a_n = a_{n-1} + a_{n-2} + 2^{n-2} \qquad \forall n\in \omega, \quad n\geq 2
            \end{equation*}


            \item Dé razonadamente las condiciones iniciales que definirán el problema de recurrencia.
            
            Como la recurrencia obtenida es de orden $k=2$, necesitamos dos condiciones iniciales para definir el problema de recurrencia,
            sean estas $a_0$ y $a_1$.
            \begin{itemize}
                \item $a_0$ es el número de cadenas de longitud $0$ que contienen al menos un par de ceros consecutivos,
                que trivialmente es $a_0=0$.

                \item $a_1$ es el número de cadenas de longitud $1$ que contienen al menos un par de ceros consecutivos,
                que de nuevo trivialmente es $a_1=0$.
            \end{itemize}

            Por tanto, las condiciones iniciales que definen el problema de recurrencia son:
            \begin{equation*}
                a_0 = 0, \qquad a_1 = 0
            \end{equation*}            

            
            \item Calcule razonadamente $a_{500}$.
            
            Para el cálculo de $a_{500}$ sin tener que resolver dicha recurrencia, vamos a proponer una forma alternativa de calcularlo.
            Buscamos una relación de recurrencia para $a_n$, el número de cadenas de bits de longitud $n$ que contienen al menos un par de ceros consecutivos,
            vamos a dividir el problema en dos casos que son complementarios para los que usaremos el enfoque de recurrencia.
            Denotamos entonces por:
            \begin{itemize}
                \item $a_n$ al número de cadenas de bits de longitud $n$ que contienen al menos un par de ceros consecutivos.
                \item $b_n$ al número de cadenas de bits de longitud $n$ que no contienen ningún par de ceros consecutivos.
            \end{itemize}

            En primer lugar, observamos que la cantidad total de cadenas de bits de longitud $n$ es $2^n$, ya que cada bit puede ser $0$ ó $1$. Entonces,
            la relación entre $a_n$ y $b_n$ viene dada por:
            \begin{equation*}
                a_n + b_n = 2^n \qquad \forall n\in \omega
            \end{equation*}
            
            Lo que haremos será entonces encontrar una relación de recurrencia para $b_n$.
            Fijado $n\in \omega$, con $n\geq 2$, veremos cuántas cadenas de longitud $n$ que no contienen ningún par de ceros consecutivos hay, que será $b_n$.
            \begin{itemize}
                \item Si la cadena termina en $1$, entonces el número de cadenas de longitud $n-1$ que no contienen ningún par de ceros consecutivos
                es $b_{n-1}$.
                
                \item Si la cadena termina en $0$, el penúltimo bit debe ser $1$ para que no haya un par de ceros consecutivos, por lo que la subcadena de longitud $n-2$
                restante también debe no tener ningún par de ceros consecutivos, de donde el número de cadenas de longitud $n-2$ que no contienen ningún par de ceros consecutivos
                es $b_{n-2}$.
            \end{itemize}

            Por tanto, podemos escribir la relación de recurrencia para $b_n$ como:
            \begin{equation*}
                b_n = b_{n-1} + b_{n-2} \qquad \forall n\in \omega, \quad n\geq 2
            \end{equation*}
            con las condiciones iniciales siguientes:
            \begin{itemize}
                \item $b_0 = 1$, ya que la única cadena de longitud $0$ es la cadena vacía, que no contiene ningún par de ceros consecutivos.
                \item $b_1 = 2$, ya que las cadenas de longitud $1$ son $0$ y $1$, y ninguna de ellas contiene ningún par de ceros consecutivos.
            \end{itemize}

            Nos damos cuenta de que esta sucesión es la conocida sucesión de Fibonacci desplazada dos términos; es decir, $b_n = F_{n+2}$, donde $F_n$ es el $n-$ésimo término de la sucesión de Fibonacci.
            Por tanto, $a_n$ tenemos que es:
            \begin{equation*}
                a_n = 2^n - F_{n+2} \qquad \forall n\in \omega
            \end{equation*}
            
            Para calcular $a_{500}$, usamos el resultado obtenido:
            \begin{equation*}
                a_{500} = 2^{500} - F_{502}
            \end{equation*}

            Por la relación entre la sucesión de Fibonacci y los números combinatorios, sabemos que:
            \begin{equation*}
                a_{500} = 2^{500} - \sum_{i=0}^{250} \binom{501-i}{i}
            \end{equation*}

            Obtenemos dicho valor usando el siguiente programa de Python:
            \begin{listing}[H]
                \begin{minted}{python}
                        from math import comb

                        sum = 0
                        for i in range(251):
                            sum += comb(501 - i, i) 

                        print((2 ** 500) - sum)
                \end{minted}
            \end{listing}

            Mediante dicho programa, calculamos el valor de $a_{500}$:
            \begin{align*}
                a_{500} =~ &32733906078961418700131896968275991522166\\&\quad 42045678050048759657157083896718498195198887188510\\&\qquad 824448659298138854760759871647667082449311747124309037796625
            \end{align*}
        \end{enumerate}
    \end{ejercicio}


    \begin{ejercicio}
        Para cualquier conjunto $\Gamma \cup \{\alpha,\beta,\gamma\}$ de fórmulas proposicionales, considere la igualdad:
        \begin{equation*}
            \Con(\Gamma, \alpha\rightarrow \left(\beta\rightarrow \left(\alpha\rightarrow \gamma\right)\right))
            = \Con(\Gamma, \left(\beta\rightarrow\alpha\right)\rightarrow\left(\beta\rightarrow\gamma\right))
        \end{equation*}
        Si es cierta, dé una demostración y de no serlo, demuéstrelo con un contraejemplo.\\

        Notemos por $\varphi_1=\alpha\rightarrow \left(\beta\rightarrow \left(\alpha\rightarrow \gamma\right)\right)$ y $\varphi_2=\left(\beta\rightarrow\alpha\right)\rightarrow\left(\beta\rightarrow\gamma\right)$.
        Sea $v$ una valuación fija pero arbitraria. Tenemos que:
        \begin{align*}
            v(\varphi_1) &= v(\alpha\rightarrow \left(\beta\rightarrow \left(\alpha\rightarrow \gamma\right)\right)) \\
            &= v(\alpha)v(\beta\rightarrow \left(\alpha\rightarrow \gamma\right)) + v(\alpha) + 1 \\
            &= v(\alpha)[v(\beta)v(\alpha\rightarrow \gamma) + v(\beta) + 1] + v(\alpha) + 1 \\ 
            &= v(\alpha)[v(\beta)(v(\alpha)v(\gamma)+v(\alpha)+1) + v(\beta) + 1] + v(\alpha) + 1 \\
            &= v(\alpha)^2v(\beta)v(\gamma) + v(\alpha)^2v(\beta) + \bcancel{v(\alpha)v(\beta)} + \bcancel{v(\alpha)v(\beta)} +\cancel{v(\alpha)}+ \cancel{v(\alpha)} + 1 \\
            &= v(\alpha)v(\beta)v(\gamma) + v(\alpha)v(\beta) +  1 \\ \\
            v(\varphi_2) &= v(\left(\beta\rightarrow\alpha\right)\rightarrow\left(\beta\rightarrow\gamma\right)) \\
            &= v(\beta\rightarrow\alpha)v(\beta\rightarrow\gamma) + v(\beta\rightarrow\alpha) + 1 \\
            &= (v(\beta)v(\alpha) + v(\beta) + 1)(v(\beta)v(\gamma) + v(\beta) + 1) + v(\beta)v(\alpha) + v(\beta) + 1+1 \\
            &= v(\beta)^2v(\alpha)v(\gamma) + v(\beta)^2v(\alpha) + \cancel{v(\beta)v(\alpha)} + v(\beta)^2v(\gamma) + v(\beta)^2+\\& \hspace{2cm} + \bcancel{v(\beta)} + v(\beta)v(\gamma) + \bcancel{v(\beta)} + \cancel{1} + \cancel{v(\beta)v(\alpha)} + v(\beta) + \cancel{1}+1 \\
            &= v(\beta)v(\alpha)v(\gamma) + v(\beta)v(\alpha) + 1
        \end{align*}

        Por tanto, tenemos que $v(\varphi_1)=v(\varphi_2)$ para cualquier valuación $v$, de donde se sigue que $\varphi_1\leftrightarrow\varphi_2$, por lo que $\varphi_1=\varphi_2$. Por el 
        apartado 6 del Teorema 3.3.2., tenemos que:
        \begin{equation*}
            \Con(\Gamma, \varphi_1) = \Con(\Gamma, \varphi_2)
        \end{equation*}
        como queríamos demostrar.
    \end{ejercicio}

    \begin{ejercicio}
        Demuestre que para todo conjunto de fórmulas proposicionales $\Gamma$ se cumple la igualdad:
        \begin{equation*}
            \Con(\Gamma) = \bigcup_{\substack{\Gamma_f\subseteq \Gamma\\\Gamma_f \text{ finito}}} \Con\left(\Gamma_f\right)
        \end{equation*}

        \begin{proof}
            Demostraremos mediante doble inclusión:
            \begin{description}
                \item[$\supseteq)$] Demostraremos en primer lugar que $\displaystyle\bigcup\limits_{\substack{\Gamma_f\subseteq \Gamma\\\Gamma_f \text{ finito}}} \Con\left(\Gamma_f\right)\subseteq \Con(\Gamma)$.
                
                En virtud del Teorema 3.3.1 de los apuntes, si $\Gamma_f\subseteq \Gamma$ se tiene que
                $\Con(\Gamma_f)\subseteq~\Con(\Gamma)$. Deducimos entonces que:
                \begin{equation*}
                    \bigcup_{\substack{\Gamma_f\subseteq \Gamma\\\Gamma_f \text{ finito}}} \Con\left(\Gamma_f\right)\subseteq \Con(\Gamma)
                \end{equation*}
                como queríamos demostrar.


                \item[$\subseteq)$] Demostraremos ahora que $\Con(\Gamma)\subseteq \displaystyle\bigcup\limits_{\substack{\Gamma_f\subseteq \Gamma\\\Gamma_f \text{ finito}}} \Con\left(\Gamma_f\right)$.
                
                Para ello, bastará tomar una fórmula $\gamma\in \Con(\Gamma)$ y ver que $\displaystyle \gamma\in\bigcup_{\substack{\Gamma_f\subseteq \Gamma\\\Gamma_f \text{ finito}}} \Con\left(\Gamma_f\right)$.
                Esto último, a su vez, equivale a ver que $\gamma\in \Con(\Gamma_f)$ para algún $\Gamma_f\subseteq \Gamma$ finito.
                De nuevo, esto equivale a demostrar que $\Gamma_f\models \gamma$ para cierto $\Gamma_f\subseteq \Gamma$ finito;
                que a su vez equivale a demostrar que $\Gamma_f\cup\{\lnot \gamma\}$ para cierto $\Gamma_f\subseteq \Gamma$ finito es insatisfacible.

                Para esto último, demostraremos el siguiente lema, que es una de las implicaciones del Teorema de Compacidad:
                \begin{lema}
                    Sea $\Gamma$ un conjunto de fórmulas proposicionales.
                    Entonces, se tiene lo siguiente:
                    \begin{center}
                        Si cualquier $\Gamma_f\subseteq \Gamma$ finito es satisfacible, entonces $\Gamma$ es satisfacible.
                    \end{center}
                    \begin{proof}
                        Para demostrar este lema, introducimos en primer lugar algo de notación.\\
                        
                        Notamos $P=\{p_n\mid n\in \omega\}$ el conjunto de todas las variables proposicionales. Además,
                        en lo que sigue entenderemos que para $n\in \omega$, $p_n$ es el $n-$ésimo símbolo de variable proposicional
                        numerado en $P$ (donde estamos haciendo uso de que el conjunto de símbolos de variables proposicionales es numerable).\\
                        
                        Llamamos asignación parcial a toda función $\cc{A}:D\to \{0,1\}$, donde o bien se tiene que $D=P$ ó $D=\{p_i\mid i\in n\}\subseteq P$ para algún $n\in \omega$
                        (notemos que $D$ es finito en este último caso, llegando incluso a poder ser vacío).
                        Por ser $D$ el dominio de $\cc{A}$, notaremos $D$ por $\dom(\cc{A})$.\\

                        Dadas dos asignaciones parciales $\cc{A}$ y $\cc{A}'$, diremos que $\cc{A}'$ extiende a $\cc{A}$ si $\dom(\cc{A})\subseteq \dom(\cc{A}')$ y $\cc{A}(p)=\cc{A}'(p)$ para todo $p\in \dom(\cc{A})$.\\

                        Decimos que una asignación parcial $\cc{A}$ es \emph{buena} si satisface cualquier fórmula $\varphi\in \Gamma$ que solo contenga símbolos de variable proposicional de $\dom(\cc{A})$ en su expresión.\\

                        Observamos que para cada $n\in \omega$ hay una asignación parcial $\cc{A}$ tal que su dominio es $\dom(\cc{A})=\{p_i\mid i\in n\}$ que es buena.
                        Para ello, \ul{fijado $n\in \omega$}, consideramos el subconjunto $\Gamma'\subseteq \Gamma$ de fórmulas que solo contienen símbolos de variable proposicional de $\{p_i\mid i\in n\}$ en su expresión.
                        Si bien $\Gamma'$ podría ser infinito, sabemos que el conjunto cociente $\Gamma'/=$ tiene a lo sumo $2^{(2^n)}$ elementos, luego en particular es finito.
                        Para cada clase de equivalencia, escogemos un representante de clase y consideramos $\Gamma''$ el conjunto formado por dichos representantes.

                        Por hipótesis, $\Gamma''$ es satisfacible por ser subconjunto finito de $\Gamma$, luego cualquier fórmula proposicional de $\Gamma'$ es satisfacible para 
                        cierta asignación parcial $\cc{A}$ con $\dom(\cc{A})=\{p_i\mid i\in n\}$, que por definición es buena.\\

                        Nuestro objetivo ahora será construir $\{\cc{A}_n\}_{n\geq 0}$ sucesión de asignaciones parciales buenas tal que para cada $n\in \omega$ se tenga que:
                        \begin{center}
                            ``Hay infinitas asignaciones parciales buenas que extienden a $\cc{A}_n$''.
                        \end{center}
                        
                        Esta sucesión la definiremos de la siguiente manera:
                        \begin{itemize}
                            \item \ul{Para $n=0$}:
                            
                            En el caso de $n=0$, $\cc{A}_0$ tiene dominio vacío ($\dom(\cc{A}_0)=\emptyset$).
                            Puesto que habíamos demostrado que para cada $n\in \omega$ hay una asignación parcial buena con $\dom(\cc{A})=\{p_i\mid i\in n\}$,
                            y trivialmente cada una de ellas extiende a $\cc{A}_0$, tenemos que hay infinitas asignaciones parciales buenas que extienden a $\cc{A}_0$ (tantas como elementos en $\omega$).
                            Por tanto, hemos construido el primer elemento de nuestra sucesión, $\cc{A}_0$.

                            \item \ul{Construido para $n$, construimos para $n+1$}:
                            
                            Supongamos que hemos construido $\cc{A}_n$ con las hipótesis anteriormente descritas.
                            Consideramos $\cc{B}$ y $\cc{B}'$ las dos únicas asignaciones parciales con $\dom(\cc{B})=\dom(\cc{B}')=\{p_i\mid i\in n^+\}\subseteq P$
                            que extienden a $\cc{A}_n$ siendo $\cc{B}(p_{n+1})=0$ y $\cc{B}'(p_{n+1})=1$.

                            Puesto que cualquier asignación parcial buena que extiende a $\cc{A}_n$ extiende a su vez a $\cc{B}$ o a $\cc{B}'$, deducimos que $\cc{B}$ o $\cc{B}'$ tiene infinitas asignaciones parciales buenas que la extienden.
                            Por tanto, tomamos $\cc{A}_{n+1}=\cc{B}$ en caso de que $\cc{B}$ tenga infinitas asignaciones parciales buenas que la extienden, y $\cc{A}_{n+1}=\cc{B}'$ en caso contrario.
                            Tenemos por tanto construido $\cc{A}_{n+1}$ con las propiedades deseadas.
                        \end{itemize}

                        Construida esta sucesión, definimos la asignación $\cc{A}$ como sigue:
                        \begin{equation*}
                            A(p_n) = A_n(p_n), \qquad \forall n\in \omega
                        \end{equation*}
                        
                        Para cualquier fórmula $\varphi\in \Gamma$ que sólo contenga símbolos de variable proposicional contenidos en $\{p_0, p_1, \dots, p_n\}$ en su expresión,
                        sabemos por construcción que $\cc{A}_n$ satisface $\varphi$. Por tanto, $\cc{A}$ también satisface a $\varphi$,
                        pues por definición $\cc{A}$ extiende a $\cc{A}_n$.
                    \end{proof}
                \end{lema}

                Una vez demostrado el lema, por el contrarecíproco del mismo, si $\Gamma$ es insatisfacible, entonces existe un subconjunto finito $\Gamma_f\subseteq \Gamma$ tal que $\Gamma_f$ es insatisfacible, tal y como queríamos demostrar.
            \end{description}
        \end{proof}
    \end{ejercicio}

    \begin{ejercicio}
        Considere la función booleana dada como sigue:
        \begin{equation*}
            f(a, b, c, d) = \sum m(0, 1, 4, 5, 6, 7, 9, 11, 15) + \sum d(10, 14)
        \end{equation*}
        Para este ejercicio empleará exclusivamente el algoritmo de Quine-McCluskey y razonará, escueta
        pero suficientemente, los pasos en la aplicación de dicho algoritmo. A continuación, se le pide:
        \begin{enumerate}
            \item Dé razonadamente una expresión minimal de la función a condición de ser~SOP.
            
            Usaremos el algoritmo de Quine-McCluskey. Generamos los implicantes primos:
                \begin{table}[H]
                    \centering
                    \begin{tabular}{rcc|rcc|rcc}
                        \multicolumn{3}{c}{Columna 1} & \multicolumn{3}{|c|}{Columna 2} & \multicolumn{3}{c}{Columna 3} \\ \hline
                        0 & 0000 & \checkmark & \{0,1\} & 000\_ & \checkmark & \{0,1,4,5\} & 0\_0\_ & $\ast$
                        \\ \cline{1-3} \cline{7-9}
                        1 & 0001 & \checkmark & \{0,4\} & 0\_00 & \checkmark & \{4,5,6,7\} & 01\_\_ & $\ast$
                        \\ \cline{4-6} \cline{7-9}
                        4 & 0100 & \checkmark & \{1,5\} & 0\_01 & \checkmark & \{6,7,14,15\} & \_11\_ & $\ast$
                        \\ \cline{1-3}
                        5 & 0101 & \checkmark & \{1,9\} & \_001 & $\ast$ & \{10,11,14,15\} & 1\_1\_ & $\ast$
                        \\ \cline{7-9}
                        6 & 0110 & \checkmark & \{4,5\} & 010\_ & \checkmark
                        \\
                        9 & 1001 & \checkmark & \{4,6\} & 01\_0 & \checkmark
                        \\ \cline{4-6}
                        10 & 1010 & \checkmark & \{5,7\} & 01\_1 & \checkmark
                        \\ \cline{1-3}
                        7 & 0111 & \checkmark & \{6,7\} & 011\_ & \checkmark
                        \\
                        11 & 1011 & \checkmark & \{6,14\} & \_110 & \checkmark
                        \\
                        14 & 1110 & \checkmark & \{9,11\} & 10\_1 & $\ast$
                        \\ \cline{1-3}
                        15 & 1111 & \checkmark & \{10,11\} & 101\_ & \checkmark
                        \\ \cline{1-3}
                        &&& \{10,14\} & 1\_10 & \checkmark
                        \\ \cline{4-6}
                        &&& \{7,15\} & \_111 & \checkmark
                        \\
                        &&& \{11,15\} & 1\_11 & \checkmark
                        \\
                        &&& \{14,15\} & 111\_ & \checkmark
                        \\ \cline{4-6} 
                    \end{tabular}
                \end{table}

                Los implicantes primos son, por tanto, los que se han marcado con $\ast$. Reducimos la tabla de implicantes primos
                usando la cuadrícula de McCluskey:
                \begin{table}[H]
                    \centering
                    \begin{tabular}{c|ll|ccccccccc}
                        && & 0 & \tikzmark{EjExCol1Start}1 & \tikzmark{EjExCol4Start}4 & \tikzmark{EjExCol5Start}5 & 6 & 7 & 9 & 11 & \tikzmark{EjExCol15Start}15 \\ \hline
                        & \{1,9\} & \_001 & & $\circ$ & & & & & $\circ$ & & \\
                        & \{9,11\} & 1\_1\_ & & & & & & & $\circ$ & $\circ$ & \\
                        {\color{red}$\ast$}& \{0,1,4,5\} & 0\_0\_ & \tikzmark{EjExFil3Start}$\circ$ & $\circ$ & $\circ$ & $\circ$ & & & & &\tikzmark{EjExFil3End} \\
                        & \{4,5,6,7\} & 01\_\_ &\tikzmark{EjExFil4Start} & & $\circ$ & $\circ$ & $\circ$ & $\circ$ & & & \tikzmark{EjExFil4End}\\
                        & \{6,7,14,15\} & \_11\_ &\tikzmark{EjExFil5Start} & & & & $\circ$ & $\circ$ & & & $\circ$\tikzmark{EjExFil5End} \\
                        & \{10,11,14,15\} & 1\_11 & &\tikzmark{EjExCol1End} &\tikzmark{EjExCol4End} &\tikzmark{EjExCol5End} & & & & $\circ$ & \tikzmark{EjExCol15End}$\circ$ \\
                    \end{tabular}
                    \tikz[remember picture] \draw[overlay, red] ([yshift=0.25em]pic cs:EjExFil3Start) -- ([yshift=0.25em]pic cs:EjExFil3End);
                    \tikz[remember picture] \draw[overlay, red] ([xshift=0.25em]pic cs:EjExCol1Start) -- (pic cs:EjExCol1End);
                    \tikz[remember picture] \draw[overlay, red] ([xshift=0.25em]pic cs:EjExCol4Start) -- (pic cs:EjExCol4End);
                    \tikz[remember picture] \draw[overlay, red] ([xshift=0.25em]pic cs:EjExCol5Start) -- (pic cs:EjExCol5End);
                \end{table}
                donde hemos indicado con ${\color{red}\ast}$ que el implicante \{0,1,4,5\} es esencial, ya que es el único
                que cubre el minterm $0$. Además, la columna asociada a cada minterm cubierto por este implicante se descarta,
                puesto que ya está cubierta. Esto lo hemos indicado con una línea roja. La tabla reducida es:
                \begin{table}[H]
                    \centering
                    \begin{tabular}{c|ll|ccccc}
                        && & 6 & 7 & 9 & 11 & \tikzmark{EjExCol15Start}15 \\ \hline
                        & \{1,9\} & \_001 & & & $\circ$ & & \\
                        & \{9,11\} & 1\_1\_ & & & $\circ$ & $\circ$ & \\
                        & \{4,5,6,7\} & 01\_\_ &\tikzmark{EjExFil4Start} $\circ$ & $\circ$ & & & \tikzmark{EjExFil4End}\\
                        {\color{purple}$\ast\ast$}& \{6,7,14,15\} & \_11\_ &\tikzmark{EjExFil5Start} $\circ$ & $\circ$ & & & $\circ$\tikzmark{EjExFil5End} \\
                        & \{10,11,14,15\} & 1\_11 & & & & $\circ$ & \tikzmark{EjExCol15End}$\circ$ \\
                    \end{tabular}
                    \tikz[remember picture] \draw[overlay, blue] ([yshift=0.25em]pic cs:EjExFil4Start) -- ([yshift=0.25em]pic cs:EjExFil4End);
                    \tikz[remember picture] \draw[overlay, purple] ([yshift=0.25em]pic cs:EjExFil5Start) -- ([yshift=0.25em]pic cs:EjExFil5End);
                    \tikz[remember picture] \draw[overlay, purple] ([xshift=0.5em]pic cs:EjExCol15Start) -- ([xshift=0.25em]pic cs:EjExCol15End);
                \end{table}
                donde, en primer lugar, la fila del implicante primo \{6,7,14,15\} domina a la del \{4,5,6,7\}, por lo que se descarta esta última (indicado en azul).
                Una vez hecho esto, vemos que el minterm $6$ tan solo está cubierto por el implicante primo \{6,7,14,15\}, por lo que este es esencial (indicado con {\color{purple}$\ast\ast$}).
                Además, las columnas asociadas a los minterms cubiertos por este implicante se descartan, ya que ya están cubiertas (indicado tachando dichas columnas en morado). La tabla reducida es:
                \begin{table}[H]
                    \centering
                    \begin{tabular}{c|ll|cc}
                        && & 9 & 11 \\ \hline
                        & \{1,9\} & \_001 &\tikzmark{EjExFil1Start} $\circ$ &\tikzmark{EjExFil1End} \\
                        {\color{teal}$\ast\ast\ast$}& \{9,11\} & 1\_1\_ & $\circ$ & $\circ$ \\
                        & \{10,11,14,15\} & 1\_11 &\tikzmark{EjExFil6Start} &$\circ$\tikzmark{EjExFil6End} \\
                    \end{tabular}
                    \tikz[remember picture] \draw[overlay, orange] ([yshift=0.25em]pic cs:EjExFil1Start) -- ([yshift=0.25em]pic cs:EjExFil1End);
                    \tikz[remember picture] \draw[overlay, orange] ([yshift=0.25em]pic cs:EjExFil6Start) -- ([yshift=0.25em]pic cs:EjExFil6End);
                \end{table}
                donde, en primer lugar, la fila del implicante primo \{9,11\} domina a las otras dos, por lo que se descartan estas dos últimas (indicado en naranja).
                Una vez hecho esto, vemos que el minterm $9$ tan solo está cubierto por el implicante primo \{9,11\}, por lo que este es esencial (indicado con {\color{teal}$\ast\ast\ast$}).\\

                Por tanto, los implicantes primos esenciales son los siguientes:
                \begin{table}[H]
                    \centering
                    \begin{tabular}{|c|c|c|}
                        \hline
                        Implicante & Patrón & Producto \\ \hline
                        \{0,1,4,5\} & 0\_0\_ & $\ol{a}~\ol{c}$ \\
                        \{6,7,14,15\} & \_11\_ & $b~c$  \\
                        \{9,11\} & 10\_1 & $a~\ol{b}~d$ \\ \hline
                    \end{tabular}
                \end{table}

                Por tanto, una vez aplicado el algoritmo de Quine-McCluskey, la expresión minimal de la función a condición de ser~SOP es:
                \begin{equation*}
                    f(a, b, c, d) = \ol{a}~\ol{c} + b~c + a~\ol{b}~d
                \end{equation*}

            \item Dé razonadamente una expresión minimal de la función a condición de ser~POS.
            
            En primer lugar, hemos de obtener la expresión de $f$ como producto de maxtérminos. Esta es:
            \begin{equation*}
                f(a, b, c, d) = \prod M(2, 3, 8, 12, 13) \cdot \prod d(10, 14)
            \end{equation*}

            Usaremos el algoritmo de Quine-McCluskey. Generamos los implicantes primos:
            \begin{table}[H]
                \centering
                \begin{tabular}{rcc|rcc|rcc}
                    \multicolumn{3}{c}{Columna 1} & \multicolumn{3}{|c|}{Columna 2} & \multicolumn{3}{c}{Columna 3} \\ \hline
                    2 & 0010 & \checkmark & \{2,3\} & 001\_ & $\ast$ & \{8,10,12,14\} & 1\_\_0 & $\ast$
                    \\ \cline{7-9}
                    8 & 1000 & \checkmark & \{2,10\} & \_010 & $\ast$ &
                    \\ \cline{1-3}
                    3 & 0011 & \checkmark & \{8,10\} & 10\_0 & \checkmark &
                    \\
                    10 & 1010 & \checkmark & \{8,12\} & 1\_00 & \checkmark &
                    \\ \cline{4-6}
                    12 & 1100 & \checkmark & \{10,14\} & 1\_10 & \checkmark &
                    \\ \cline{1-3}
                    13 & 1101 & \checkmark & \{12,13\} & 110\_ & $\ast$ &
                    \\
                    14 & 1110 & \checkmark & \{12,14\} & 11\_0 & \checkmark &
                    \\ \cline{1-3} \cline{4-6}
                \end{tabular}
            \end{table}

            Los implicantes primos son, por tanto, los que se han marcado con $\ast$. Reducimos la tabla de implicantes primos
            usando la cuadrícula de McCluskey:
            \begin{table}[H]
                \centering
                \begin{tabular}{c|ll|ccccc}
                    && & \tikzmark{ExCol2Start}2 & 3 & 8 & 12 & 13 \\ \hline
                    {\color{red}$\ast$}& \{2,3\} & 001\_ & $\circ$\tikzmark{ExFil1Start} & $\circ$ & & & \tikzmark{ExFil1End} \\
                    & \{2,10\} & \_010 & $\circ$ & & & & \\
                    {\color{blue}$\ast$}& \{12,13\} & 110\_ &\tikzmark{ExFil3Start} & & & $\circ$ & $\circ$ \tikzmark{ExFil3End} \\
                    {\color{purple}$\ast$}& \{8,10,12,14\} & 1\_\_0 &\tikzmark{ExFil4Start}\tikzmark{ExCol2End} & & $\circ$ & $\circ$ & \tikzmark{ExFil4End} \\
                \end{tabular}
                \tikz[remember picture] \draw[overlay, red] ([yshift=0.25em]pic cs:ExFil1Start) -- ([yshift=0.25em]pic cs:ExFil1End);
                \tikz[remember picture] \draw[overlay, red] ([xshift=0.25em]pic cs:ExCol2Start) -- (pic cs:ExCol2End);
                \tikz[remember picture] \draw[overlay, blue] ([yshift=0.25em]pic cs:ExFil3Start) -- ([yshift=0.25em]pic cs:ExFil3End);
                \tikz[remember picture] \draw[overlay, purple] ([yshift=0.25em]pic cs:ExFil4Start) -- ([yshift=0.25em]pic cs:ExFil4End);
            \end{table}
            donde hemos indicado con ${\color{red}\ast}$ que el implicante \{2,3\} es esencial, ya que es el único
            que cubre el maxtérmino $3$. Además, la fila asociada a cada maxtérmino cubierto por este implicante se descarta,
            puesto que ya está cubierta. Esto lo hemos indicado con una línea vertical roja.
            Asímismo, hemos indicado con ${\color{blue}\ast}$ que el implicante \{12,13\} es esencial, ya que es el único
            que cubre el maxtérmino $13$. El implicante primo \{8,10,12,14\} también es esencial por ser el único que cubre el maxtérmino $8$ (indicado con {\color{purple}$\ast$}).

            Por tanto, los implicantes primos esenciales son los siguientes:
            \begin{table}[H]
                \centering
                \begin{tabular}{|c|c|c|}
                    \hline
                    Implicante & Patrón & Suma \\ \hline
                    \{2,3\} & 001\_ & $a+b+\ol{c}$ \\
                    \{12,13\} & 110\_ & $\ol{a}+\ol{b}+c$ \\
                    \{8,10,12,14\} & 1\_\_0 & $\ol{a} + d$ \\ \hline
                \end{tabular}
            \end{table}

            Por tanto, una vez aplicado el algoritmo de Quine-McCluskey, la expresión minimal de la función a condición de ser~POS es:
            \begin{equation*}
                f(a, b, c, d) = (a+b+\ol{c})(\ol{a}+\ol{b}+c)(\ol{a} + d)
            \end{equation*}

            \item Elija justificadamente la expresión de menor coste entre la SOP y la POS encontradas en los
            apartados anteriores.

            Calculemos para ello el coste de ambas expresiones obtenidas en los apartados anteriores:
            \begin{figure}[H]
                \centering
                \begin{subfigure}{0.45\textwidth}
                    \centering
                    \begin{forest}
                        [$+$
                            [$\cdot$
                                [$\ol{a}$]
                                [$\ol{c}$]
                            ]
                            [$\cdot$
                                [$b$]
                                [$c$]
                            ]
                            [$\cdot$
                                [$a$]
                                [$\ol{b}$]
                                [$d$]
                            ]
                        ]
                    \end{forest}
                    \caption{SOP.}
                \end{subfigure}\hfill
                \begin{subfigure}{0.45\textwidth}
                    \centering
                    \begin{forest}
                        [$\cdot$
                            [$+$
                                [$a$]
                                [$b$]
                                [$\ol{c}$]
                            ]
                            [$+$
                                [$\ol{a}$]
                                [$\ol{b}$]
                                [$c$]
                            ]
                            [$+$
                                [$\ol{a}$]
                                [$d$]
                            ]   
                        ]
                    \end{forest}
                    \caption{POS.}
                \end{subfigure}
            \end{figure}
        \end{enumerate}

        Por tanto, en el caso de la expresión SOP, tenemos:
        \begin{itemize}
            \item Puertas \verb|OR|: 1.
            \item Puertas \verb|AND|: 3.
            \item Ejes: 10.
        \end{itemize}
        Por tanto, el coste de la expresión SOP es $1+3+10=14$.
        Respecto a la expresión POS, tenemos:
        \begin{itemize}
            \item Puertas \verb|OR|: 3.
            \item Puertas \verb|AND|: 1.
            \item Ejes: 11.
        \end{itemize}
        Por tanto el coste de la expresión POS es $3+1+11=15$.\\

        Como el coste de la expresión SOP es menor que el de la expresión POS (14 < 15), elegimos la SOP como expresión de menor coste:
        \begin{equation*}
            f(a, b, c, d) = \ol{a}~\ol{c} + b~c + a~\ol{b}~d
        \end{equation*}
        
    \end{ejercicio}

    \begin{ejercicio}
        De ser posible, construya razonadamente un grafo $G$ (sin lazos ni lados paralelos) que teniendo $7$
        vértices: dos sean de grado $2$, uno de grado $3$, tres de grado $4$ y no haya ninguno de grado $1$.\\

        Sea $G=(V,A)$ un grafo simple con $V=\{v_1,v_2,v_3,v_4,v_5,v_6,v_7\}$. Para cada $i\in\{1,\dots,7\}$, denotamos por $d_i$ al grado de $v_i$ ($d_i=\text{dg}(v_i)$).
        Por ser un grafo simple, veamos que:
        \begin{equation*}
            d_i\leq 6, \qquad \forall i\in\{1,\dots,7\}
        \end{equation*}
        Supongamos que $\exists i\in\{1,\dots,7\}$ tal que $d_i\geq 7$.
        Por definición, como no hay lazos, tenemos que el número de aristas de
        $G$ incidentes en $v_i$ es mayor o igual que $7$. No obstante, esto contradice nuestra hipótesis, ya que
        por el principio del palomar, existirían aristas paralelas.
        Por tanto, tenemos que $d_i\leq 6$ para todo $i\in \{1,2,3,4,5,6,7\}$.\\

        Aplicamos ahora las condiciones dadas. Tenemos que:
        \begin{equation*}
            d_1 = k\in \omega, \qquad d_2=d_3=d_4=4, \qquad d_5=3,\qquad d_6=d_7=2
        \end{equation*}
        Buscamos ahora conocer el valor de $k\in \omega$. Por ser $G$ un grafo, tenemos que:
        \begin{equation*}
            \sum_{i=1}^7 d_i = k+3\cdot 4+2\cdot 2+1\cdot 3 = 19+k = 2\cdot |A|
        \end{equation*}
        Por tanto, sabemos que $d_1=k\leq 6$ y $k$ es impar. Como $k$ no puede ser ni $1$ ni $3$ por hipótesis (ya que entonces habría más nodos con dicho grado que los indicados en el enunciado),
        tenemos que $d_1=k=5$.\\

        Una vez llegados a este punto, en el que sabemos el grado de cada vértice de nuestro grafo $G$,
        consideramos la sucesión $5,4,4,4,3,2,2$, y aplicaremos el teorema de \emph{Havel-Hakimi}
        para construir el grafo.
        \begin{table}[H]
            \centering
            \begin{tabular}{ccccccc|l}
                5 & 4 & 4 & 4 & 3 & 2 & 2 & Eliminamos el 5 y restamos uno a los 5 términos siguientes\\
                  & 3 & 3 & 3 & 2 & 1 & 2 & Reordenamos los términos\\
                  & 3 & 3 & 3 & 2 & 2 & 1 & Eliminamos el 3 y restamos uno a los 3 términos siguientes\\
                  &   & 2 & 2 & 1 & 2 & 1 & Reordenamos los términos\\
                  &   & 2 & 2 & 2 & 1 & 1 & Eliminamos el 2 y restamos uno a los 2 términos siguientes\\
                  &   &   & 1 & 1 & 1 & 1 & Eliminamos el 1 y restamos uno al término siguiente\\
                  &   &   &   & 0 & 1 & 1 & Reordenamos los términos\\
                  &   &   &   & 1 & 1 & 0 & Eliminamos el 1 y restamos uno al término siguiente\\
                  &   &   &   &   & 0 & 0 &
            \end{tabular}
        \end{table}

        Por tanto, comprobamos que, efectivamente se puede construir un grafo $G$ con las condiciones dadas; es decir,
        que la sucesión $5,4,4,4,3,2,2$ es gráfica. Para representarlo, comenzamos con
        la sucesión $0,0$:
        \begin{figure}[H]
            \centering
            \begin{tikzpicture}
                % Grafo con dos nodos
                \node[shape=circle,draw=black] (v6) at (0,0) {$v_6$};
                \node[shape=circle,draw=black] (v7) at (0,2) {$v_7$};
            \end{tikzpicture}
        \end{figure}

        Ahora, pasamos a la sucesión superior, es decir, $1,1,0$, que proviene de la sucesión $\bf{0}, 0$,
        por lo que el nuevo nodo añadido debe conectarse a un nodo de grado $0$:
        \begin{figure}[H]
            \centering
            \begin{tikzpicture}
                % Grafo con dos nodos
                \node[shape=circle,draw=black] (v6) at (0,0) {$v_6$};
                \node[shape=circle,draw=black] (v7) at (0,2) {$v_7$};
                % Añadimos un nodo más
                \node[shape=circle,draw=black] (v5) at (-1,4) {$v_5$};
                % Añadimos las aristas
                \draw (v7) -- (v6);
            \end{tikzpicture}
        \end{figure}

        La siguiente sucesión es $1,1,1,1$, que proviene de $\bf{0}, 1, 1$,
        luego el nuevo nodo añadido debe conectarse a un nodo que tenía grado $0$:
        \begin{figure}[H]
            \centering
            \begin{tikzpicture}
                % Grafo con dos nodos
                \node[shape=circle,draw=black] (v6) at (0,0) {$v_6$};
                \node[shape=circle,draw=black] (v7) at (0,2) {$v_7$};
                % Añadimos un nodo más
                \node[shape=circle,draw=black] (v5) at (-4,4) {$v_5$};
                % Añadimos un nodo más
                \node[shape=circle,draw=black] (v4) at (-2, 0) {$v_4$};
                % Añadimos las aristas
                \draw (v7) -- (v6);
                \draw (v5) -- (v4);
            \end{tikzpicture}
        \end{figure}

        La siguiente sucesión es $2,2,2,1,1$, que proviene de la sucesión $\bf{1}, \bf{1}, 1, 1$,
        luego el nuevo nodo añadido debe conectarse a dos nodos de grado $1$:
        \begin{figure}[H]
            \centering
            \begin{tikzpicture}
                % Grafo con dos nodos
                \node[shape=circle,draw=black] (v6) at (0,0) {$v_6$};
                \node[shape=circle,draw=black] (v7) at (0,2) {$v_7$};
                \node[shape=circle,draw=black] (v5) at (-7,4) {$v_5$};
                \node[shape=circle,draw=black] (v4) at (-4, 0) {$v_4$};
                \node[shape=circle,draw=black] (v3) at (-4, 2) {$v_3$};
                % Añadimos las aristas
                \draw (v7) -- (v6);
                \draw (v5) -- (v4);
                \draw (v3) -- (v4);
                \draw (v3) -- (v5);
            \end{tikzpicture}
        \end{figure}

        La siguiente sucesión es $3,3,3,2,2,1$, que proviene de la sucesión $\bf{2}, \bf{2}, \bf{1}, 2, 1$.
        Por tanto, el nuevo nodo añadido debe conectarse a dos nodos de grado $2$ y uno de grado~$1$: 
        \begin{figure}[H]
            \centering
            \begin{tikzpicture}
                % Grafo con dos nodos
                \node[shape=circle,draw=black] (v6) at (0,0) {$v_6$};
                \node[shape=circle,draw=black] (v7) at (0,2) {$v_7$};
                \node[shape=circle,draw=black] (v5) at (-7,4) {$v_5$};
                \node[shape=circle,draw=black] (v4) at (-4, 0) {$v_4$};
                \node[shape=circle,draw=black] (v3) at (-4, 2) {$v_3$};
                \node[shape=circle,draw=black] (v2) at (-4, -2) {$v_2$};
                % Añadimos las aristas
                \draw (v7) -- (v6);
                \draw (v5) -- (v4);
                \draw (v3) -- (v4);
                \draw (v3) -- (v5);
                \draw (v2) -- (v4);
                \draw (v2) -- (v5);
                \draw (v2) -- (v6);
            \end{tikzpicture}
        \end{figure}

        La última sucesión es $5,4,4,4,3,2,2$, que proviene de la sucesión $\bf{3}, \bf{3}, \bf{3}, \bf{2},\bf{1},2$,
        luego el nuevo nodo añadido debe conectarse a tres nodos de grado $3$, uno de grado $2$ y uno de grado $1$:
        \begin{figure}[H]
            \centering
            \begin{tikzpicture}
                % Grafo con dos nodos
                \node[shape=circle,draw=black] (v6) at (0,0) {$v_6$};
                \node[shape=circle,draw=black] (v7) at (0,2) {$v_7$};
                \node[shape=circle,draw=black] (v5) at (-7,4) {$v_5$};
                \node[shape=circle,draw=black] (v4) at (-4, 0) {$v_4$};
                \node[shape=circle,draw=black] (v3) at (-4, 2) {$v_3$};
                \node[shape=circle,draw=black] (v2) at (-4, -2) {$v_2$};
                \node[shape=circle,draw=black] (v1) at (-1, 4) {$v_1$};
                % Añadimos las aristas
                \draw (v7) -- (v6);
                \draw (v5) -- (v4);
                \draw (v3) -- (v4);
                \draw (v3) -- (v5);
                \draw (v2) -- (v4);
                \draw (v2) -- (v5);
                \draw (v2) -- (v6);
                \draw (v1) -- (v4);
                \draw (v1) -- (v5);
                \draw (v1) -- (v2);
                \draw (v1) -- (v3);
                \draw (v1) -- (v7);
            \end{tikzpicture}
        \end{figure}

        De esta forma, hemos construido un grafo $G$ con las condiciones dadas (7 nodos, dos de grado $2$, uno de grado $3$ y tres de grado $4$).
    \end{ejercicio}



    \begin{ejercicio}
        Considere las fórmulas de cierto lenguaje de primer orden:
        \begin{itemize}
            \item $\varphi_0 \equiv \forall x (r(x, x) \rightarrow \exists y r(x, y))$
            \item $\varphi_1 \equiv \forall x \forall y (r(x, y) \rightarrow r(y, x))$
            \item $\varphi_2 \equiv \forall x (\lnot r(y, x))$
            \item $\varphi_3 \equiv \exists x (\lnot r(x, x))$
        \end{itemize}
        y diga razonadamente si son ciertas o no cada una de las siguintes afirmaciones:
        \begin{enumerate}
            \item $\varphi_0,~\varphi_1,~\varphi_2 \models \varphi_3$
            
            Demostraremos que sí es cierta. Esto lo haremos demostrando que el conjunto $\Gamma=\{\varphi_0,~\varphi_1,~\varphi_2, \lnot\varphi_3\}$ es insatisfactible.
            Para ello, calcularemos la forma clausulada de cada una de las fórmulas,
            pasando para ello tanto por la forma normal prenexa como por la forma normal de Skolem:
            \begin{align*}
                \varphi_0&\equiv \forall x (r(x, x) \rightarrow \exists y r(x, y))\\
                & \equiv \forall x \exists y (r(x, x) \rightarrow r(x, y))\\
                & \equiv \forall x \exists y (\lnot r(x, x) \lor r(x, y))\\
                & \equiv \forall x (\lnot r(x, x) \lor r(x, f(x)))\\ \\
                \varphi_1&\equiv \forall x \forall y (r(x, y) \rightarrow r(y, x))\\
                &\equiv \forall x \forall y (\lnot r(x, y) \lor r(y, x))\\ \\
                \varphi_2 &\equiv \forall x (\lnot r(y, x))\\
                &\stackrel{(\ast)}{\equiv} \forall x (\lnot r(b, x))\\ \\
                \lnot \varphi_3&\equiv \lnot (\exists x (\lnot r(x, x)))\\
                &\equiv \forall x (r(x, x))
            \end{align*}
            donde en $(\ast)$ hemos sustituido $y$ por $b$ en $\varphi_2$
            por tratarse de una fórmula y no de una sentencia ($y$ es libre).
            Definimos el conjunto $\Gamma_1^\ast$ de las formas clausuladas de los elementos de $\Gamma$:
            \begin{align*}
                \Gamma_1^\ast &=
                \left\{ \forall x (\lnot r(x, x) \lor r(x, f(x))),
                \forall x \forall y (\lnot r(x, y) \lor r(y, x)),
                \forall x (\lnot r(b, x)),
                \forall x (r(x, x))
                \right\}
            \end{align*}
    
            Tenemos que el conjunto de fórmulas $\Gamma$ es insatisfacible si y solo si el conjunto de sentencias $\Gamma_1^\ast$ es insatisfacible.
            Veamos que se cumple esto último por resolución:
            \begin{figure}[H]
                \centering
                \shorthandoff{""}
                \begin{tikzcd}
                    {\lnot r(b,x)} \arrow[d, "(x|b)"', no head] & {r(x,x)} \arrow[ld, "(x|b)", no head] \\
                    \square                                     &                                      
                \end{tikzcd}
                \shorthandon{""}
            \end{figure}
    
            Por tanto, $\Gamma_1^\ast$ es insatisfacible, y deducimos que $\Gamma$ también lo es, teniendo que
            $\varphi_0,~\varphi_1,~\varphi_2 \models \varphi_3$ como queríamos demostrar.
    
            \item $\varphi_0,~\varphi_2,~\varphi_3 \models \varphi_1$
            
            Demostraremos que no es cierta. Veamos que $\varphi_0,~\varphi_2,~\varphi_3 \not\models \varphi_1$. Sea $\bf{A}$ una estructura tal que:
            \begin{itemize}
                \item $A=\{0,1\}$
                \item $(r)^{\bf{A}}=\{\langle 0,0\rangle, \langle 0,1\rangle\}$
            \end{itemize}
    
            Sea una asignación $v$ tal que $v(y)=1$, y consideremos la interpretación $\langle \bf{A},v\rangle$.
            Veamos qué ocurre con cada una de las fórmulas:
            \begin{enumerate}
                \item \underline{Para $\varphi_0$:}
                \begin{align*}
                    I_{\bf{A}}^v(\varphi_0) = 1 & \Longleftrightarrow \forall a\in A,\quad I_{\bf{A}}^{v(x|a)}(r(x, x) \rightarrow \exists y r(x, y))=1\\
                    & \Longleftrightarrow \forall a\in A,\quad I_{\bf{A}}^{v(x|a)}(r(x, x))I_{\bf{A}}^{v(x|a)}(\exists y r(x, y)) + I_{\bf{A}}^{v(x|a)}(r(x, x))+1=1\\
                    & \Longleftrightarrow \forall a\in A,\quad I_{\bf{A}}^{v(x|a)}(r(x, x))I_{\bf{A}}^{v(x|a)}(\exists y r(x, y)) = I_{\bf{A}}^{v(x|a)}(r(x, x))
                \end{align*}
    
                Veamos qué ocurre con cada $a\in A$:
                \begin{itemize}
                    \item Para $a=0$:
                    \begin{align*}
                        I_{\bf{A}}^{v(x|0)}(r(x, x)) = 1 & \Longleftrightarrow \langle v(x|0)(x),v(x|0)(x)\rangle = \langle 0,0\rangle\in (r)^{\bf{A}} \qquad \checkmark \\
                        I_{\bf{A}}^{v(x|0)}(\exists y r(x, y)) = 1 & \Longleftrightarrow \exists b\in A,\quad I_{\bf{A}}^{v(x|0,y|b)}(r(x, y)) = 1\\
                        & \Longleftrightarrow \exists b\in A,\quad \langle v(x|0,y|b)(x),v(x|0,y|b)(y)\rangle = \langle 0,b\rangle\in (r)^{\bf{A}}
                    \end{align*}
                    Tomando $b=0$, se tiene que $\langle 0,0\rangle\in (r)^{\bf{A}}$ y por tanto $I_{\bf{A}}^{v(x|0)}(\exists y r(x, y))=1$.
                    Tenemos entonces $1\cdot 1 = 1$, lo cual es correcto.
    
                    \item Para $a=1$:
                    \begin{align*}
                        I_{\bf{A}}^{v(x|1)}(r(x, x)) = 1 & \Longleftrightarrow \langle v(x|1)(x),v(x|1)(x)\rangle = \langle 1,1\rangle\in (r)^{\bf{A}} \qquad \times
                    \end{align*}
                    Por tanto, como $\langle 1,1\rangle\notin (r)^{\bf{A}}$, se tiene que $I_{\bf{A}}^{v(x|1)}(r(x, x))=0$, y por tanto tenemos que $0\cdot 1 = 0$, lo cual es correcto.
                \end{itemize}
                En definitiva, tenemos que $I_{\bf{A}}^v(\varphi_0)=1$.
    
                \item \underline{Para $\varphi_2$:}
                \begin{align*}
                    I_{\bf{A}}^v(\varphi_2) = 1 & \Longleftrightarrow I_{\bf{A}}^v(\forall x (\lnot r(y, x)))=1\\
                    & \Longleftrightarrow \forall a\in A, I_{\bf{A}}^{v(x|a)}(\lnot r(y, x))=1\\
                    & \Longleftrightarrow \forall a\in A, I_{\bf{A}}^{v(x|a)}(r(y, x))+1=1\\
                    & \Longleftrightarrow \forall a\in A, I_{\bf{A}}^{v(x|a)}(r(y, x))=0 \\
                    & \Longleftrightarrow \forall a\in A, \langle v(x|a)(y),v(x|a)(x)\rangle\notin (r)^{\bf{A}}\\
                    & \Longleftrightarrow \forall a\in A, \langle v(y),a\rangle\notin (r)^{\bf{A}} \\
                    & \Longleftrightarrow \forall a\in A, \langle 1,a\rangle\notin (r)^{\bf{A}} \qquad \checkmark
                \end{align*}
                donde hemos afirmado que, para todo $a\in A$, $\langle 1,a\rangle\notin (r)^{\bf{A}}$, puesto que no existe ningún par en $(r)^{\bf{A}}$ que tenga a $1$ como primer componente.
    
                \item \underline{Para $\varphi_3$:}
                \begin{align*}
                    I_{\bf{A}}^v(\varphi_3) = 1 & \Longleftrightarrow I_{\bf{A}}^v(\exists x (\lnot r(x, x)))=1\\
                    & \Longleftrightarrow \exists a\in A, \qquad I_{\bf{A}}^{v(x|a)}(\lnot r(x, x))=1\\
                    & \Longleftrightarrow \exists a\in A, \qquad I_{\bf{A}}^{v(x|a)}(r(x, x))+1=1\\
                    & \Longleftrightarrow \exists a\in A, \qquad I_{\bf{A}}^{v(x|a)}(r(x, x))=0 \\
                    & \Longleftrightarrow \exists a\in A, \qquad \langle v(x|a)(x),v(x|a)(x)\rangle\notin (r)^{\bf{A}}\\
                    & \Longleftrightarrow \exists a\in A, \qquad \langle a,a\rangle\notin (r)^{\bf{A}} \qquad \checkmark
                \end{align*}
                Por tanto, tomando $a=1$, se tiene que $\langle 1,1\rangle\notin (r)^{\bf{A}}$, y por tanto $I_{\bf{A}}^v(\varphi_3)=1$.
    
                \item \underline{Para $\varphi_1$:}
                \begin{align*}
                    I_{\bf{A}}^v(\varphi_1) = 1 & \Longleftrightarrow I_{\bf{A}}^v(\forall x \forall y (r(x, y) \rightarrow r(y, x)))=1\\
                    & \Longleftrightarrow \forall a\in A, \forall b\in A,\qquad I_{\bf{A}}^{v(x|a,y|b)}(r(x, y) \rightarrow r(y, x))=1\\
                    & \Longleftrightarrow \forall a\in A, \forall b\in A,\\&\hspace{2.3cm}I_{\bf{A}}^{v(x|a,y|b)}(r(x, y))I_{\bf{A}}^{v(x|a,y|b)}(r(y, x))+I_{\bf{A}}^{v(x|a,y|b)}(r(x, y))+1=1\\
                    & \Longleftrightarrow \forall a\in A, \forall b\in A,\\&\hspace{2.3cm}I_{\bf{A}}^{v(x|a,y|b)}(r(x, y))I_{\bf{A}}^{v(x|a,y|b)}(r(y, x))=I_{\bf{A}}^{v(x|a,y|b)}(r(x, y))
                \end{align*}
                Tomemos $a=0$ y $b=1$. Tenemos que:
                \begin{align*}
                    I_{\bf{A}}^{v(x|0,y|1)}(r(x, y)) &= 1 \Longleftrightarrow \langle v(x|0,y|1)(x),v(x|0,y|1)(y)\rangle = \langle 0,1\rangle\in (r)^{\bf{A}} \qquad \checkmark\\
                    I_{\bf{A}}^{v(x|0,y|1)}(r(y, x)) &= 1 \Longleftrightarrow \langle v(x|0,y|1)(y),v(x|0,y|1)(x)\rangle = \langle 1,0\rangle\in (r)^{\bf{A}} \qquad \times
                \end{align*}
    
                Por tanto, tenemos que $I_{\bf{A}}^{v(x|0,y|1)}(r(x, y))=1$ y $I_{\bf{A}}^{v(x|0,y|1)}(r(y, x))=0$, y como $1\cdot 0 \neq 0$, se tiene que $I_{\bf{A}}^v(\varphi_1)=0$.
            \end{enumerate}
    
            En conclusión, hemos encontrado una $\bf{L}-$interpretación $\langle \bf{A},v\rangle$ tal que:
            \begin{gather*}
                I_{\bf{A}}^v(\varphi_0)=I_{\bf{A}}^v(\varphi_2)=I_{\bf{A}}^v(\varphi_3)=1,\\I_{\bf{A}}^v(\varphi_1)=0
            \end{gather*}

            Por tanto, se tiene que $\varphi_0,~\varphi_2,~\varphi_3 \not\models \varphi_1$.
        \end{enumerate}
    \end{ejercicio}


    
\end{document}