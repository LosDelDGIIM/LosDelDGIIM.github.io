\section{Homomorfismos de cuerpos}

\begin{lema}
    Sea $\sigma:F\to A$ un homomorfismo de anillos donde $F$ es un cuerpo y $A$ es no trivial, entonces $\sigma$ es inyectivo y, por tanto, $Im \sigma$ es un cuerpo isomorfo a $F$ y subanillo de $A$.
    \begin{proof}
        Solo hemos de probar que $\ker \sigma = \{0\}$. Para ello, $\ker \sigma$ es un ideal de $F$ que no es $F$ (ya que $\sigma(1) = 1$), de donde $\ker \sigma = \{0\}$. Para ver que $Im \sigma\cong F$, basta aplicar el Primer Teorema de Isomorfía:
        \begin{equation*}
            F = \dfrac{F}{\ker \sigma} \cong Im \sigma
        \end{equation*}
    \end{proof}
\end{lema}

\begin{definicion}[Homomorfismo de cuerpos]
    Sea $F\stackrel{\sigma}{\to} K$ un homomorfismo de anillos entre cuerpos, diremos entonces que es un \underline{homomorfismo de cuerpos}.
\end{definicion}

\begin{observacion}
    Resulta sorprendente que exigir ``buenas propiedades'' a una aplicación entre anillos ya nos da una aplicación con ``buenas propiedades'' entre cuerpos, pero resulta que lo único que nos faltaba era que la aplicación se comporte bien con los inversos, propiedad que queda garantizada al exigir ``buenas propiedades'' sobre anillos:
    \begin{equation*}
        1 = \sigma(1) = \sigma\left(\alpha\alpha^{-1}\right) = \sigma(\alpha)\sigma\left(\alpha^{-1}\right) \Longrightarrow \sigma\left(\alpha^{-1}\right) = {\sigma(\alpha)}^{-1}
    \end{equation*}
    Como por el Lema anterior todo homomorfismo de cuerpos $F\stackrel{\sigma}{\to}K$ es siempre inyectivo, tendremos siempre una copia de $F$ dentro de $K$, que en ocasiones identificaremos con el propio $F$, viendo $\sigma(F)$ como una copia isomorfa de $F$. Como $\sigma(F)\leq K$ es una extensión de cuerpos, podemos ver $K$ como un $\sigma(F)-$espacio vectorial. Además, si identificamos $F$ con $\sigma(F)$, podremos ver $K$ como un $F-$espacio vectorial.
\end{observacion}

\begin{definicion}
    Siempre que tengamos $F\stackrel{\sigma}{\to} K$ y $f\in F[x]$ dada por:
\begin{equation*}
    f = \sum_{i=1}^{n} f_i x^i, \qquad f_i \in F \quad \forall i \in \{1,\ldots,n\}
\end{equation*}
Definiremos:
\begin{equation*}
    f^\sigma = \sum_{i=1}^{n} \sigma(f_i) x^i \in K[x]
\end{equation*}
Se verifica que la correspondencia $f\mapsto f^\sigma$ es un homomorfismo de anillos entre $F[x]$ y $K[x]$.
\end{definicion}

\begin{ejemplo}
    Sea $f\in F[x]$, $f$ no constante, sea $p\in F[x]$ un factor irreducible de $f$, consideramos\footnote{Donde $\langle p \rangle $ es el ideal generado por $p$.}:
    \begin{equation*}
        K = \dfrac{F[x]}{\langle p \rangle }
    \end{equation*}
    como $p$ es irreducible, tenemos que $K$ es un cuerpo. Definimos $\sigma:F\to K$ como:
    \begin{equation*}
        \sigma(a) = a + \langle p \rangle  \qquad \forall a\in F
    \end{equation*}
    que es un homomorfismo de anillos (observemos que es la composición de la proyección al cociente con la inclusión en $F[x]$) entre cuerpos, luego un homomorfismo de cuerpos, con:
    \begin{equation*}
        \sigma(F) = \{a+\langle p \rangle : a\in F\} \cong F
    \end{equation*}
    Sea $\alpha = x+\langle p \rangle \in K$, tenemos que:
    \begin{equation*}
        p^\sigma(\alpha) = \sum_{i=1}^{n} (p_i + \langle p \rangle){(x+\langle p \rangle )}^{i} = \sum_{i=1}^{n} p_ix^i + \langle p \rangle  = p + \langle p \rangle  = 0 + \langle p \rangle 
    \end{equation*}
    Además:
    \begin{equation*}
        \sigma(F)(\alpha) = K
    \end{equation*}
    \begin{description}
        \item [$\subset )$] Basta ver que $K$ contiene a $\sigma(F)$ y a $\alpha$.
        \item [$\supset )$] Si tomamos un elemento de $K$, este será de la forma $g+\langle p \rangle $ para cierta $g\in F[x]$ dada por:
            \begin{equation*}
                \sum_{i=1}^{n}g_ix^i, \qquad g_i \in F, \quad \forall i \in \{1,\ldots,n\}
            \end{equation*}
            Por lo que:
            \begin{equation*}
                g+\langle p \rangle  = \sum_{i=1}^{n}g_ix^i + \langle p \rangle  = \sum_{i=1}^{n}(g_i+\langle p \rangle ){(x+\langle p \rangle )}^{i} \in \sigma(F)(\alpha)
            \end{equation*}
    \end{description}
\end{ejemplo}

\begin{lema}\label{lema:cuerpo_descomposicion}
    Si $f\in F[x]$ es no constante y $p$ es un factor irreducible de $f$, entonces existen $F\stackrel{\sigma}{\to}K$ homomorfismo de cuerpos y $\alpha\in K$ tales que:
    % \begin{equation*}
    %     f^\sigma(\alpha) = 0 \qquad \text{y}\qquad  \sigma(F)(\alpha) = K
    % \end{equation*}
    \begin{equation*}
        p^\sigma(\alpha) = 0 \qquad \text{y}\qquad  K = \sigma(F)(\alpha)
    \end{equation*}
    Bajo estas condiciones, a menudo identificaremos $F$ con $\sigma(F)$ y en dicho caso, escribiremos $K= F(\alpha)$.
    \begin{proof}
        La demostración se deduce del ejemplo anterior.
    \end{proof}
\end{lema}

\begin{prop}
    Sea $f\in F[x]$ con $degf = n \geq 1$, entonces existe un homomorfismo de cuerpos $\sigma:F\to E$ tal que $E$ es un cuerpo de descomposición de $f^{\sigma}$.
    \begin{proof}
        Suponemos sin pérdida de generalidad que $f$ es mónico. Vamos a ver que existe $F\stackrel{\sigma}{\to}L$ tal que $f^\sigma$ se descompone completamente como producto de factores lineales en $L[x]$. Para ello, descomponemos $f=gh$, donde $g\in F[x]$ es producto de polinomios lineales y $h\in F[x]$ es un polinomio sin raíces en $F$. Por inducción sobre el grado de $h$ (usando el segundo principio de inducción):
        \begin{itemize}
            \item \underline{Si $deg h = 0$}, tomando $L = F$ y $\sigma = id_F$ se tiene.
            \item \underline{Supuesto que $degh>0$ y la hipótesis de inducción}, tomamos $p$ un factor irreducible de $h$, por lo que podemos aplicar el Lema~\ref{lema:cuerpo_descomposicion}, con lo que existen $F\stackrel{\tau}{\to}K$ y $\alpha\in K$ tal que $p^\tau(\alpha)=0$ y $K = F(\alpha)$. Observamos que $h^\tau(\alpha)=0$.

                El polinomio $g$ que habíamos escogido será de la forma:
                \begin{equation*}
                    g = (x-\alpha_1)\cdot  \ldots \cdot (x-\alpha_t), \qquad \alpha_1,\ldots,\alpha_t \in F
                \end{equation*}
                Extraemos ahora los factores lineales de $h^\tau$ en $K[x]$ (sabemos que al menos $s\geq 1$, puesto que $\alpha$ es raíz de $h^\tau$):
                \begin{equation*}
                    h^\tau = (x-\beta_1)\cdot \ldots\cdot (x-\beta_s)k, \qquad k\in K[x], \beta_1,\ldots,\beta_s\in K
                \end{equation*}
                Con uno de los $\beta_i$ es $\alpha$ y $k$ sin raíces en $K$ y de grado menor que el de $h^\tau$. En definitiva, tenemos que:
                \begin{equation*}
                    f^\tau = g^\tau h^\tau = (x-\tau(\alpha_1))\cdot  \ldots \cdot (x-\tau(\alpha_s))(x-\beta_1) \cdot \ldots \cdot (x-\beta_s)k, \qquad deg k < deg h^\tau
                \end{equation*}
                Aplicando la hipótesis de inducción tomando $k$ como $h$, existe un homomorfismo $K\stackrel{\rho}{\to}L$ tal que $k^\rho$  se descompone como producto de polinomios lineales en $L[x]$. En defintiiva, tendremos que ${(f^\tau)}^{\rho}$ se descompone como producto de polinomios lineales en $L[x]$. Si tomamos:
                \begin{equation*}
                    \sigma = \rho\tau : F\to L
                \end{equation*}
                tenemos que $f^\sigma$ se descompone como producto de lineales en $L[x]$. Tomamos ahora como $E$ el subcuerpo de $L$ generado por las raíces de $f^\sigma$ y $\sigma(F)$, con lo que $E$ es un cuerpo de descomposición de $f^\sigma$.
        \end{itemize}
    \end{proof}
\end{prop}

\begin{definicion}
    A un homomorfismo $\sigma:F\to E$ como el de la Proposición anterior se le llama cuerpo de descomposición de $f$.
\end{definicion}

\noindent
Respecto a esta última definición, debemos tener claro que antes hablábamos de cuerpo de descomposición de $f\in F[x]$ a una extensión $F\leq K$ de forma que $K$ cumplía ciertas propiedades relativas a $f$. Ahora, lo que hacemos es ver el homomorfismo $F\stackrel{\sigma}{\to} K$ como una extensión de cuerpos, identificando $F$ con $\sigma(F)$, por lo que al propio homomorfismo (que hace el papel de la extensión) le llamamos ahora cuerpo de descomopsición, si $K$ cumple unas propiedades relativas a $f^\sigma$.

\begin{ejemplo}
    Tomamos $f = x^2+x+1\in \bb{F}_2[x]$, donde $\bb{F}_2 = \{0,1\}$ es el cuerpo que contiene dos elementos. Como $f(0) = f(1) = 1 \neq 0$, tenemos que $f$ no tiene raíces en $\bb{F}_2$. Nuestro objetivo es buscar un cuerpo de descomposición suyo.\\

    \noindent
    Observemos que como $f$ es de grado 2 y no tiene raíces en $\bb{F}_2$, $f$ es irreducible, por lo que repitiendo el ejemplo anterior del que vienen el Lema y la Proposición, podemos tomar el cuerpo:
    \begin{equation*}
        K = \dfrac{\bb{F}_2[x]}{\langle f \rangle }
    \end{equation*}

    y el homomorfismo de cuerpos:
    \Func{\sigma}{\bb{F}_2}{K}{\sigma(y)}{y+\langle f\rangle}

    sabemos ya que:
    \begin{equation*}
        f^\sigma(\alpha) = 0 \quad \text{con}\quad  \alpha = x+\langle f \rangle 
    \end{equation*}
    Si factorizamos $f^\sigma$ (usando que $\alpha^2 + \alpha+1$):
    \begin{equation*}
        f^\sigma = (x+\alpha)(x+\alpha^2)
    \end{equation*}
    tenemos que $\sigma$ es un cuerpo de descomposición de $F$. Viendo que tenemos una copia isomorfa de $\bb{F}_2$ dentro de $K$, identificamos $\bb{F}_2$ con $\sigma(\bb{F}_2)$, y tenemos $\bb{F}_2\leq K$, con lo que:
    \begin{equation*}
        K = \bb{F}_2(\alpha), \qquad Irr(\alpha,\bb{F}_2) = x^2+x+1, \quad \text{ó}\quad \alpha^2 + \alpha+1=0
    \end{equation*}
    ¿Cuántos elementos tiene $K$?

    \noindent
    En vista de que $[K:\bb{F}_2] = 2$ y $|\bb{F}_2| = 2$, tenemos que $|K| = 4$. Para listarlos:
    \begin{itemize}
        \item $K = \{1,\alpha,0,1+\alpha\}$. 

            Donde vemos que $1+\alpha$ es distinto del resto porque $\{1,\alpha\}$ es una $\bb{F}_2-$base de $K$. La condición $\alpha^2 + \alpha + 1 = 0$ también nos dice que $\alpha+1= \alpha^2$:
        \item $K = \{0,1,\alpha,\alpha^2\}$.
    \end{itemize}
\end{ejemplo}

\begin{ejemplo}
    Al igual que en el ejemplo anterior, tomamos
    \begin{equation*}
        f = x^3+x+1 \in \bb{F}_2[x]
    \end{equation*}
    que sigue siendo irreducible sobre $\bb{F}_2[x]$, por ser de grado 3 y no tener raíces en $\bb{F}_2[x]$. De la misma forma, un cuerpo de descomposición de $f$ es de la forma $\bb{F}_2(a)$ con $a$ en cierto cuerpo $K$, siendo $a$ una raíz de $f$. Tratamos de factorizar $f$ en $\bb{F}_2(a)$:

    \begin{equation*}
        \begin{array}{r|c}
            \begin{array}{rcrcrcc}
                x^3&+&&+&x&+&1 \\
                x^3&+&ax^2 && &&\\
                \hline
                   &&ax^2&+&x&+&1  \\
                   &&ax^2&+&a^2x&& \\
                   \hline
                   &&&&(a^2 +1)x &+&1 \\
                   &&&&(a^2+1)x &+&a^3 + a \\
                   \hline
                   &&&&&& a^3 + a + 1
            \end{array} & 
            \begin{array}{l}
                x+a \\
                \hline
                x^2+ax+(a^2+1) \\ \\ \\ \\ \\ \\
            \end{array}
        \end{array}
    \end{equation*}
    Y tenemos que $a^3+a+1 = 0$. Buscamos ahora una raíz de $x^2+ax+(a^2+1)$. Probamos con $a^2$ (donde usamos que $a^3 + a + 1 = 0$):
    \begin{equation*}
        {\left(a^2\right)}^{2}+ aa^2 + (a^2+1) = a^4 + a^3 + a^2 + 1 = a^4 + a + a^2 = a(a^3 + a + 1) = 0
    \end{equation*}
    Dividimos ahora entre $x+a^2$:
    \begin{equation*}
        \begin{array}{r|c}
            \begin{array}{rcrcc}
                x^2 &+& ax &+& a^2 +1 \\
                x^2 &+& a^2 x && \\
                \hline
                     a^4x &=& a(a+1)x &+& a^2 + 1 \\
                          && a^4x &+& a^6 \\
                          \hline
                          &&&& a^6+a^2 +1

            \end{array} & 
            \begin{array}{l}
                x+a^2 \\
                \hline
                x+a^4 \\ \\ \\ \\
            \end{array}
        \end{array}
    \end{equation*}
    Y tenemos:
    \begin{align*}
        a^6+a^2+1 = a^6+a^2 +a^3 +a = a(a^5+a+a^2+1) = a(a^5+a^2+a^3) = a^3(a^3 + 1 + a) = 0
    \end{align*}
    En definitiva, la factorización de $f$ en $\bb{F}_2(a)$ es:
    \begin{equation*}
        x^3+x+1 = (x+a)(x+a^2)(x+a^4)
    \end{equation*}
    con lo que $\bb{F}_2(a)$ es un cuerpo de descomposición de $f$, ahora $|\bb{F}_2(a)| = 2^3 = 8$.

    \noindent
    Podríamos haber estudiado también $f=x^3+x^2+1$, obteniendo otro cuerpo de $8$ elementos. Veremos luego que estos dos cuerpos son isomorfos entre sí, e isomorfos con todo otro cuerpo que contenga $8$ elementos, lo que nos permitirá notarlos a todos por $\bb{F}_8$.
\end{ejemplo}

\begin{lema}\label{lema:extension}
    Sea $F\stackrel{\sigma}{\to}{K}$, $p\in F[x]$ irreducible, si $\alpha\in K$ es raíz de $p^\sigma$, entonces se tiene que:
    \Func{\sigma_\alpha}{\dfrac{F[x]}{\langle p\rangle}}{\sigma(F)(\alpha)}{g+\langle p\rangle}{g^\sigma(\alpha)}
    es un isomorfismo de cuerpos.
    \begin{proof}
        Podemos tomar:
        \Func{\overline{\sigma_\alpha}}{F[x]}{\sigma(F)(\alpha)}{g}{g^\sigma(\alpha)}
        En el Lema~\ref{lema:cuerpo_descomposicion} vimos que $g^{\sigma}(\alpha)\in \sigma(F)(\alpha)$ siempre que $g\in F[x]$, por lo que $\overline{\sigma_\alpha}$ está bien definida, y además es un homomorfismo de cuerpos. Como $p^\sigma(\alpha)=0$, tenemos que $\langle p \rangle \subseteq \ker(\overline{\sigma_\alpha})$, pero como $p$ es irreducible, tenemos que $\langle p \rangle $ es maximal, con lo que $\langle p \rangle =\ker(\overline{\sigma_\alpha})$. Si aplicamos ahora el Primer Teorema de Isomorfía para anillos, vemos que:
        \begin{equation*}
            \dfrac{F[x]}{\langle p \rangle } = \dfrac{F[x]}{\ker(\overline{\sigma_\alpha})} \cong Im \overline{\sigma_\alpha} = \sigma(F)(\alpha)
        \end{equation*}
    \end{proof}
\end{lema}

\begin{definicion}
    Si tenemos dos homomorfismos de cuerpos:
    \begin{figure}[H]
        \centering
        \shorthandoff{""}
        \begin{tikzcd}
        F \arrow[r, "\tau"] \arrow[rd, "\sigma"'] & E                    \\
                                                  & K 
        \end{tikzcd}
        \shorthandon{""}
    \end{figure}
    \noindent
    Diremos que un homomorfismo de cuerpos $\eta:K\to E$ es una $\sigma-$extensión de $\tau$ si:
    \begin{equation*}
        \eta\sigma = \tau
    \end{equation*}
    \noindent
    Y notaremos al conjunto de todas las $\sigma-$extensiones de $\tau$ por:
    \begin{equation*}
        Ex(\tau,\sigma) = \{\eta:K\to E \text{\ con\ } \eta \text{\ homomorfismo y\ } \eta \sigma = \tau\}
    \end{equation*}
    Notemos que todos estos hacen que el siguiente diagrama sea conmutativo:
    \begin{figure}[H]
        \centering
        \shorthandoff{""}
        \begin{tikzcd}
        F \arrow[r, "\tau"] \arrow[rd, "\sigma"'] & E                    \\
                                                  & K \arrow[u, "\eta"']
        \end{tikzcd}
        \shorthandon{""}
    \end{figure}
\end{definicion}

\begin{prop}[Extensión de homomorfismos]
    Si tenemos dos homomorfismos de cuerpos:
    \begin{figure}[H]
        \centering
        \shorthandoff{""}
        \begin{tikzcd}
        F \arrow[r, "\tau"] \arrow[rd, "\sigma"'] & E                    \\
                                                  & K 
        \end{tikzcd}
        \shorthandon{""}
    \end{figure}
    \noindent
    Si $p\in F[x]$ irreducible y $\alpha\in K$ con $p^{\sigma}(\alpha)=0$, si $\cc{R}\subseteq E$ es el conjunto de todas las raíces de $p^\tau$ y además $K = \sigma(F)(\alpha)$, tenemos entonces que la aplicación
    \Func{}{Ex(\tau,\sigma)}{\cc{R}}{\eta}{\eta(\alpha)}
    es una biyección.
    \begin{proof}
        Veamos en primer lugar que dicha aplicación está bien definida. Para ello, sea $\eta \in Ex(\tau, \sigma)$:
        \begin{equation*}
            p^\tau(\eta(\alpha)) = p^{\eta \sigma}(\eta (\alpha)) \AstIg \eta(p^\sigma(\alpha)) = \eta(0) = 0
        \end{equation*}
        donde en $(\ast)$ hemos usado que si $p$ es de la forma:
        \begin{equation*}
            p = \sum_i p_i x^i, \qquad p_i \in F
        \end{equation*}

        entonces:
        \begin{equation*}
            p^{\eta\sigma}(\eta(\alpha)) = \sum_i \eta(\sigma(p_i)) \eta(\alpha) = \sum_i \eta(\sigma(p_i)\alpha) = \eta\left(\sum_i \sigma(p_i) \alpha\right) = \eta(p^\sigma(\alpha))
        \end{equation*}
        Esto prueba que\footnote{Notemos que hemos probado además que $Ex(\tau,\sigma)\neq \emptyset \Longrightarrow \cc{R}\neq \emptyset $.} $\eta(\alpha)\in \cc{R}$. Veamos ahora que la aplicación enunciada es sobreyectiva\footnote{Con lo que tendremos $\cc{R}\neq \emptyset \Longrightarrow Ex(\tau,\sigma)\neq \emptyset $}. Para ello, sea $\beta\in \cc{R}$, buscamos una $\sigma-$extensión $\eta$ de forma que $\eta(\alpha) = \beta$. Usando el Lema~\ref{lema:extension}, obtenemos los isomorfismos:
        \Func{\sigma_\alpha }{\dfrac{F[x]}{\langle p \rangle }}{\sigma(F)(\alpha)=K}{g+\langle p\rangle}{g^\sigma(\alpha)}
        \Func{\tau_\beta }{\dfrac{F[x]}{\langle p \rangle }}{\tau(F)(\beta)\leq E}{g+\langle p\rangle}{g^\tau(\beta)}
        Si tomamos:
        \begin{equation*}
            \eta = i \circ \tau_\beta \circ \sigma_\alpha^{-1}
        \end{equation*}
        donde $i$ es la inclusión $\tau(F)(\beta)\leq E$, observamos que:
        \begin{equation*}
            K\stackrel{\sigma_\alpha^{-1}}{\longrightarrow} \frac{F[x]}{\langle p \rangle } \stackrel{\tau_\beta}{\longrightarrow} \tau(F)(\beta) \stackrel{i}{\longrightarrow} E
        \end{equation*}
        Comprobemos que $\eta\in Ex(\tau,\sigma)$, ya que si $a\in F$:
        \begin{equation*}
            (\eta \circ \sigma)(a) = (i\circ \tau_\beta\circ \sigma_\alpha^{-1})(\sigma(a)) = (i\circ \tau_\beta)(\sigma_\alpha^{-1}(\sigma(a))) = (i\circ \tau_\beta)(a+\langle p \rangle ) = i(a) = a
        \end{equation*}
        donde hemos aplicado que tanto $\sigma_\alpha$ como $\tau_\beta$ aplicado sobre constantes son iguales a $\sigma$ y a $\tau$, respectivamente, lo que prueba que $\eta\in Ex(\tau,\sigma)$. Ahora:
        \begin{equation*}
            \eta(\alpha) = (i\circ \tau_\beta)(\sigma_\alpha^{-1}(\alpha))= (i\circ \tau_\beta)(x+\langle p \rangle ) = i(\beta) = \beta
        \end{equation*}
        Falta probar que la aplicación es inyectiva. Para ello, sean $\eta,\eta' \in Ex(\tau,\sigma)$ de forma que $\eta(\alpha)=\eta'(\alpha)$, entonces como $K=\sigma(F)(\alpha)$, si tomamos un elemento de $K$ este será de la forma:
        \begin{equation*}
            \sum_{i} \sigma(a_i) \alpha^i \in \sigma(F)(\alpha), \qquad a_i \in F
        \end{equation*}
        con lo que:
        \begin{equation*}
            \eta\left(\sum_{i}\sigma(a_i)\alpha^i\right) = \sum_i \eta(\sigma(a_i)) {\eta(\alpha)}^{i} \AstIg \sum_i \eta'(\sigma(a_i)) {\eta'(\alpha)}^{i} = \eta'\left(\sum_{i}\sigma(a_i)\alpha^i\right) 
        \end{equation*}
        donde en $(\ast)$ usamos que tanto $\eta$ como $\eta'$ son $\sigma-$extensiones de $\tau$, con lo que $\eta\circ \sigma = \tau = \eta'\circ \sigma$. En definitiva, tenemos que $\eta = \eta'$, al ser $\eta(g) = \eta'(g)$ para todo $g\in K$, lo que nos dice que la aplicación es inyectiva.
    \end{proof}
\end{prop}

\noindent
Obsevemos que en esta última proposición hemos probado además que:
\begin{equation*}
    \cc{R}= \emptyset  \Longleftrightarrow Ex(\tau,\sigma) =  \emptyset 
\end{equation*}

\begin{lema}
    Sean tres homomorfismos entre cuerpos:
    \begin{figure}[H]
        \centering
        \shorthandoff{""}
        \begin{tikzcd}
        F \arrow[r, "\tau"] \arrow[d, "\sigma_1"'] & L   \\
        E_1 \arrow[r, "\sigma_2"']                 & E_2
        \end{tikzcd}
        \shorthandon{""}
    \end{figure}
    Se verifica que:
    \begin{equation*}
        Ex(\tau,\sigma_2\sigma_1) = \biguplus_{\eta \in Ex(\tau,\sigma_1)} Ex(\eta,\sigma_2)
    \end{equation*}
    \begin{proof}
        Por doble inclusión:
        \begin{description}
            \item [$\subseteq )$] Si tomamos $\theta \in Ex(\tau,\sigma_2\sigma_1)$, tenemos entonces que:
                \begin{equation*}
                    \theta\sigma_2\sigma_1 = \tau
                \end{equation*}
                Por lo que si tomamos $\eta = \theta\sigma_2$, tenemos que:
                \begin{gather*}
                    \theta\sigma_2\sigma_1 = \eta\sigma_1 = \tau \Longrightarrow \eta \in Ex(\tau,\sigma_1) \\
                    \theta\sigma_2 = \eta \Longrightarrow \theta \in Ex(\eta, \sigma_2)
                \end{gather*}
            \item [$\supseteq )$] Si $\eta \in Ex(\tau,\sigma_1)$ y tomamos $\theta\in Ex(\eta,\sigma_2)$, tendremos entonces que:
                \begin{equation*}
                    \left.\begin{array}{l}
                        \eta\sigma_1 = \tau \\
                        \theta\sigma_2 = \eta
                    \end{array}\right\}\Longrightarrow \theta\sigma_2\sigma_1 = \tau \Longrightarrow \theta\in Ex(\eta,\sigma_1\sigma_2)
                \end{equation*}
        \end{description}
        Hemos probado que
        \begin{equation*}
            Ex(\tau,\sigma_2\sigma_1) = \bigcup_{\eta \in Ex(\tau,\sigma_1)} Ex(\eta,\sigma_2)
        \end{equation*}
        Ahora, si $\eta,\eta'\in Ex(\tau,\sigma_1)$ y tenemos que:
        \begin{equation*}
            \theta \in  Ex(\eta,\sigma_2)\cap Ex(\eta',\sigma_2) \Longrightarrow \left\{\begin{array}{l}
                \theta\sigma_2 = \eta \\
                \theta \sigma_2 = \eta'
            \end{array}\right. \Longrightarrow \eta = \eta'
        \end{equation*}
        por lo que la unión es disjunta.
    \end{proof}
\end{lema}

% Esta es otra proposicion de extension, pero no le daremos nombre porque quiere que si usemos la proposicion de extension nos referiramos a la otra.
\begin{prop}\label{prop:extension_2}
    Sean dos homomorfismos de cuerpos:
    \begin{figure}[H]
        \centering
        \shorthandoff{""}
        \begin{tikzcd}
        F \arrow[r, "\tau"] \arrow[rd, "\sigma"'] & E \\
                                                  & K
        \end{tikzcd}
        \shorthandon{""}
    \end{figure}
    Si $[K:\sigma(F)]<\infty$, entonces $|Ex(\tau,\sigma)| \leq [K:\sigma(F)]$.
    \begin{proof}
        Por inducción sobre $n = [K:\sigma(F)]$ usando el segundo principio de inducción:
        \begin{itemize}
            \item \underline{Si $n=1$}, entonces $\sigma(F) = K$, por lo que $\sigma$ es un isomorfismo, con lo que $Ex(\tau,\sigma) = \{\tau \sigma^{-1}\}$, ya que si $\eta \in Ex(\tau, \sigma)$, entonces:
                \begin{equation*}
                    \eta\sigma = \tau \Longrightarrow \eta = \tau\sigma^{-1}
                \end{equation*}
                En definitiva, $1 = |Ex(\tau,\sigma)| \leq [K:\sigma(F)] = 1$.
            \item \underline{Supuesto que $n>1$ y la hipótesis de inducción}, como $[K:\sigma(F)] = n > 1$, tenemos que existe $\alpha\in K$ de forma que $[\sigma(F)(\alpha):\sigma(F)] > 1$, con lo que el Lema de la Torre nos dice que $[K:\sigma(F)(\alpha)] < n$. 

                Sea ahora $\iota:\sigma(F)(\alpha)\to K$ la inclusión en $K$, podemos tomar:
                \begin{equation*}
                    \sigma = \iota \circ \sigma'
                \end{equation*}
                con $\sigma':F\to \sigma(F)(\alpha)$ la restricción en codominio (o correstricción) de $\sigma$. Nos encontramos en la siguiente situación:
                \begin{figure}[H]
                    \centering
                    \shorthandoff{""}
                    \begin{tikzcd}
                        F \arrow[r, "\tau"] \arrow[rd, "\sigma"] \arrow[d, "\sigma'"'] & E \\
                        \sigma(F)(\alpha) \arrow[r, "\iota"]                           & K
                    \end{tikzcd}
                    \shorthandon{""}
                \end{figure}
                \noindent
                Aplicando el Lema anterior, obtenemos:
                \begin{equation*}
                    Ex(\tau,\sigma) = \biguplus_{\eta \in Ex(\tau,\sigma')}Ex(\eta, \iota)
                \end{equation*}
                Con lo que:
                \begin{equation*}
                    |Ex(\tau,\sigma)| = \sum_{\eta \in  Ex(\tau, \sigma')}|Ex(\eta,\iota)|
                \end{equation*}
                Sea $\eta\in Ex(\tau,\sigma')$, por hipótesis de inducción ($[K:\sigma(F)(\alpha)]<n$) tenemos que:
                \begin{equation*}
                    |Ex(\eta,\iota)| \leq [K:\sigma(F)(\alpha)]
                \end{equation*}
                con lo que:
                \begin{align*}
                    |Ex(\tau,\sigma)| &= \sum_{\eta\in Ex(\tau,\sigma')}|Ex(\eta,\iota)| \leq \sum_{\eta\in Ex(\tau,\sigma')}[K:\sigma(F)(\alpha)] \\
                                      &= |Ex(\tau,\sigma')|[K:\sigma(F)(\alpha)]
                \end{align*}
                Sea $p^\sigma = Irr(\alpha,\sigma(F))$, la Proposición de extensión nos dice que si $\cc{R}_\tau$ es el número de raíces de $p^\tau$ en $E$, entonces:
                \begin{equation*}
                    |Ex(\tau, \sigma')| = |\cc{R}_\tau| \leq degp^\tau = [\sigma(F)(\alpha):\sigma(F)]
                \end{equation*}
                Por lo que aplicando el Lema de la Torre en $(\ast)$:
                \begin{equation*}
                    |Ex(\tau,\sigma)|  \leq [\sigma(F)(\alpha):\sigma(F)][K:\sigma(F)(\alpha)] = [K:\sigma(F)]
                \end{equation*}
        \end{itemize}
    \end{proof}
\end{prop}

\begin{ejercicio} 
    Si $\Pi$ es el cuerpo primo de un cuerpo $K$, entonces el único homomorfismo de cuerpos $\sigma:\Pi\to K$ es la inclusión. % // TODO: Formalizar, es la idea de siempre
\end{ejercicio}

\noindent
Mostramos a continuación un ejemplo básico de la proposición de extensión.

\begin{ejemplo}
    ¿Cuántos homomorfismos de cuerpos hay de $\mathbb{Q}(\sqrt[3]{2})$ en $\mathbb{C}$, y cuáles son?\\

    \noindent
    Es decir, nos preguntamos por cuántos homomorfismos $\eta:\mathbb{Q}\left(\sqrt[3]{2}\right)\to \mathbb{C}$ hay. Para ello, reformularemos el problema en calcular un cierto conjunto de extensiones. Si consideramos las inclusiones de $\mathbb{Q}$ en $\mathbb{C}$ ($\tau$) y de $\mathbb{Q}$ en $\mathbb{Q}\left(\sqrt[3]{2}\right)$ ($\sigma$), tenemos:
    \begin{figure}[H]
        \centering
        \shorthandoff{""}
        \begin{tikzcd}
            \mathbb{Q} \arrow[rd, "\sigma"] \arrow[r, "\tau"] & \mathbb{C}                                   \\
                                                             & {\mathbb{Q}\left(\sqrt[3]{2}\right)} \arrow[u, "\eta"']
        \end{tikzcd}
        \shorthandon{""}
    \end{figure}
    \noindent
    Y lo que queremos hacer es calcular los elementos del conjunto $Ex(\tau,\sigma)$. Sabemos que:
    \begin{equation*}
        Irr\left(\sqrt[3]{2},\mathbb{Q}\right) = x^3-2
    \end{equation*}
    Si tomamos el conjunto de sus raíces en $\mathbb{C}$, sabemos que:
    \begin{equation*}
        \cc{R} = \left\{\sqrt[3]{2}, w\sqrt[3]{2}, w^2\sqrt[3]{2}\right\}
    \end{equation*}
    donde $w$ es una raíz cúbica primitiva de la unidad, tenemos tres homomorfismos de $\mathbb{Q}(\sqrt[3]{2})$ en $\mathbb{C}$. Les damos nombre a cada uno de ellos:
    \begin{equation*}
        Ex(\tau,\sigma) = \{\eta_0,\eta_1,\eta_2\}
    \end{equation*}
    donde $\eta_i$ está determinado (según la proposición de extensión) por:
    \begin{equation*}
        \eta_j\left(\sqrt[3]{2}\right) = w^j \sqrt[3]{2}, \qquad \forall j \in \{0,1,2\}
    \end{equation*}
    Como cada uno de los $\eta_j$ es un homomorfismo definido sobre $\mathbb{Q}\left(\sqrt[3]{2}\right)$ con base $\{1,\sqrt[3]{2}\}$, es suficiente definirlos sobre 1 (todos cumplirán $\eta_j(1)=1$, por ser homomorfismos) y sobre $\sqrt[3]{2}$. Como ejemplo de esto último, observemos que podemos calcular:
    \begin{equation*}
        \eta_2\left(\frac{{\sqrt[3]{2}+(\sqrt[3]{2})}^{2}}{27}\right) = \dfrac{\eta_2(\sqrt[3]{2}) + {\left(\eta_2\left(\sqrt[3]{2}\right)\right)}^{2}}{27} = \dfrac{w^2 \sqrt[3]{2} + {\left(w^2\sqrt[3]{2}\right)}^{2}}{27} 
    \end{equation*} 
\end{ejemplo}

\begin{prop}\label{prop:extension_3}
    Sean $\tau:F\to E$, $\sigma:F\to K$ homomorfismos de cuerpos con $\sigma$ un cuerpo de descomposición de $f\in F[x]$. Si $f^\tau$ se descompone como producto de polinomios lineales en $E[x]$, entonces $Ex(\tau,\sigma)$ es no vacío. Además, si $f^\sigma$ tiene $deg f$ raíces distintas, entonces:
    \begin{equation*}
        |Ex(\tau, \sigma)| = [K:\sigma(F)]
    \end{equation*}
    \begin{proof}
        La idea es similar a la de la Poposición~\ref{prop:extension_2}, por inducción sobre $n=[K:\sigma(F)]$:
        \begin{itemize}
            \item Para $n = 1$, tenemos que $K = \sigma(F)$, con lo que $\sigma$ es un isomorfismo y tendremos por tanto que $Ex(\tau,\sigma) = \{\tau\sigma^{-1}\}$.
            \item Supuesto que $n>1$ y la hipótesis de inducción, tenemos que $f$ tiene un factor irreducible $p\in F[x]$ de grado mayor o igual 1. Tomamos una raíz $\alpha\in K$ de $p^\sigma$, de donde $[K:\sigma(F)(\alpha)]<n$. Si consideramos $\sigma':F\to \sigma(F)(\alpha)$ y la inclusión $\iota:\sigma(F)(\alpha)\to K$, tenemos que:
                \begin{equation*}
                    Ex(\tau,\sigma) = \biguplus_{\eta\in Ex(\tau,\sigma')}Ex(\eta,\iota)
                \end{equation*}
                con lo que:
                \begin{equation*}
                    |Ex(\tau,\sigma)| = \sum_{\eta \in  Ex(\tau, \sigma')}|Ex(\eta,\iota)|
                \end{equation*}
                de la proposición de extensión deducimos que $Ex(\tau,\sigma')$ tiene tantos elementos como raíces de $p^\tau$ hay en $E$. Sin embargo, como $f^\tau$ se factoriza como producto de polinomios de grado 1 en $E[x]$ y $p^\tau$ es un factor de $f^\tau$, en particular $Ex(\tau,\sigma')\neq \emptyset $, lo que nos permite tomar $\eta \in Ex(\tau,\sigma')$, y por hipótesis de inducción obtenemos que $Ex(\eta, \iota)$ es no vacío, con lo que tampoco puede serlo $Ex(\tau,\sigma)$.

                Además, si $f^\sigma$ tiene $degf$ raíces distintas, entonces $p^\sigma$ tiene $degp$ raíces distintas, de donde:
                \begin{equation*}
                    |Ex(\tau,\sigma')| = \cc{R}(p^\sigma) = degp^{\sigma} = [\sigma(F)(\alpha):\sigma(F)]
                \end{equation*}
                Por hipótesis de inducción (como $[K:\sigma(F)(\alpha)]<n$), para cada $\eta \in Ex(\tau,\sigma')$ tenemos que $|Ex(\eta, \iota)| = [K:\sigma(F)(\alpha)]$, con lo que:
                \begin{equation*}
                    |Ex(\tau,\sigma)| = \sum_{\eta \in  Ex(\tau, \sigma')}|Ex(\eta,\iota)| = [K:\sigma(F)(\alpha)][\sigma(F)(\alpha):\sigma(F)] = [K:\sigma(F)]
                \end{equation*}
        \end{itemize}
    \end{proof}
\end{prop}

\begin{ejemplo}
    (Continuación del ejemplo anterior)

    \noindent
    Sea $K = \mathbb{Q}\left(\sqrt[3]{2},w\right)$ con $w$ una raíz cúbica primitiva de la unidad, si queremos calcular todos los homomorfismos de $K$ en $\mathbb{C}$, lo que haremos será considerar las respectivas aplicaciones de inclusión $\tau,\sigma_1$ y $\sigma_2$, con lo que tenemos:
    \begin{figure}[H]
        \centering
        \shorthandoff{""}
        \begin{tikzcd}
        \mathbb{Q} \arrow[d, "\sigma_1"'] \arrow[r, "\tau"]                   & \mathbb{C}           \\
        {\mathbb{Q}(\sqrt[3]{2})} \arrow[ru, "\eta_j"] \arrow[r, "\sigma_2"'] & K \arrow[u, "\eta"']
        \end{tikzcd}
        \shorthandon{""}
    \end{figure}
    \noindent
    Y queremos calcular $Ex(\tau,\sigma_1\sigma_2)$. Para ello, trataremos de usar las aplicaciones $\eta_j$ que ya conocemos, que cumplían:
    \begin{equation*}
        \eta_j\left(\sqrt[3]{2}\right) = w^j \sqrt[3]{2} \qquad \forall j \in \{0,1,2\}
    \end{equation*}
    Calcularemos para cada $j$ todas las $\sigma_2-$extensiones de $\eta_j$, ya que:
    \begin{equation*}
        Ex(\tau,\sigma_2\sigma_1) = \biguplus_{\eta \in  Ex(\tau,\sigma_1)}Ex(\eta, \sigma_2) = Ex(\eta_0,\sigma_2) \cup Ex(\eta_1, \sigma_2) \cup Ex(\eta_2,\sigma_2)
    \end{equation*}
    Para ello, necesitamos calcular el polinomio irreducible de $w$ sobre $\mathbb{Q}\left(\sqrt[3]{2}\right)$ y calcular sus raíces en $\mathbb{C}$, cosa que ya hemos realizado en alguna ocasión:
    \begin{equation*}
        Irr\left(w,\mathbb{Q}\left(\sqrt[3]{2}\right)\right) = x^2+x+1 \qquad \text{con raíces\ } w, w^2
    \end{equation*}
    Por tanto, tendremos 2 $\sigma_2$ extensiones de $\eta_j$ para cada $j \in \{0,1,2\}$:
    \begin{equation*}
        \eta_{j,k}(w) = w^k \qquad k \in \{1,2\}
    \end{equation*}
    \begin{equation*}
        Ex(\tau,\sigma_2\sigma_1) = \{\eta_{j,k} : j\in \{0,1,2\}, k\in \{1,2\}\}
    \end{equation*}
    determinadas por
    \begin{equation*}
        \eta_{j,k}\left(\sqrt[3]{2}\right) = w^j\sqrt[3]{2}, \qquad \eta_{j,k}(w)= w^k
    \end{equation*}
    Sabíamos que teníamos que obtener 6 extensiones, porque todas las raíces obtenidas son distintas.
\end{ejemplo}

\begin{ejercicio}\label{ej:F-lineal}
    Sean $F\stackrel{\tau}{\to}E\stackrel{\rho}{\to}E$ homomorfismos de cuerpos. Sabemos que $E$ es un $\tau(F)-$espacio vectorial, se verifica que: 
    \begin{equation*}
        \rho \text{\ es\ } \tau(F)-\text{lineal} \Longleftrightarrow \rho\tau = \tau
    \end{equation*}

    \begin{description}
        \item [$\Longleftarrow )$] Sea $y\in \tau(F)$ y $z\in E$, tenemos que existe $x\in F$ de forma que $\tau(x)=y$, con lo que:
            \begin{align*}
                \rho(y\cdot z) = \rho(\tau(x)\cdot z) = \rho(\tau(x))\cdot \rho(z) = \rho(x)\cdot \rho(z) = y\cdot \rho(z)
            \end{align*}
        \item [$\Longrightarrow )$] Supuesto que $\rho$ es $\tau(F)-$lineal, tenemos que:
            \begin{equation*} 
                \rho(\tau(x)) = \rho(\tau(x)\cdot 1)= \tau(x)\cdot \rho(1) = \tau(x)\cdot 1 = \tau(x) \qquad \forall x\in E
            \end{equation*}
    \end{description}
\end{ejercicio}

\begin{teo}[Unicidad del cuerpo de descomposición] \ \\
    Sean $\tau:F\to E$ y $\tau':F\to E'$ dos cuerpos de descomposición de $f\in F[x]$. Entonces, existe un isomorfismo de cuerpos $\eta:E\to E'$ tal que $\eta \tau = \tau'$.
    \begin{proof}
        La Proposición~\ref{prop:extension_3} nos dice que como $f^\tau$ y $f^{\tau'}$ se descomponen como producto de polinomios lineales en $E[x]$ y $E'[x]$ de forma respectiva, entonces $Ex(\tau,\tau')$ y $Ex(\tau',\tau)$ son no vacíos, con lo que existen $\eta:E\to E'$ y $\eta':E'\to E$ tales que 
        \begin{equation*}
            \eta'\tau' = \tau\qquad \eta\tau = \tau'
        \end{equation*}

        si observamos que:
        \begin{equation*}
            \eta\eta'\tau' = \tau'
        \end{equation*}
        el Ejercicio~\ref{ej:F-lineal} nos dice que $\eta\eta'$ es $F-$lineal. Ahora, como $E'$ es de dimensión finita sobre $\tau'(F)$ por ser $E'[x]$ cuerpo de descomposición de $f^{\tau'}$; y como tenemos que $\eta\eta':E\to E$ es inyectiva, obtenemos automáticamente que $\eta\eta'$ es biyectiva. De aquí concluimos que $\eta$ es sobreyectiva, pero como era un homomorfismo de cuerpos, concluimos que $\eta$ es biyectiva, con lo que $\eta$ es un isomorfismo.
    \end{proof}
\end{teo}

\begin{ejercicio} % // TODO: HACER
    Sea $\sigma:F\to E$ un homomorfismo de cuerpos tal que la extensión $\sigma(F)\leq E$ es finita. Demostrar que existe un polinomio $f\in F[x]$ y un homomorfismo de cuerpos $\tau:E\to K$ tal que $\tau\sigma:F\to K$ es cuerpo de descomposición de $f$.
\end{ejercicio}

\section{Clasificación de los cuerpos finitos} 
\begin{prop}\label{prop:cuerpo_descomposicion}
    Sea $F$ un cuerpo finito con\footnote{Sabemos que es así por el Ejercicio~\ref{ej:cardinal_cuerpo}.} $q=p^n$ elementos (para $p$ la característica de $F$), entonces $F$ es cuerpo de descomposición de $x^q-x\in \bb{F}_p[x]$.
    \begin{proof}
        Llamamos $f=x^q-x$ y consideramos el grupo $F^{\times} = F\setminus\{0\}$, que tiene $q-1$ elementos. Por el Teorema de Lagrange para grupos tenemos que todo $\alpha\in F^{\times}$ satisface que $\alpha^{q-1}=1$, de donde $\alpha^q = \alpha$. Para $0$ es trivial, con lo que:
        \begin{equation*}
            \alpha^q = \alpha \qquad \forall \alpha\in F
        \end{equation*}
        es decir, todo elemento de $F$ es raíz de $x^q-x$. Como su polinomio derivado es $qx^{q-1}-1 = 0$, tenemos entonces que $x^q-x$ tiene exactamente $q$ raíces distintas, que son todos aquellos elementos de $F$, con lo que $F$ es cuerpo de descomposición de $f\in \bb{F}_p[x]$.
    \end{proof}
\end{prop}

\begin{ejercicio}\label{ej:cuerpo_caracteristica}
    Sean $a,b\in F$ con $F$ un cuerpo de característica $p>0$. Si $q=p^n$, comprobar que ${(a-b)}^{q} = a^q - b^q$.\\

    \noindent
    Veamos en primer lugar que:
    \begin{equation*}
        {(a-b)}^{p} = \sum_{k=0}^{p} \binom{p}{k} a^{p-k}{(-b)}^k = a^p - b^p + \sum_{k=1}^{p-1} \dfrac{p!}{k!(p-k)!}a^{p-k}{(-b)}^{k} \AstIg a^p - b^p
    \end{equation*}
    donde en $(\ast)$ usamos que para $1<k<p-1$ tenemos que $\binom{p}{k}$ es múltiplo de $p$. Observemos ahora que:
    \begin{equation*}
        {(a-b)}^{p^2} = {({(a-b)}^{p})}^{p} = {(a^p-b^p)}^{p} = a^{p^2} - b^{p^2}
    \end{equation*}
    Y por un procedimiento inductivo se termina probando que ${(a-b)}^{q} = a^q - b^q$.
\end{ejercicio}

\begin{teo}[Clasificación de cuerpos finitos]
    Para cada número primo $p$ y para cada $n\in \mathbb{N}\setminus\{0\}$ existe un único, salvo isomorfismos, cuerpo de cardinal $p^n$. Además, estos son los únicos cuerpos finitos.
    \begin{proof}
        Sea $q=p^n$, tomamos como $F$ un cuerpo de descomposición del polinomio $f=x^q-x\in \bb{F}_p[x]$. Sea $S$ el conjunto de las raíces de $f$ en $F$, veamos que $S$ es un subcuerpo de $F$, puesto que:
        \begin{itemize}
            \item $1\in S$.
            \item Si $a,b\in S$:
                \begin{equation*}
                    \left.\begin{array}{l}
                        a^q - a = 0 \\
                        b^q - b = 0 
                    \end{array}\right\} \Longrightarrow a^qb^q = ab \Longrightarrow {(ab)}^{q}-ab = 0
                \end{equation*}
                con lo que $ab\in S$, y vemos ahora que:
                \begin{equation*}
                    {(a-b)}^{q}-(a-b) \AstIg a^q - b^q - (a-b) = a-b-(a-b) = 0
                \end{equation*}
                donde en $(\ast)$ usamos el Ejercicio~\ref{ej:cuerpo_caracteristica}, con lo que también $a-b\in S$.
            \item Ahora, si $a\in S\setminus\{0\}$, tenemos que:
                \begin{equation*}
                    {(a^{-1})}^{q} = a^{-q} = {(a^{q})}^{-1} = a^{-1} \Longrightarrow {(a^{-1})}^{q}-a^{-1} = 0
                \end{equation*}
                por lo que $a^{-1}\in S$.
        \end{itemize}
        Finalmente, como $F$ es un cuerpo de descomposición de $f$, ha de ser $S = F$. Además, como el polinomio derivado no comparte raíces con $f$, tenemos que $|F| = q$.\\

        \noindent
    Ahora, si tenemos dos cuerpos del mismo cardinal $q$, la Proposición~\ref{prop:cuerpo_descomposicion} nos dice que ambos cuerpos son cuerpos de descomposición de $x^q-x\in \bb{F}_p[x]$, y aplicando el Teorema de unicidad del cuerpo de descomposición, tenemos que son isomorfos.\\

    \noindent
    Sea ahora $F$ cualquier cuerpo, tenemos por el Ejercicio~\ref{ej:cardinal_cuerpo} que este tiene cardinal $p^n$, por lo que tenemos el resultado por lo que acabamos de probar.
    \end{proof}
\end{teo}

\begin{notacion}
    Si $F$ es un cuerpo de $q=p^n$ elementos, lo notaremos por $\bb{F}_q$, y hablaremos ``del'' cuerpo de $q$ elementos.
\end{notacion}

\begin{ejemplo}
    Sabemos ya que:
    \begin{equation*}
        \dfrac{\mathbb{Z}[i]}{\langle 3 \rangle }, \qquad \dfrac{\bb{F}_3[x]}{\langle x^2+x+2 \rangle }
    \end{equation*}
    son dos cuerpos de $9$ elementos, con lo que el Teorema recién probado nos dice que ambos son isomorfos.
\end{ejemplo}

\section{El grupo de automorfismos de una extensión}
\begin{definicion}[Grupo de automorfismos de un cuerpo]
    Sea $K$ un cuerpo, consideramos el conjunto de todos los automorfismos de $K$:
    \begin{equation*}
        Aut(K) = \{\sigma:K\to K \text{\ homomorfismo de cuerpos biyectivo}\}
    \end{equation*}
    Se verifica que $Aut(K)$ es un grupo con la operación composición de aplicaciones, que recibe el nombre de \underline{grupo de automorfismos de $K$}. \\

    \noindent
    Si $F\leq K$ es una extensión de cuerpos, tomamos:
    \begin{equation*}
        Aut_F(K) = \{\sigma\in Aut(K) : \sigma \text{\ es\ } F-\text{lineal}\}
    \end{equation*}
    y se verifica que $Aut_F(K)$ es un subgrupo de $Aut(K)$, que recibe el nombre de \underline{grupo de automorfismos de $F\leq K$}.\\
\end{definicion}

\begin{ejercicio} % // TODO: HACER, es la idea de siempre
    Si $\Pi$ es el subcuerpo primo de $K$, entonces $Aut_\Pi(K) = Aut(K)$.
\end{ejercicio}

\begin{prop}\label{prop:comienzo_chap_2}
    Si $F\leq K$ es finita, entonces $|Aut_F(K)| \leq [K:F]$
    \begin{proof}
        Si llamamos $F\stackrel{\iota}{\to}K$ al homomorfismo inclusión, entonces:
        \begin{equation*}
            Aut_F(K) = Ex(\iota, \iota)
        \end{equation*}
        \begin{description}
            \item [$\subseteq )$] Si $\sigma\in Aut_F(K)$, tenemos entonces que $\sigma$ es $F-$lineal, y por el Ejercicio~\ref{ej:F-lineal}, tenemos entonces que $\sigma\iota = \iota$, lo que nos dice que $\sigma\in Ex(\iota,\iota)$.
            \item [$\supseteq )$] Si tomamos $\sigma\in Ex(\iota,\iota)$ como es homomorfismo de cuerpos tenemos que es inyectivo, y como es $F-$lineal, ha de ser necesariamente sobreyectivo, con lo que $\sigma\in Aut_F(K)$
        \end{description}
        Finalmente, la segunda proposición de extensión nos dice que:
        \begin{equation*}
            |Aut_F(K)| = |Ex(\iota,\iota)| \leq [K:F]
        \end{equation*}
    \end{proof}
\end{prop}

\begin{prop}\label{prop:cuerpo_desc_aut_f_lin}
    Si $F\leq K$ es cuerpo de descomposición de $f\in F[x]$, entonces: 
    \begin{equation*}
        |Aut_F(K)| \leq [K:F]
    \end{equation*}
    y si todas las raíces de $f$ en $K$ son simples (es decir, $f$ tiene $degf$ raíces distintas), entonces:
    \begin{equation*}
        |Aut_F(K)| = [K:F]
    \end{equation*}
    \begin{proof}
        Si $F\leq K$ es un cuerpo de descomposición de $f\in F[x]$, tenemos entonces que si $\alpha_1, \ldots, \alpha_s$ son las raíces de $f$ en $K$ entonces $K = F(\alpha_1, \ldots, \alpha_s)$ es una extensión algebraica y finitamente generada, luego finita, de donde aplicando la Proposición anterior tenemos que $|Aut_F(K)|\leq [K:F]$.\\

        \noindent
        Si ahora tenemos que todas las raíces de $f$ en $K$ son simples, aplicando que $|Aut_F(K)| = |Ex(\iota,\iota)|$ para $\iota:F\to K$ la aplicación inclusión, tenemos por la tercera propiedad de extensión que:
        \begin{equation*}
            |Aut_F(K)| = |Ex(\iota,\iota)| = [K:F]
        \end{equation*}
    \end{proof}
\end{prop}

\begin{ejemplo}
    Según un ejemplo ya visto, tenemos que:
    \begin{equation*}
        Aut\left(\mathbb{Q}\left(\sqrt[3]{2}, w\right)\right) = Aut_\mathbb{Q}\left(\mathbb{Q}\left(\sqrt[3]{2}, w\right)\right)
    \end{equation*}
    con lo que la Proposición nos dice que:
    \begin{equation*}
        \left|Aut_\mathbb{Q}\left(\mathbb{Q}\left(\sqrt[3]{2},w\right)\right)\right| = 6
    \end{equation*}
    Por Álgebra II, tenemos que este grupo es isomorfo a $C_6$ o a $S_3$, pero en ejemplos anteriores vimos que:
    \begin{equation*}
        Aut\left(\mathbb{Q}\left(\sqrt[3]{2},w\right)\right) = \{\eta_{j,k} : j \in \{0,1,2\}, k\in \{1,2\}\}
    \end{equation*}

    donde:
    \begin{equation*}
        \left\{\begin{array}{ccl}
                \eta_{j,k}\left(\sqrt[3]{2}\right) &=& w^j\sqrt[3]{2} \\
                \eta_{j,k}(w) &=& w^k
        \end{array}\right.
    \end{equation*}
    resulta que tenemos un grupo no conmutativo:
    \begin{align*}
        \sqrt[3]{2} &\stackrel{\eta_{1,1}}{\longmapsto} w\sqrt[3]{2} \stackrel{\eta_{1,0}}{\longmapsto} w\sqrt[3]{2} \\
        \sqrt[3]{2} &\stackrel{\eta_{1,0}}{\longmapsto} w\sqrt[3]{2} \stackrel{\eta_{1,1}}{\longmapsto} w^2\sqrt[3]{2} 
    \end{align*}
    por lo que es isomorfo a $S_3$.
\end{ejemplo}

\begin{teo}
    Sea $\bb{F}_q$ un cuerpo finito con $q=p^n$ elementos, entonces $Aut(\bb{F}_q)$ es un grupo cíclico de orden $n$.
    \begin{proof}
        Sabemos por la Proposición~\ref{prop:cuerpo_descomposicion} que $\bb{F}_q$ es cuerpo de descomposición de $x^q-x\in \bb{F}_q[x]$, así como que las raíces de dicho polinomio son todas distintas (puesto que no comparte raíces con su polinomio derivado). Estamos en las condiciones de aplicar la Proposición~\ref{prop:cuerpo_desc_aut_f_lin}, obteniendo que:
        \begin{equation*}
            |Aut(\bb{F}_q)| = |Aut_{\bb{F}_p}(\bb{F}_q)| = [\bb{F}_q : \bb{F}_p] = n
        \end{equation*}
        Sea $\tau:\bb{F}_q\to \bb{F}_q$ la aplicación:
        \begin{equation*}
            \tau(a) = a^{p} \qquad \forall a\in \bb{F}_q
        \end{equation*}
        tenemos por el Ejercicio~\ref{ej:cuerpo_caracteristica} que es un homomorfismo de cuerpos, luego un automorfismo (que recibe el nombre de automorfismo de Frobenius). Veamos que su oren es $n$. Para ello, sea $m\in \mathbb{N}\setminus \{0\}$ de forma que:
        \begin{equation*}
            \tau^m = id_{\bb{F}_q}
        \end{equation*}
        En el Ejercicio~\ref{ej:subgrupo_finito} vimos que $\bb{F}_q^{\times}$ es cíclico y de orden $q-1$. Tomamos $a$ como su generador, que será de orden $q-1$, lo que nos dice entonces que:
        \begin{equation*}
            a = \tau^m (a)  = a^{p^m}
        \end{equation*}
        Usando que el orden de $a$ es $p^n-1$, deducimos que $p^m -1\geq p^n -1$, luego $m\geq n$, de donde el orden de $\tau\in Aut(\bb{F}_q)$ es $n$, con lo que $Aut(\bb{F}_q)$ está generado por $\tau$.
    \end{proof}
\end{teo}

\section{Ejercicios}

\begin{ejercicio} % // TODO: HACER A PARTIR DE AQUI
    Sea $F\leq K$ una extensión de cuerpos de grado 2. Mostrar que, si la característica de $F$ es distinta de dos, existe $\beta\in K$ tal que $\beta^2 \in F$ y $K = F(\beta)$.
\end{ejercicio}

\begin{ejercicio}
    Calcular un cuerpo de descomposición de $x^4+16\in \mathbb{Q}[x]$.
\end{ejercicio}

\begin{ejercicio}
    Razonar cuáles de los siguientes números complejos son algebraicos sobre $\mathbb{Q}$, suponiendo conocido que $e$ y $\pi$ son trascendentes:
    \begin{equation*}
        \sqrt[5]{4}, (1+\sqrt[5]{4}){(1-\sqrt[5]{16})}^{-1}, \pi^2, e^2-i, i\sqrt{i}+\sqrt{2}, \sqrt{1-\sqrt[3]{2}}, \sqrt{\pi}, \sqrt{2}{(\sqrt[3]{2}+\sqrt[5]{2})}^{-1}.
    \end{equation*}
\end{ejercicio}

\begin{ejercicio}
    Sea $F\leq K$ una extensión de cuerpos, $\alpha\in K$ y $n$ natural no nulo. Demostrar que $\alpha$ es algebraico sobre $F$ si, y solo si, $\alpha^n$ es algebraico sobre $F$.
\end{ejercicio}

\begin{ejercicio}
    Sea $F\leq K$ una extensión de cuerpos, $\alpha\in K$ y $\beta = 1+\alpha^2 + \alpha^5$. Demostrar que $\alpha$ es algebraico sobre $F$ si, y solo si, $\beta$ es algebraico sobre $F$:
\end{ejercicio}

\begin{ejercicio}
    Calcular $Irr(\alpha,\mathbb{Q})$ para los siguientes valores de $\alpha$:
    \begin{equation*}
        3+\sqrt{2}, \sqrt{3}-\sqrt[4]{3}, \sqrt[3]{2}+\sqrt[3]{4}
    \end{equation*}
\end{ejercicio}

\begin{ejercicio}
    Calcular $[E:\mathbb{Q}]$ y una base de $E$ sobre $\mathbb{Q}$ en los siguientes casos:
    \begin{equation*}
        E = \mathbb{Q}\left(\sqrt{6},i\right), \qquad E= \mathbb{Q}\left(\sqrt[3]{5},\sqrt{-2}\right), \qquad E = \mathbb{Q}\left(\sqrt{18},\sqrt[3]{4}\right)
    \end{equation*}
\end{ejercicio}

\begin{ejercicio}
    Sea $\alpha\in \mathbb{C}$ una raíz del polinomio $x^3+3x+1$. Describir una base de $\mathbb{Q}(\alpha)$ sobre $\mathbb{Q}$ y calcular las coordenadas racionales con respecto de la misma de $(1+\alpha){(1+\alpha+\alpha^2)}^{-1}$.
\end{ejercicio}

\begin{ejercicio}
    Pongamos $\bb{F}_4 = \bb{F}_2(a)$ con $a^2+a+1=0$. Comprobar que $\bb{F}_{16}$ puede presentarse como $\bb{F}_{16}=\bb{F}_2(b)$, donde $b^4+b+1=0$. Determinar todos los homomorfismos de cuerpos $\bb{F}_4\to \bb{F}_{16}$ en función de $a$ y $b$.
\end{ejercicio}

\begin{ejercicio}\label{ej:subgrupo_finito}
    Demostrar que, si $F$ es un cuerpo, entonces cualquier subgrupo finito de $F^\times$ es cíclico. Deducimos que, en particular, $\bb{F}_q^\times$ es un grupo cíclico de orden $q-1$. (Pista: usar la descomposición cíclica de un grupo finito abeliano).
\end{ejercicio}

\begin{ejercicio}
    Demostrar que los anillos $\frac{\mathbb{Z}[i]}{\langle 3 \rangle }$ y $\frac{\bb{F}_3}{\langle x^2+x+2 \rangle }$ son isomorfos sin necesidad de dar un isomorfismo concreto. ¿Serías capaz de darlo? ¿Y de calcularlos todos?
\end{ejercicio}

\begin{ejercicio} % // TODO: es ejercicio de examen, al final del capitulo 1
    Se pide:
    \begin{enumerate}
        \item Comprobar que $\sqrt{3}\in \mathbb{Q}\left(\sqrt{1+2\sqrt{3}}\right)$.

            Llamamos $\alpha = \sqrt{1+2\sqrt{3}}$ y calculamos:
            \begin{equation*}
                \alpha^2 = 1+2\sqrt{3} \quad \Longrightarrow \quad  \sqrt{3} = \dfrac{\alpha^{2}-1}{2}\in \mathbb{Q}(\alpha)
            \end{equation*}
            De donde también deducimos que $\mathbb{Q}(\sqrt{3})\leq \mathbb{Q}(\alpha)$.
        \item Calcular $Irr\left(\alpha, \mathbb{Q}\left(\sqrt{3}\right)\right)$.

            Sabemos que $\alpha$ es raíz de $f=x^2-1-2\sqrt{3}\in \mathbb{Q}\left(\sqrt{3}\right)[x]$, con lo que:
            \begin{equation*}
                \left[\mathbb{Q}(\alpha):\mathbb{Q}\left(\sqrt{3}\right)\right] \leq 2
            \end{equation*}
            Supongamos que $\left[\mathbb{Q}(\alpha):\mathbb{Q}\left(\sqrt{3}\right)\right]=1$, con lo que $\alpha\in \mathbb{Q}\left(\sqrt{3}\right)$, de donde $\alpha = a + b\sqrt{3}$ para ciertos $a,b\in \mathbb{Q}$. Si elevamos al cuadrado:
            \begin{equation*}
                1 + 2\sqrt{3} = \alpha^2 = a^2 + 3b^2 + 2ab\sqrt{3}
            \end{equation*}
            Usando que $\{1,\sqrt{3}\}$ es una base de $\mathbb{Q}\left(\sqrt{3}\right)$, tenemos entonces que:
            \begin{align*}
                \left.\begin{array}{l}
                    1 = a^2 + 3b^2 \\
                    2 = 2 ab
                    \end{array}\right\} &\Longrightarrow \left\{\begin{array}{l}
                    b = \frac{1}{a} \\
                    1 = a^2 + 3\frac{1}{a^2}
            \end{array}\right\} \Longrightarrow a^2 = a^4 + 3 \\ &\Longrightarrow a^2 = \dfrac{1\pm \sqrt{1-12}}{2} \notin \mathbb{Q} \Longrightarrow a \notin \mathbb{Q}
            \end{align*}
            Por lo que no es posible $\left[\mathbb{Q}(\alpha):\mathbb{Q}\left(\sqrt{3}\right)\right]=1$, con lo que $\left[\mathbb{Q}(\alpha):\mathbb{Q}\left(\sqrt{3}\right)\right]=2$, de donde deducimos que:
            \begin{equation*}
                Irr\left(\alpha,\mathbb{Q}\left(\sqrt{3}\right)\right) = x^2-1-2\sqrt{3}
            \end{equation*}
        \item Calcular los homomofismos de $\mathbb{Q}(\alpha)$ en $\mathbb{C}$.

            Queremos calcular los $\eta$ que cumplen:
            \begin{figure}[H]
                \centering
                \shorthandoff{""}
                \begin{tikzcd}
                \mathbb{Q} \arrow[rd, "\iota"'] \arrow[r, "\tau"] & \mathbb{C}                            \\
                                                                  & \mathbb{Q}(\alpha) \arrow[u, "\eta"']
                \end{tikzcd}
                \shorthandon{""}
            \end{figure}
            donde $\tau,\iota$ son la inclusión, es decir, calcular $Ex(\tau,\iota)$.

            No conocemos $Irr(\alpha,\mathbb{Q})$, pero hemos hecho el apartado 2, con lo que calculamos primero los homomorfismos de $\mathbb{Q}(\sqrt{3})$ a $\mathbb{C}$, que son dos por la Proposición de extensión, determinados por:
            \begin{equation*}
                \eta_j(\sqrt{3}) = {(-1)}^{j}\sqrt{3}, \qquad \forall j\in \{0,1\}
            \end{equation*}
            ya que $Irr\left(\sqrt{3},\mathbb{Q}\right) = x^2-3$. Cada uno de ellos da lugar a 2 homomorfismos de $\mathbb{Q}(\alpha)$ en $\mathbb{C}$. Las extensiones de $\eta_0$, digamos $\eta_{0,k}$ con $k\in \{0,1\}$, determinadas por:
            \begin{equation*}
                \eta_{0,k}(\alpha) = {(-1)}^{k}\alpha \qquad \forall k\in \{0,1\}
            \end{equation*}
            Las extensiones de $\eta_1$ vienen dadas por las raíces en $\mathbb{C}$ de $p^{\eta_1} = x^2-1+2\sqrt{3}$, que son $\pm \beta$, con $\beta = \sqrt{1-2\sqrt{3}}$, con lo que tenemos $\eta_{1,k}$ con $k\in \{0,1\}$ dadas por:
            \begin{equation*}
                \eta_{1,k}(\beta) = {(-1)}^{k}\beta
            \end{equation*}
        \item Calcular $Irr(\alpha,\mathbb{Q})$ y sus raíces en $\mathbb{C}$. % // TODO: HACER

            Sabemos ya que el grado es 4, el polinomio se obtiene elevando $\alpha^2=1+2\sqrt{3}$ al cuadrado, y las raíces las sacamos por la bicuadrática, que salen $\alpha,-\alpha,\beta,-\beta$.
    \end{enumerate}
\end{ejercicio}

